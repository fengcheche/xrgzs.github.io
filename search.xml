<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>潇然系统 Xiaoran System</title>
      <link href="/xrsys.html"/>
      <url>/xrsys.html</url>
      
        <content type="html"><![CDATA[<h1 id="潇然系统-Xiaoran-System-官方文档"><a href="#潇然系统-Xiaoran-System-官方文档" class="headerlink" title="潇然系统 Xiaoran System 官方文档"></a>潇然系统 Xiaoran System 官方文档</h1><p><strong>潇然系统 （Xiaoran System）</strong> 是一个<strong>接管系统部署流程，实时构建系统镜像</strong>的项目，简称为<strong>“xrsys”</strong>。</p><p>本系列的系统以<strong>完整、稳定</strong>为基础，将部署过程尽量透明化，同时也加入了<strong>可自定义</strong>的环节，方便折腾修改使用。</p><p>潇然系统已经进行改造升级，从原来单纯的系统打包，逐步构建了一个<strong>涵盖系统安装前、安装时、安装后的体系架构</strong>，帮助您更方便地使用和维护电脑。</p><p><img src="https://img1.imgtp.com/2023/05/21/vwIETDFG.svg"></p><blockquote><p><strong>潇然系统相关项目快速访问</strong></p><p><a href="https://xrgzs.github.io/xrok.html">潇然一键装机助理</a>    <a href="https://xrgzs.github.io/xrpe.html">潇然PE启动</a>    <a href="http://url.xrgzs.top/osc">潇然系统优化组件</a></p><p><a href="http://url.xrgzs.top/xrsoft">潇然软件商店</a>    <a href="https://alist.xrgzs.top/odb/Xiaoran%20Studio/Tools">潇然绿化软件</a>    <a href="https://xrgzs.github.io/xrnoad.html">潇然网页去广告</a></p></blockquote><h2 id="项目特点"><a href="#项目特点" class="headerlink" title="项目特点"></a>项目特点</h2><h3 id="实时构建"><a href="#实时构建" class="headerlink" title="实时构建"></a>实时构建</h3><p>潇然系统可通过<strong>潇然一键装机助理</strong>的<strong>在线重装</strong>功能实现<strong>实时构建</strong>，<strong>自动升级组件版本</strong>，减少重新封装系统的次数。</p><p>对于 Windows XP 等系统，基于保证稳定性、技术可行性的考虑，我们仍然基于<strong>第三方封装工具</strong>（ES、SC）。这些旧版本的项目为 <strong>潇然系统传统版（Xiaoran System Legacy）</strong>。</p><p>*你甚至能将纯净版修改为装机版，装机版修改为纯净版，或联系我们进行 <strong>OEM 定制</strong>。*</p><h3 id="可自定义"><a href="#可自定义" class="headerlink" title="可自定义"></a>可自定义</h3><p>潇然系统主要使用了<strong>潇然系统部署接口（Xiaoran System API，XRSYSAPI）</strong> <code>api.exe</code>和<strong>潇然系统优化组件（Xiaoran System OSC，XROSC）</strong> <code>osc.exe</code>接管了系统部署，仅需挂载镜像、修改 <code>Windows\Setup</code> 目录下的相关文件，就能自定义出属于你的系统镜像。</p><p><em>支持搜索执行外置接口，另提供<strong>关于自定义和接口的说明</strong>。</em></p><h3 id="即装即用"><a href="#即装即用" class="headerlink" title="即装即用"></a>即装即用</h3><p>潇然系统可根据系统版本<strong>自助安装部署软件</strong>，纯净版系统帮你设置好常用的系统设置，装机版系统在纯净版的基础上同时集成常用的应用软件，安装完毕后<strong>很快就可以进入工作、学习</strong>模式，省时省力。</p><p><em>相关功能正在开发中，另提供<strong>专机专用定制系统</strong>。</em></p><h3 id="融汇聚合"><a href="#融汇聚合" class="headerlink" title="融汇聚合"></a>融汇聚合</h3><p>潇然系统<strong>汇聚了很多项目的优点</strong>。我们结合许多优秀前后端项目开发搭建，<strong>既保留</strong>了传统社区（ITSK、SysCeo等）基于 Ghost 克隆技术<strong>封装系统的精髓</strong>，又参考年轻项目（WTDR、Dism++、CMDPE 等）<strong>增加了许多创新元素</strong>。</p><p><strong>坚持提供旧版系统</strong>（Windows XP、7、8.1），不在系统里面大量加入其它元素，保留甚至还原<strong>原版风格</strong>，同时按照<strong>国内习惯</strong>进行优化，尽量做到<strong>中性化</strong>。</p><h2 id="优化特点"><a href="#优化特点" class="headerlink" title="优化特点"></a>优化特点</h2><ul><li><p>桌面上放置<a href="https://url.xrgzs.top/xrtools"><strong>常用工具</strong></a>，内含装机常用小工具，支持<strong>在线更新</strong>。</p></li><li><p>集成万能驱动，<strong>独创“双驱动”安装模式</strong>，万能驱动版先使用<strong>IT天空万能驱动</strong>安装<strong>主板驱动</strong>，再使用<strong>驱动总裁安装</strong>由我们自行制作的<strong>显卡&#x2F;声卡驱动</strong>，确保安装上最新的驱动，支持自动处理系统部署后的残留文件及推广。主板驱动版仅安装主板芯片组 + 网卡驱动，联网后可通过桌面上<a href="https://url.xrgzs.top/xrtools">常用工具</a>文件夹里面的驱动工具仔细安装，提高系统安装的效率和稳定性。</p></li><li><p><strong>原版结合国内风格优化</strong>，基于原版系统实时制作母盘，只是禁用了少部分用户用不了的功能，如 Windows Defender，再此基础上还加上了一些原版系统所不具备的<strong>旧版组件</strong>，保证系统的完整性和可靠性。</p><ul><li>系统优化工作大部分由 yrxitong 和 Xiaoran Reg Importer 完成</li><li>XRSYSAPI，OSCOnline 也参与了部分优化项目</li></ul></li><li><p>更新系统补丁，<strong>集成.Net、VC、Flash运行库</strong>，<strong>NT10 以上系统还集成了 UWP 版本的 VCLibs 运行库</strong>及 AV1、HEIF、HEVC、MPEG2、RAW、WEBP、VP9 等<strong>媒体支持扩展</strong>，提高了系统的兼容性。</p></li><li><p><strong>卸载部分不常用或易导致问题的 UWP 应用</strong>，如 MSN、ClipChamp 等普通用户用不到的微软广告组件，可通过 Microsoft Store 重新下回。</p></li><li><p><strong>自动备份还原 WiFi 密码</strong>，妈妈再也不用担心没有网线了。</p></li><li><p><strong>采用 User 账户登录，默认开启 UAC</strong>（仅 Windows 8），可正常使用 Windows 8.1 Metro 应用，如应用商店、Internet Explorer，其他网站制作的系统由于不具有上述两个条件，运行 Metro 应用通常会报错</p><ul><li>支持自动将部分品牌的商标作为用户名，符合装机习惯</li><li>支持自定义用户名，相关接口：<code>D:\xrsysnewuser.txt</code></li></ul></li><li><p>纯净版系统<strong>仅安装系统必要组件</strong>，附带<a href="https://url.xrgzs.top/xrsoft"><strong>潇然软件商店</strong></a>，内含多款装机常用软件，多为绿色特别版，按需下载选用，装机版系统也只安装了广受好评的常用装机软件，并进行<strong>无广告弹窗化处理</strong>，提高了装机效率。</p></li><li><p>支持<strong>自动处理浏览器配置推广</strong>，并更换为 Xiaoran Studio 专用的书签，内含多种资源地址，让您能够迅速找到安全、可靠、最新的软件、影视资源。</p><ul><li>为了避免嫌疑，目前仅更换了 MS Edge 和手动安装浏览器的书签，并减少了书签数量。</li><li>配置文件均经过手动精简，首次启动自动重新生成机器码，提高了安全性。</li><li>OEM 定制版和纯净版仅替换了 MS Edge 配置，用于去除搜索框自启和一些调整，无任何书签。<ul><li>仅首次更新打开会显示搜索框，重启后不会自启显示。</li></ul></li></ul></li><li><p><strong>自动导入电脑品牌 OEM 属性</strong>、Logo、网址，<strong>自动根据电脑品牌创建用户</strong>，系统界面内无个人信息。</p></li></ul><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li><strong>请勿关闭部署过程中的所有CMD窗口，否则系统将无法正常部署安装</strong></li><li>请勿删除 <code>C:\Windows\Setup </code> 目录下的任何文件，否则<strong>系统将无法正常部署</strong></li><li><strong>系统部署请尽量正确联网</strong>，如未正确联网导致部署错误，可能会导致开机提示错误，需要重新联网执行osc.exe</li><li>部分杀软提示有病毒，大概率是<strong>误报</strong>，请仔细甄别并手动添加信任，推荐使用<strong>火绒安全软件</strong>、360安全卫士极速版</li><li>此封装作品<strong>可自定义性较强</strong>，我们欢迎对该作品进行<strong>二次修改</strong>使用，如 OEM 定制、批量装机、装机联盟推广等</li><li>本镜像仅供学习交流测试，请在24小时内自行删除，<strong>如需长期使用请确保获得正规的正版系统授权</strong>，否则<strong>一切版权纠纷及后果由使用者自行承担</strong></li><li>如果在使用过程中遇到BUG，或者有好的建议，<strong>欢迎到联系我们进行反馈</strong></li></ol><h2 id="获取方式"><a href="#获取方式" class="headerlink" title="获取方式"></a>获取方式</h2><h3 id="【荐】潇然一键装机助理的在线重装功能"><a href="#【荐】潇然一键装机助理的在线重装功能" class="headerlink" title="【荐】潇然一键装机助理的在线重装功能"></a>【荐】潇然一键装机助理的在线重装功能</h3><p>潇然系统<strong>已升级</strong>为<a href="https://xrgzs.github.io/xronekey">潇然一键装机助理</a>的<strong>在线重装</strong>功能，<strong>省去了大量重复的工作</strong>，实现系统镜像实时构建，<strong>支持接管官方、第三方系统为潇然系统！</strong></p><p><img src="https://m.360buyimg.com/babel/jfs/t1/221660/16/23872/56859/63f335ceF90a92c8c/694cf73acf7dfc7d.png"></p><h3 id="自行构建最新版潇然系统"><a href="#自行构建最新版潇然系统" class="headerlink" title="自行构建最新版潇然系统"></a>自行构建最新版潇然系统</h3><p>潇然系统已升级为<a href="https://xrgzs.github.io/xronekey">潇然一键装机助理</a>的<strong>在线重装</strong>功能，<strong>仅支持使用<a href="https://xrgzs.github.io/xronekey">潇然一键装机助理</a>在线下载并构建本系列系统镜像</strong>，但这<strong>并不意味着机子没法联网、使用第三方装机工具就不能部署潇然系统</strong>。</p><p>潇然系统现<strong>已全面实现组件的离线化</strong>，您只需要在<strong>下载组件的过程联网</strong>就行了。</p><p>当然，您可以在<a href="https://xrgzs.github.io/xronekey">潇然一键装机助理</a>里面<strong>取消勾选“安装完成后重启”</strong>，待镜像恢复完成后<strong>使用“系统备份”功能</strong>把系统镜像又<strong>重新备份</strong>出来，即可获得<strong>最新构建好的潇然系统镜像</strong>。</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/222614/40/21706/86477/63f45d6eFa3b4b475/0fb66a81e92a64e2.png"></p><p>参考：<a href="https://xrgzs.github.io/posts/xrsys-build-image.html">《潇然系统镜像构建教程》</a></p><p>有了<strong>构建好的潇然系统镜像</strong>，您就可以通过<strong>纯净版 WinPE 维护系统</strong>进行恢复，如<a href="https://www.itsk.com/thread-404842-1-1.html">IT天空优启通</a>、<a href="https://firpe.cn/page-247">FirPE</a>、<a href="https://www.puresys.net/701.html">USBOS</a>、<a href="https://www.wepe.com.cn/">微PE</a>、<a href="https://home.edgeless.top/">Edgeless</a>等。</p><p>请勿使用大白菜、老毛桃、电脑店、U启动等流氓PE，小白、韩博士、黑、白云等装机工具，这些PE或装机工具会修改我们封装工具的配置文件，导致相关 API 无法被正常调用，影响系统部署的完整性，还会附带流氓软件、推广驱动、浏览器书签、主页锁定木马、后台刷量木马。<strong>出现这种情况与我们无关，后果自负！</strong></p><p><strong>对于自行构建的潇然系统镜像，安装后的任何问题，包括但不限于流氓软件、推广驱动、主页锁定、浏览器书签等，一律与我们无关！</strong></p><h3 id="【新】一行代码在线重装-Windows"><a href="#【新】一行代码在线重装-Windows" class="headerlink" title="【新】一行代码在线重装 Windows"></a>【新】一行代码在线重装 Windows</h3><p><strong>⚠警告：此脚本程序目前处于内部测试阶段，如有问题请及时向我反馈！</strong></p><ol><li><p><strong>保持网络连接通畅</strong>，建议连接网线或 5Ghz WiFi。</p></li><li><p><strong>确保系统有 D 盘</strong>，且系统组件完整，如无 D 盘可接上一块移动硬盘</p></li><li><p><strong>退出所有杀毒软件</strong>，<strong>包括360、火绒、WD 等都要退出！</strong>（程序使用了特殊方式下载文件，100%报毒，不报毒的不是好杀软）</p></li><li><p>将下面的代码复制到 Win + R <strong>“运行”</strong> 或 <strong>“命令提示符”</strong> 或 <strong>“PowerShell”</strong> 或 <strong>“Windows 终端”</strong>。</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/51880/4/21869/51747/63f87197Fa420a25c/2f46017fe544da45.png"></p></li><li><p>之后程序会<strong>自动</strong>完成后续工作，中途无需用户交互，真正做到<strong>“一键化”</strong>。</p><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/9b9e1e2251b1487870fe6e6aa7786392.png"></p></li></ol><p><strong>一行代码——重装 Windows 11 64位 专业版：</strong></p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">cmd</span> <span class="token parameter attr-name">/c</span> <span class="token string">"cd /d %TMP% &amp;regsvr32 /u /s /i:http://url.xrgzs.top/c/aria2c.sct scrobj.dll &amp;aria2c --allow-overwrite=true --check-certificate=false -o reinstwin.bat http://url.xrgzs.top/reinstwin &amp;reinstwin.bat win1164pro"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>一行代码——重装 Windows 10 64位 专业版：</strong></p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">cmd</span> <span class="token parameter attr-name">/c</span> <span class="token string">"cd /d %TMP% &amp;regsvr32 /u /s /i:http://url.xrgzs.top/c/aria2c.sct scrobj.dll &amp;aria2c --allow-overwrite=true --check-certificate=false -o reinstwin.bat http://url.xrgzs.top/reinstwin &amp;reinstwin.bat win1064pro"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>一行代码——重装 Windows 7 64位 旗舰版 万能驱动：</strong></p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">cmd</span> <span class="token parameter attr-name">/c</span> <span class="token string">"cd /d %TMP% &amp;regsvr32 /u /s /i:http://url.xrgzs.top/c/aria2c.sct scrobj.dll &amp;aria2c --allow-overwrite=true --check-certificate=false -o reinstwin.bat http://url.xrgzs.top/reinstwin &amp;reinstwin.bat win764ult"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>一行代码——重装 Windows 7 32位 旗舰版 万能驱动：</strong></p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">cmd</span> <span class="token parameter attr-name">/c</span> <span class="token string">"cd /d %TMP% &amp;regsvr32 /u /s /i:http://url.xrgzs.top/c/aria2c.sct scrobj.dll &amp;aria2c --allow-overwrite=true --check-certificate=false -o reinstwin.bat http://url.xrgzs.top/reinstwin &amp;reinstwin.bat win732ult"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>一行代码——重装 Windows XP 32位 专业版 万能驱动：</strong></p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">cmd</span> <span class="token parameter attr-name">/c</span> <span class="token string">"cd /d %TMP% &amp;regsvr32 /u /s /i:http://url.xrgzs.top/c/aria2c.sct scrobj.dll &amp;aria2c --allow-overwrite=true --check-certificate=false -o reinstwin.bat http://url.xrgzs.top/reinstwin &amp;reinstwin.bat winxp32pro"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>一行代码——自选安装版：</strong></p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">cmd</span> <span class="token parameter attr-name">/c</span> <span class="token string">"cd /d %TMP% &amp;regsvr32 /u /s /i:http://url.xrgzs.top/c/aria2c.sct scrobj.dll &amp;aria2c --allow-overwrite=true --check-certificate=false -o reinstwin.bat http://url.xrgzs.top/reinstwin &amp;reinstwin.bat"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>注：本产品基于<strong>潇然一键装机助理</strong>开发，但<strong>不依赖其在线重装功能</strong>，系统为纯净版，只包含压缩软件、输入法！</p><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="关于版本和文件名"><a href="#关于版本和文件名" class="headerlink" title="关于版本和文件名"></a>关于版本和文件名</h3><h4 id="原版系统"><a href="#原版系统" class="headerlink" title="原版系统"></a>原版系统</h4><p>通常情况下，我们会标注<strong>原版系统的镜像名称</strong>，方便大家到<strong>数据库</strong>里面查询，通过MD5、SHA-1文件校验来验证下载的系统镜像是否完整、是否原版。</p><p>因此，<strong>潇然一键装机助理是您下载原版镜像的好帮手！</strong></p><p><img src="https://m.360buyimg.com/babel/jfs/t1/158226/30/34866/3740/63f334c2F66fcc647/5128ed046ae24be4.png"></p><blockquote><p>附：MSDN 数据库查询地址</p><ol><li><a href="https://files.rg-adguard.net/">List of files by Microsoft</a>：推荐，数据库最新，仅提供部分下载链接</li><li><a href="https://msdn.itellyou.cn/">MSDN, 我告诉你</a>：数据库较老，但提供下载链接</li></ol></blockquote><h4 id="第三方系统"><a href="#第三方系统" class="headerlink" title="第三方系统"></a>第三方系统</h4><p>通常情况下，我们会标注<strong>第三方系统镜像的实测信息</strong>，方便大家按需使用。对于系统列表里面的第三方系统，我们基本上都做过大量的测试，<strong>保证信息可靠性大于原版</strong>。</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/162177/37/35106/29361/63f33af1F578cc379/e095b2c62226b3e5.png"></p><p><strong>部分系统原本为装机推广版，请勿手动下载后安装！</strong></p><h4 id="仅适用于-Xiaoran-System-Legacy"><a href="#仅适用于-Xiaoran-System-Legacy" class="headerlink" title="仅适用于 Xiaoran System Legacy"></a>仅适用于 Xiaoran System Legacy</h4><details><summary>展开查看</summary><p><img src="https://m.360buyimg.com/babel/jfs/t1/139161/19/24046/50251/63f34c85F2fa54a48/939fd6c21dad885b.png"></p><blockquote><h4 id="精简等级"><a href="#精简等级" class="headerlink" title="精简等级"></a>精简等级</h4><ul><li><p><strong>a 完整版：</strong>保留系统的所有功能，有时甚至还会增加组件（如常用运行库）。</p></li><li><p><strong>b 适度精简版（发布时标题不带精简等级）：</strong>精简一些多余功能（如 Win10 自带的 APP），但不影响正常稳定使用（如保留商店和 Edge，精简的 APP 能重新下回）。</p></li><li><p><strong>c 精简版：</strong>精简大部分用户用不到的功能，降低内存占用，可能会出现兼容性问题。</p></li><li><p><strong>d 极限精简版：</strong>极限精简系统的功能，系统体积超小，可能会不稳定。</p></li></ul><h4 id="系统代号"><a href="#系统代号" class="headerlink" title="系统代号"></a>系统代号</h4><ul><li><strong>soft 装机版：</strong>包含常用软件。</li><li><strong>office 办公版：</strong>仅包含办公软件。</li><li><strong>pure 纯净版：</strong>仅包含系统，不包含软件。</li></ul><h4 id="打包格式"><a href="#打包格式" class="headerlink" title="打包格式"></a>打包格式</h4><ul><li><p><strong>esd：</strong>微软新镜像格式，体积最小，需使用 PE 系统还原。</p></li><li><p><strong>wim：</strong>微软镜像格式，体积小，需使用 PE 系统还原。</p></li><li><p><strong>gho：</strong>Ghost 镜像老格式，体积一般，可使用 PE 系统或 DOS 系统还原。</p></li></ul></blockquote></details><h4 id="下载信息"><a href="#下载信息" class="headerlink" title="下载信息"></a>下载信息</h4><h5 id="下载服务器"><a href="#下载服务器" class="headerlink" title="下载服务器"></a>下载服务器</h5><ol><li>如果未标注，默认为潇然网盘直链解析，通常为负载均衡，速度 200 Mbps 以下。</li><li>如果标注了 <code>od</code>，通常为 OneDrive 国际版，速度不稳定，电信较慢，速度 10 Mbps 以下。</li><li>如果标注了 <code>3ser</code>，通常为第三方服务器提供更加高级的网盘直链解析，速度更快，可以跑满千兆宽带。</li><li>如果标注了 <code>cdn</code>，通常为第三方 OSS 储存提供的高速 CDN 下载服务，速度最快，可以跑满千兆宽带。</li></ol><h5 id="系统格式"><a href="#系统格式" class="headerlink" title="系统格式"></a>系统格式</h5><ol><li><p>未标明：wim 或 esd，通常为第三方打包系统镜像。</p></li><li><p><code>esd</code>：微软 Electronic Software Download 官方原版新镜像格式，体积最小，带数字签名，通常抓取自 Windows Update，通常为微软官方服务器，但经常下载错误。</p></li><li><p><code>iso</code>：光盘镜像格式，桌面环境下安装需解压复制，建议重启到PE后安装，避免出现解压复制后文件校验出错的问题。</p></li><li><p><code>gho</code>：Ghost 镜像老格式，体积较大，还原时占用系统资源较低，老机推荐。</p></li></ol><h3 id="关于系统来源的说明"><a href="#关于系统来源的说明" class="headerlink" title="关于系统来源的说明"></a>关于系统来源的说明</h3><p>标有“原版”字样为微软 MSDN &#x2F; MVS &#x2F; ESD 原版的系统，支持到数据库查询，其他为第三方升级版、封装版、精简版。</p><h4 id="系统是原版、正版吗？"><a href="#系统是原版、正版吗？" class="headerlink" title="系统是原版、正版吗？"></a>系统是原版、正版吗？</h4><p>标有“原版”字样的属于原版。<strong>是否正版得看你的设备是否获得了对应操作系统的授权。</strong></p><p><strong>品牌机安装 Windows 10&#x2F;11 家庭版系统通常都为正版。</strong></p><p>我们不提供盗版激活服务器。<strong>使用盗版软件造成的后果由使用者自行承担！</strong></p><h4 id="系统列表内的原版、第三方系统是否为潇然系统？"><a href="#系统列表内的原版、第三方系统是否为潇然系统？" class="headerlink" title="系统列表内的原版、第三方系统是否为潇然系统？"></a>系统列表内的原版、第三方系统是否为潇然系统？</h4><p>潇然系统<strong>支持接管官方、第三方系统为潇然系统</strong>，方法是通过接管系统部署流程，同时调用第三方系统内的万能驱动，以达到<strong>系统精简风格多样化</strong>、<strong>系统文件利用高效化</strong>、<strong>网络资源利用最大化</strong>。</p><blockquote><p>附：潇然系统接管部署规则：</p><ol><li>原版、精简版等使用官方封装工具<code>C:\Windows\System32\Sysprep\sysprep.exe</code>封装的系统，我们通过修改替换<code>C:\Windows\Panther\Unattend.xml</code>文件来接管部署</li><li>第三方封装版等使用第三方封装工具封装的系统，我们通过修改替换第三方封装工具部署插件的配置文件来接管部署</li><li>第三方封装版等使用第三方封装工具加密封装的系统，我们通过修改替换第三方封装工具部署插件来接管部署</li><li>第三方封装版等使用第三方封装工具和随机文件名反修改手段封装的系统，我们为了保证稳定性，通过修改替换进桌面调用的软件安装器来接管部署</li><li>第三方封装版等使用第三方封装工具和文件校验反修改手段封装的系统，我们无法自动接管部署，但可以在桌面或C盘根目录放置<code>系统优化.exe</code>，即潇然系统优化组件 Xiaoran Optimize System Component <code>osc.exe</code>，让用户手动运行来接管部署</li><li>系统已部署完成，或品牌机预装系统，先禁用 Windows Defender 等杀软的实时保护，通过浏览器访问：<a href="http://url.xrgzs.top/osc">http://url.xrgzs.top/osc</a> ，下载<code>osc.exe</code>，让用户手动下载运行来接管部署</li></ol></blockquote><p>由上可知，基本上任何系统，甚至连<strong>品牌机预装的系统，都可以改装为潇然系统！</strong></p><h3 id="关于驱动的说明"><a href="#关于驱动的说明" class="headerlink" title="关于驱动的说明"></a>关于驱动的说明</h3><p>主板驱动&#x3D;网卡+主板，双驱动&#x3D;天空(仅主板)+总裁(仅声显)，第三方系统已包含驱动大小。</p><p><strong>笔记本</strong>（尤其是<strong>新款</strong>轻薄本、Evo本、翻转本等<strong>具有特殊定制功能的</strong>）请<strong>尽量选择主板驱动的版本</strong>，待系统进入桌面后<strong>通过 Windows Update 下载经微软和品牌方认证的最佳驱动</strong>。</p><p>一些品牌（联想、戴尔、惠普、华硕、华为等）亦可通过<strong>其品牌的电脑管家</strong>（非腾讯、微软等流氓）安装和更新驱动，<strong>顺便获取型号专用的超频、优化等配套工具及详细使用说明书</strong>。</p><blockquote><p>附：一些品牌的电脑管家下载</p><p><a href="https://consumer.huawei.com/cn/support/pc-manager/">华为电脑管家</a><a href="https://www.mi.com/service/notebook/drivers">小米电脑驱动</a><a href="https://guanjia.lenovo.com.cn/">联想电脑管家</a></p><p><a href="https://downloads.dell.com/serviceability/catalog/SupportAssistInstaller.exe">Dell SupportAssist</a><a href="https://support.hp.com/cn-zh/help/hp-support-assistant">HP Support Assistant</a><a href="https://www.asus.com.cn/supportonly/armoury%20crate/helpdesk_download/">ASUS Armoury Crate</a> (仅ROG及新款)</p><p><a href="https://dsadata.intel.com/installer">Intel Driver and Support Assistant</a><a href="https://www.nvidia.cn/geforce/geforce-experience/">NVIDIA GeForce Experience</a></p></blockquote><p><strong>对于搭载 Intel 11 代及以上 CPU 的部分新机器，请尽量到品牌官网服务中输入机型序列号下载所有驱动后手动安装，否则即便您用官方电脑管家也无法打上驱动！</strong></p><blockquote><p>附：Windows常用品牌驱动下载</p><p><a href="https://www.intel.cn/content/www/cn/zh/download-center/home.html">Intel官方驱动</a></p><p><a href="http://www.nvidia.cn/Download/index.aspx?lang=cn">Nvidia官方驱动 </a><a href="http://www.nvidia.cn/Download/Find.aspx?lang=cn">Nvidia官方历史驱动 </a><a href="http://www.amd.com/zh-hans/support">AMD官方驱动</a></p><p><a href="http://www.hasee.com/after/index">神州官方驱动 </a><a href="http://consumer.huawei.com/cn/support/driver-list">华为官方驱动 </a><a href="http://newsupport.lenovo.com.cn/">联想官方驱动</a></p><p><a href="https://www.mechrevo.com/service/">机械革命官方驱动 </a><a href="https://www.machenike.com/offline/driverUnit">机械师官方驱动 </a><a href="https://www.thunderobot.com/service/download.html">雷神官方驱动</a></p><p><a href="http://www.asus.com.cn/support/Download-Center">华硕官方驱动 </a><a href="http://www.gigabyte.cn/Support">技嘉官方驱动 </a><a href="http://cn.msi.com/support/download">微星官方驱动</a></p><p><a href="http://www.dell.com/support/home/zh-cn?app=drivers">戴尔官方驱动 </a><a href="http://support.hp.com/cn-zh/drivers">惠普官方驱动 </a><a href="http://www.samsung.com/cn/support">三星官方驱动</a></p><p>其它找不到的，请使用必应搜索（<a href="https://cn.bing.com/">bing.com</a>），百度可能找不到您想要的结果</p></blockquote><p>同时，对于没有提供官方驱动管理的其它品牌或老款机型，我们也会在<strong>桌面</strong>上还有<strong>常用工具</strong>文件夹内放置<strong>驱动大师</strong>，可以使用它对驱动进行补全安装，<strong>对国产品牌和老机型支持较好</strong>。</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/157806/29/34817/297953/63f342f7F886d880e/a53b7e563960fd7f.png"></p><p><strong>新平台版本系统</strong>直接集成驱动，<strong>仅适用于新平台机器安装 Windows 7</strong>，内含修改版驱动，<strong>非必要请勿安装！</strong></p><p><img src="https://m.360buyimg.com/babel/jfs/t1/175097/18/34038/9505/63f34e1bF6e36af82/58e0a87d63250858.png"></p><h4 id="显卡驱动无法正常工作，怎么解决？"><a href="#显卡驱动无法正常工作，怎么解决？" class="headerlink" title="显卡驱动无法正常工作，怎么解决？"></a>显卡驱动无法正常工作，怎么解决？</h4><p>系统为非主板驱动版本，安装完成后，显卡驱动无法正常工作，工作中的显卡为 <strong>Microsoft 基本显示驱动程序</strong>，分辨率<strong>1024x768</strong>，怎么解决？</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/79140/3/19633/431561/63f34f06Fed08bdf5/f01d08d2dca7f64d.png"></p><p>这种问题通常发生在 <strong>AMD 老式显卡</strong>上，其驱动程序已停在早期版本，由于 <strong>AMD 最新驱动程序的配置文件仍然包含该型号</strong>，导致<strong>万能驱动程序错误识别并安装</strong>，无法驱动。</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/98798/33/36909/74688/63f3500dF7fc79b72/b33cc0d60d0126ce.png"></p><p>由于显卡型号数量庞大，万能驱动仅靠内置的 5、6 个驱动包是无法做到一一对应的，虽然可以兼容大部分显卡，如 Intel、NVIDIA 的显卡，但是部分显卡，<strong>尤其是 AMD 的笔记本独立显卡和老款 OEM 台式机显卡</strong>，型号各式各样，功能千变万化，为了定制功能甚至还包含了集成显卡的驱动，给驱动安装、升级带来了非常麻烦的体验。对于这类显卡，<strong>使用万能驱动包通常会出现打感叹号、无法驱动的问题</strong>，因此我们便需要卸载驱动，安装官方版本。</p><p>万能驱动虽然方便，但<strong>我们仍然推荐您安装”主板驱动“版本的系统，尤其是笔记本，上述就是原因的其中之一。</strong></p><blockquote><p>附：推荐安装”主板驱动“版本的原因</p><ol><li>驱动包体积较小，方便传输</li><li>Windows 10&#x2F;11 系统虽已内置大量网卡驱动，但不足以覆盖到超新和超老设备</li><li>原版 Windows 7 系统只内置了 2007-2011 年部分设备的驱动，且版本较老</li><li>部分笔记本触摸板、键盘、压感触屏驱动 Windows 系统没有内置</li><li>新机杜比&#x2F;DTS音效如果使用万能驱动则无法正常启用</li><li>部分笔记本安装兼容显卡驱动显卡切换功能无法使用</li><li>部分机型安装兼容显卡驱动后会蓝屏</li><li>AMD 的笔记本独立显卡和老款 OEM 台式机显卡使用万能驱动包通常会出现打感叹号、无法驱动的问题</li></ol><p>当然，部分机型安装“主板驱动”版本也会蓝屏，但几率很小，发生了也只需删除 <code>C:\Windows\Setup\Set\wandrv.iso</code> 后重新安装即可。</p></blockquote><p>注意：<strong>部分机型暂无 Windows 8&#x2F;10&#x2F;11 的驱动</strong>（以后估计也不会有了），少数机型可能会提供 Windows 8 驱动。在这些机型上安装 Windows 10&#x2F;11，您没必要折腾独立显卡驱动，因为<strong>根本就没驱动，只能用集显</strong>。如果舍不得，请尝试降级 Windows 7&#x2F;8 系统。</p><p>要解决该问题，可以<strong>卸载当前的显卡驱动</strong>，使用 Windows Update、<strong>360驱动大师</strong>等工具获取到最新的官方驱动。</p><p>请务必使用<strong>专用的显卡驱动卸载工具</strong>卸载，<strong>否则无法彻底删除</strong>驱动文件！</p><p>具体怎么卸载显卡驱动，下一问会提供详细步骤。</p><p><strong>卸载完成后安装驱动即可解决</strong>，通常 Windows 8&#x2F;10&#x2F;11 会自动安装，如没有安装请手动到 Windows Update 中检查更新，其它版本系统请使用360驱动大师。图中工具为 WUMT，<code>桌面\常用工具\系统工具</code>里面有提供。</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/166288/19/30469/334227/63f35c02F01e43109/f9b3efb33106b19d.png"></p><p><img src="https://m.360buyimg.com/babel/jfs/t1/174929/4/28928/256527/63f35d32Fb2805e95/ee27fac0afbf272d.png"></p><h4 id="如何正确卸载显卡驱动？"><a href="#如何正确卸载显卡驱动？" class="headerlink" title="如何正确卸载显卡驱动？"></a>如何正确卸载显卡驱动？</h4><p><strong>警告：部分系统卸载显卡驱动开机会黑屏，请谨慎操作！</strong>（常见于 GPT+UEFI 安装的 Windows 7）</p><blockquote><p>附：显卡驱动卸载工具</p><ul><li><a href="https://www.wagnardsoft.com/display-driver-uninstaller-DDU-">Display Driver Uninstaller (DDU)</a></li><li><a href="https://www.amd.com/zh-hans/support/kb/faq/gpu-601">AMD Cleanup Utility</a></li></ul><p>关于显卡驱动更多知识，可以前往<a href="https://www.guru3d.com/">Guru3D.com</a>进行更深入的学习。</p></blockquote><p>我们推荐使用 <a href="https://www.wagnardsoft.com/display-driver-uninstaller-DDU-">Display Driver Uninstaller (DDU)</a> 工具来卸载显卡驱动程序。我们已在<code>桌面\常用工具\驱动安装</code>文件夹内集成了该工具。</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/108812/27/35177/273238/63f35557F43d33986/54a39d8a5be9fa58.png"></p><p>首次运行程序，会弹出几个窗口，我们点击确定。弹出选项窗口后，我们按照以下配置，然后点击确定。</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/193041/19/32615/248700/63f3573cFc61edf89/72b3b8446360a324.png"></p><p>选择对应设备，点击清除，5-15分钟后机器会自动重启。<strong>建议全程断网操作！</strong></p><p><img src="https://m.360buyimg.com/babel/jfs/t1/142618/16/33649/245047/63f35990F79c87e65/1a13ee1641e9dc35.png"></p><h3 id="关于关于办公软件的说明"><a href="#关于关于办公软件的说明" class="headerlink" title="关于关于办公软件的说明"></a>关于关于办公软件的说明</h3><p>标有 20XX 办公的为微软 Office 完整版，非精简版，体积较大。未标有办公的为金山 WPS 专业版。</p><p><strong>请不要吝啬硬盘空间，我们能提供给您最好的办公体验！</strong></p><blockquote><p>附：潇然系统 Office 办公软件安装规则：</p><ol><li>如果下载了 Microsoft Office 就装 Microsoft Office</li><li>如果系统已经安装了 Office 就跳过</li><li>如果系统没装任何 Office 就装 WPS Office</li></ol><p>我们的 Office Pack 均支持导出 PDF 文件（包括 2007），网页浏览器均支持阅读 PDF ，因此不再集成体积庞大的 Acrobat。</p></blockquote><h4 id="WPS-不是有广告、要收费吗？我不喜欢用-WPS！"><a href="#WPS-不是有广告、要收费吗？我不喜欢用-WPS！" class="headerlink" title="WPS 不是有广告、要收费吗？我不喜欢用 WPS！"></a>WPS 不是有广告、要收费吗？我不喜欢用 WPS！</h4><p>潇然系统列表内未标有办公的为金山 WPS <strong>专业版</strong>，内置部分个人版需要登录、会员的功能，如文件转图、PPT自动换模板等。如果您的系统不支持专业版，我们也会安装官方个人精简<strong>去广告版</strong>，完全不用担心广告问题！</p><p>如果您不喜欢用 WPS，我们也在<code>桌面\潇然软件商店</code>提供了全系列 Microsoft Office 的安装包，只需在线下载安装即可，亦可使用 <a href="https://otp.landian.vip/zh-cn/">Office Tool Plus</a> 部署更多的 Office！</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/148906/8/28585/35436/63f4622fFcad81801/e8a2eafc76b44b86.png"></p><h3 id="关于装机版-x2F-纯净版的说明"><a href="#关于装机版-x2F-纯净版的说明" class="headerlink" title="关于装机版&#x2F;纯净版的说明"></a>关于装机版&#x2F;纯净版的说明</h3><p>默认为装机版，安装潇然工作室特殊优化版的办公、聊天、输入法、压缩、影音、安全软件。</p><p>如需纯净版，到安装目录下运行<code>潇然一键装机助理 开启纯净模式.bat</code>！</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/66114/2/25744/216969/63f35d71Fdf4f403a/870ec60e448bad57.png"></p><h4 id="装机版会安装哪些软件？"><a href="#装机版会安装哪些软件？" class="headerlink" title="装机版会安装哪些软件？"></a>装机版会安装哪些软件？</h4><p>实时更新，支持定制，精髓所在，参考：<a href="http://url.xrgzs.top/oscsoft">OSC Online Software 的配置文件</a>。</p><h4 id="关于安全套装的说明"><a href="#关于安全套装的说明" class="headerlink" title="关于安全套装的说明"></a>关于安全套装的说明</h4><p>潇然系统默认安装360安全卫士极速版、360安全浏览器，但是为<strong>潇然工作室特别优化去广告版</strong>，如需纯净版可以运行卸载程序进行切换。</p><p>当然，如果您不喜欢360安全软件，作为潇然系统最拿手的定制环节，我们也为您准备了<strong>火绒安全软件</strong>，并配置好了规则，自动拦截360安全软件等多款流氓软件的安装。您只需要<strong>在C盘外任意盘符的根目录创建<code>zjsoftHR.txt</code>文件，即可让安装程序自动配置好火绒安全软件。</strong></p><p>如果您喜欢让电脑裸奔，您还可以<strong>在C盘外任意盘符的根目录创建<code>zjsoftsafeno.txt</code>文件，这样就不会安装上任何一款杀毒软件</strong>，但这么做的话会存在风险，请三思而后行！</p><h4 id="pack-rar是什么文件？"><a href="#pack-rar是什么文件？" class="headerlink" title="pack.rar是什么文件？"></a>pack.rar是什么文件？</h4><p>根据<a href="http://url.xrgzs.top/oscsoft">OSC 在线软件安装模块的配置文件</a>，每隔两天<strong>自动构建生成的离线软件包</strong>，用于<strong>支持断网环境</strong>安装软件。</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/219249/39/26482/170182/63f375ecFb42d5ab2/e8831eab21bcac44.png"></p><p>如果能够联网则不需要，<strong>删除后须联网实时构建</strong>。</p><p>另外，如果想要定制，可以将 pack.rar 解压到 <code>C:\Windows\Setup\Set\osc\</code> 目录下，并创建 <code>unpacked.log</code> 打上 TAG，然后在 <code>C:\Windows\Setup\</code> 下创建 <code>zjsoftforceoffline.txt</code> 打上 TAG。</p><h3 id="关于网络的说明"><a href="#关于网络的说明" class="headerlink" title="关于网络的说明"></a>关于网络的说明</h3><p>此产品将<strong>长期处于开发调试阶段</strong>，我们的测试服务器性能较弱，如果无法访问，说明<strong>正在整改</strong>或<strong>遭受 DDOS 攻击</strong>，<del>神仙来了都没办法</del>。</p><p><strong>目前由于特殊原因，注销了国内服务器和域名的备案，以及个人没有精力维护下载服务器，网络及服务质量会降低，请谅解。</strong></p><h4 id="为什么程序提示下载失败，请重试？"><a href="#为什么程序提示下载失败，请重试？" class="headerlink" title="为什么程序提示下载失败，请重试？"></a>为什么程序提示下载失败，请重试？</h4><p>一般出现这种问题，是由多种原因造成的，以下为其中的几个原因：</p><ol><li>下载网盘解析服务器故障。<strong>建议重试安装几次，不行换个镜像！</strong></li><li>文件被启动器损坏。检查 <code>C:\Temp\UjyQii</code> 目录下的文件是否已被删的一干二净，最好彻底退出以后<strong>重新运行潇然一键装机助理</strong>，如果不行请尝试<strong>重新安装</strong>软件！</li><li>文件被杀毒软件损坏。建议<strong>退出所有杀毒软件重试！</strong></li></ol><h4 id="我的笔记本电脑只能连接-WiFi，能支持在线实时构建吗？"><a href="#我的笔记本电脑只能连接-WiFi，能支持在线实时构建吗？" class="headerlink" title="我的笔记本电脑只能连接 WiFi，能支持在线实时构建吗？"></a>我的笔记本电脑只能连接 WiFi，能支持在线实时构建吗？</h4><p>可以，只要在<strong>安装系统前备份 WiFi 密码</strong>到 <code>D:\Xiaoran\WLANPassword</code>，部署过程中安装上了对应的网卡驱动，进入桌面后程序会自动连接 WiFi 网络，和接了网线一样。</p><p>备份 WiFi 密码的操作一般在桌面环境下<strong>联网运行潇然一键装机助理</strong>即可<strong>自动完成</strong>，备份的标志是在 <code>D:\Xiaoran\WLANPassword</code> 下有 <code>*.xml</code> 文件。</p><h4 id="自行构建最新版潇然系统-1"><a href="#自行构建最新版潇然系统-1" class="headerlink" title="自行构建最新版潇然系统"></a>自行构建最新版潇然系统</h4><p><strong>如需自行构建最新版潇然系统，请看下面这篇文章：</strong><br><a href="https://xrgzs.github.io/posts/xrsys-build-image.html">《潇然系统镜像构建教程》</a></p><p><strong>以下信息仅供参考，不一定适用于最新潇然系统！</strong></p><details><summary>展开查看</summary><p>可使用<code>DISM.exe</code>挂载进行 DIY 定制，如增删自动静默安装的软件，参考挂载命令如下：</p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">set</span> <span class="token variable">filename</span><span class="token operator">=</span>原系统ESD格式的文件名，如xrsys<span class="token operator">_</span>win10pro<span class="token operator">_</span>21h2<span class="token operator">_</span>64<span class="token operator">_</span>a<span class="token operator">_</span>soft<span class="token operator">_</span>2021<span class="token operator">_</span>12</span><span class="token command"><span class="token keyword">DISM</span>.exe /Export-Image <span class="token parameter attr-name">/SourceImageFile<span class="token punctuation">:</span></span><span class="token string">"%filename%.esd"</span> <span class="token parameter attr-name">/SourceIndex<span class="token punctuation">:</span></span><span class="token number">1</span> <span class="token parameter attr-name">/DestinationImageFile<span class="token punctuation">:</span></span><span class="token string">"%filename%.wim"</span></span><span class="token command"><span class="token keyword">move</span> <span class="token parameter attr-name">/y</span> <span class="token string">"%filename%.esd"</span> <span class="token string">"%filename%_old.esd"</span></span><span class="token command"><span class="token keyword">mkdir</span> <span class="token string">"%filename%"</span></span><span class="token command"><span class="token keyword">DISM</span>.exe /Mount-Image <span class="token parameter attr-name">/ImageFile<span class="token punctuation">:</span></span><span class="token string">"%filename%.wim"</span> <span class="token parameter attr-name">/Index<span class="token punctuation">:</span></span><span class="token number">1</span> <span class="token parameter attr-name">/MountDir<span class="token punctuation">:</span></span><span class="token string">"%filename%"</span></span><span class="token command"><span class="token keyword">echo</span> 挂载完成，请抓紧时间修改！</span><span class="token command"><span class="token keyword">start</span> <span class="token parameter attr-name">/max</span> explorer <span class="token string">"%filename%"</span></span><span class="token command"><span class="token keyword">pause</span></span><span class="token command"><span class="token keyword">echo</span> 卸载并提交更改？</span><span class="token command"><span class="token keyword">pause</span></span><span class="token command"><span class="token keyword">DISM</span>.exe /Unmount-Wim <span class="token parameter attr-name">/MountDir<span class="token punctuation">:</span></span><span class="token string">"%filename%"</span> <span class="token parameter attr-name">/commit</span></span><span class="token command"><span class="token keyword">rd</span> <span class="token parameter attr-name">/s</span> <span class="token parameter attr-name">/q</span> <span class="token string">"%filename%"</span></span><span class="token command"><span class="token keyword">echo</span> 卸载并提交更改完成, 保存镜像为ESD格式？</span><span class="token command"><span class="token keyword">pause</span></span><span class="token command"><span class="token keyword">DISM</span>.exe /Export-Image <span class="token parameter attr-name">/SourceImageFile<span class="token punctuation">:</span></span><span class="token string">"%filename%.wim"</span> <span class="token parameter attr-name">/SourceIndex<span class="token punctuation">:</span></span><span class="token number">1</span> <span class="token parameter attr-name">/DestinationImageFile<span class="token punctuation">:</span></span><span class="token string">"%filename%.esd"</span> <span class="token parameter attr-name">/Compress<span class="token punctuation">:</span></span>recovery</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>亦可使用图形化的 DISM++ 进行挂载，但稳定性欠佳，此处由于篇幅不再介绍。</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/101691/18/36452/53418/63f36678F0bd578cc/8a14ba5c8e205335.png"></p><p>封装时调用到的程序包大多使用<code>WinRAR Sfx</code>打包制作，可对其内文件进行修改。</p></details><h3 id="关于文件大小的说明"><a href="#关于文件大小的说明" class="headerlink" title="关于文件大小的说明"></a>关于文件大小的说明</h3><p>仅代表<strong>底层系统镜像</strong>文件的大小，<strong>非实际</strong>下载文件的大小。</p><p><strong>一般需要下载9 GB(软件＜2 GB，驱动＞2 GB,办公≈3 GB)大小的文件！</strong></p><p>下载路径为磁盘各分区下的 <code>OSDownload</code> 目录</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/84599/10/23915/97482/63f45b88F3e194af1/888c27ee85ddb1ec.png"></p><p>TIPS：下载完成后，如不需要某文件，如 <code>pack.rar</code> 或 <code>wandrv.iso</code> ，目前可以直接删除，不会报错</p><h3 id="【重要】关于自定义和接口的说明"><a href="#【重要】关于自定义和接口的说明" class="headerlink" title="【重要】关于自定义和接口的说明"></a>【重要】关于自定义和接口的说明</h3><h4 id="潇然系统在封装工具中的调用参数"><a href="#潇然系统在封装工具中的调用参数" class="headerlink" title="潇然系统在封装工具中的调用参数"></a>潇然系统在封装工具中的调用参数</h4><p>对于任何系统封装工具，都需要将 <a href="http://url.xrgzs.top/xrsysapi">api.exe</a> 和 <a href="http://url.xrgzs.top/osc">osc.exe</a> （点击下载）放入 <code>C:\Windows\Setup\Set</code> 文件夹中，推荐进 PE 打包前放入</p><h5 id="Unattend-xml"><a href="#Unattend-xml" class="headerlink" title="Unattend.xml"></a>Unattend.xml</h5><h6 id="Windows-8-1-11-64位-用-："><a href="#Windows-8-1-11-64位-用-：" class="headerlink" title="Windows 8.1-11+ 64位 用 ："></a>Windows 8.1-11+ 64位 用 ：</h6><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>unattend</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>urn:schemas-microsoft-com:unattend<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">pass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>generalize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-PnpSysprep<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>amd64<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DoNotCleanUpNonPresentDevices</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>DoNotCleanUpNonPresentDevices</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PersistAllDeviceInstalls</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PersistAllDeviceInstalls</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">pass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>specialize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Deployment<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>amd64<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronous</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>bushuqian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Path</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronousCommand</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>bushuzhong<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Path</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronousCommand</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>bushuhou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Path</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronousCommand</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronous</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Shell-Setup<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>amd64<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ComputerName</span><span class="token punctuation">></span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ComputerName</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CopyProfile</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CopyProfile</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">pass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>oobeSystem<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Shell-Setup<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>amd64<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideEULAPage</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideEULAPage</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideLocalAccountScreen</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideLocalAccountScreen</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideOnlineAccountScreens</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideOnlineAccountScreens</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideWirelessSetupInOOBE</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideWirelessSetupInOOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NetworkLocation</span><span class="token punctuation">></span></span>Work<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>NetworkLocation</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ProtectYourPC</span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ProtectYourPC</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SkipMachineOOBE</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SkipMachineOOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SkipUserOOBE</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SkipUserOOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideOEMRegistrationScreen</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideOEMRegistrationScreen</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OOBE</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RegisteredOrganization</span><span class="token punctuation">></span></span>Organization<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RegisteredOrganization</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RegisteredOwner</span><span class="token punctuation">></span></span>User<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RegisteredOwner</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FirstLogonCommands</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>denglushi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CommandLine</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CommandLine</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SynchronousCommand</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FirstLogonCommands</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LogonCommands</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AsynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>jinzhuomian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CommandLine</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CommandLine</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>AsynchronousCommand</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LogonCommands</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>unattend</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h6 id="Windows-8-1-10-32-位用-："><a href="#Windows-8-1-10-32-位用-：" class="headerlink" title="Windows 8.1-10 32 位用 ："></a>Windows 8.1-10 32 位用 ：</h6><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>unattend</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>urn:schemas-microsoft-com:unattend<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">pass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>generalize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-PnpSysprep<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>x86<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DoNotCleanUpNonPresentDevices</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>DoNotCleanUpNonPresentDevices</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PersistAllDeviceInstalls</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PersistAllDeviceInstalls</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">pass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>specialize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Deployment<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>x86<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronous</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>bushuqian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Path</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronousCommand</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>bushuzhong<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Path</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronousCommand</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>bushuhou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Path</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronousCommand</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronous</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Shell-Setup<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>x86<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ComputerName</span><span class="token punctuation">></span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ComputerName</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CopyProfile</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CopyProfile</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">pass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>oobeSystem<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Shell-Setup<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>x86<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideEULAPage</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideEULAPage</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideLocalAccountScreen</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideLocalAccountScreen</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideOnlineAccountScreens</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideOnlineAccountScreens</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideWirelessSetupInOOBE</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideWirelessSetupInOOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NetworkLocation</span><span class="token punctuation">></span></span>Work<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>NetworkLocation</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ProtectYourPC</span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ProtectYourPC</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SkipMachineOOBE</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SkipMachineOOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SkipUserOOBE</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SkipUserOOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideOEMRegistrationScreen</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideOEMRegistrationScreen</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OOBE</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RegisteredOrganization</span><span class="token punctuation">></span></span>Organization<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RegisteredOrganization</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RegisteredOwner</span><span class="token punctuation">></span></span>User<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RegisteredOwner</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FirstLogonCommands</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>denglushi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CommandLine</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CommandLine</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SynchronousCommand</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FirstLogonCommands</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LogonCommands</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AsynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>jinzhuomian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CommandLine</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CommandLine</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>AsynchronousCommand</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LogonCommands</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>unattend</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h6 id="Windows-7-64位-用-："><a href="#Windows-7-64位-用-：" class="headerlink" title="Windows 7 64位 用 ："></a>Windows 7 64位 用 ：</h6><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>unattend</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>urn:schemas-microsoft-com:unattend<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">pass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>generalize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-PnpSysprep<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>amd64<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DoNotCleanUpNonPresentDevices</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>DoNotCleanUpNonPresentDevices</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PersistAllDeviceInstalls</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PersistAllDeviceInstalls</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">pass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>specialize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Deployment<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>amd64<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronous</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>bushuqian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Path</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronousCommand</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>bushuzhong<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Path</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronousCommand</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>bushuhou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Path</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronousCommand</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronous</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Shell-Setup<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>amd64<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ComputerName</span><span class="token punctuation">></span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ComputerName</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CopyProfile</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CopyProfile</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">pass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>oobeSystem<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Shell-Setup<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>amd64<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideEULAPage</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideEULAPage</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideWirelessSetupInOOBE</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideWirelessSetupInOOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NetworkLocation</span><span class="token punctuation">></span></span>Work<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>NetworkLocation</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ProtectYourPC</span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ProtectYourPC</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SkipMachineOOBE</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SkipMachineOOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SkipUserOOBE</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SkipUserOOBE</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OOBE</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RegisteredOrganization</span><span class="token punctuation">></span></span>Organization<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RegisteredOrganization</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RegisteredOwner</span><span class="token punctuation">></span></span>User<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RegisteredOwner</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FirstLogonCommands</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>denglushi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CommandLine</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CommandLine</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SynchronousCommand</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FirstLogonCommands</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LogonCommands</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AsynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>jinzhuomian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CommandLine</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CommandLine</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>AsynchronousCommand</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LogonCommands</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>unattend</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h6 id="Windows-7-32位-用-："><a href="#Windows-7-32位-用-：" class="headerlink" title="Windows 7 32位 用 ："></a>Windows 7 32位 用 ：</h6><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>unattend</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>urn:schemas-microsoft-com:unattend<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">pass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>generalize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-PnpSysprep<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>x86<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DoNotCleanUpNonPresentDevices</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>DoNotCleanUpNonPresentDevices</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PersistAllDeviceInstalls</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PersistAllDeviceInstalls</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">pass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>specialize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Deployment<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>x86<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronous</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>bushuqian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Path</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronousCommand</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>bushuzhong<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Path</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronousCommand</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RunSynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>bushuhou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Path</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronousCommand</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RunSynchronous</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Shell-Setup<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>x86<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ComputerName</span><span class="token punctuation">></span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ComputerName</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CopyProfile</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CopyProfile</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">pass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>oobeSystem<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Shell-Setup<span class="token punctuation">"</span></span> <span class="token attr-name">processorArchitecture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>x86<span class="token punctuation">"</span></span> <span class="token attr-name">publicKeyToken</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>31bf3856ad364e35<span class="token punctuation">"</span></span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>neutral<span class="token punctuation">"</span></span> <span class="token attr-name">versionScope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nonSxS<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wcm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.microsoft.com/WMIConfig/2002/State<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideEULAPage</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideEULAPage</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HideWirelessSetupInOOBE</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HideWirelessSetupInOOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NetworkLocation</span><span class="token punctuation">></span></span>Work<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>NetworkLocation</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ProtectYourPC</span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ProtectYourPC</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SkipMachineOOBE</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SkipMachineOOBE</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SkipUserOOBE</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SkipUserOOBE</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OOBE</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RegisteredOrganization</span><span class="token punctuation">></span></span>Organization<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RegisteredOrganization</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RegisteredOwner</span><span class="token punctuation">></span></span>User<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RegisteredOwner</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FirstLogonCommands</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>denglushi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CommandLine</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CommandLine</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SynchronousCommand</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FirstLogonCommands</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LogonCommands</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AsynchronousCommand</span> <span class="token attr-name"><span class="token namespace">wcm:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Description</span><span class="token punctuation">></span></span>jinzhuomian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Description</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CommandLine</span><span class="token punctuation">></span></span>%SystemDrive%\Windows\Setup\Set\api.exe /5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CommandLine</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Order</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Order</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>AsynchronousCommand</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LogonCommands</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>unattend</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="系统总裁SC封装工具3-0"><a href="#系统总裁SC封装工具3-0" class="headerlink" title="系统总裁SC封装工具3.0"></a>系统总裁SC封装工具3.0</h5><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/9f1a926a9f4fdc578d09fd4c3dd14f9a.png" alt="目标系统选项卡"></p><ul><li>注册名称改为 <code>User</code>，注册单位改为 <code>Organization</code></li><li>计算机名 <code>自定义前缀随机</code> ，前缀（设定名称）为 <code>PC-</code></li><li>首次进入桌面的任务，请勿勾选和IE有关配置</li><li>系统总裁产品请勿勾选或打开</li></ul><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/3aae8843118c56e000e12504409bfd03.png" alt="计划任务选项卡"></p><ul><li>部署前等待运行：<code>%SystemDrive%\Windows\Setup\Set\api.exe /1</code></li><li>部署中等待运行：<code>%SystemDrive%\Windows\Setup\Set\api.exe /2</code></li><li>部署后等待运行：<code>%SystemDrive%\Windows\Setup\Set\api.exe /3</code></li><li>登录时等待运行：<code>%SystemDrive%\Windows\Setup\Set\api.exe /4</code></li><li>进桌面<strong>不等待</strong>运行：<code>%SystemDrive%\Windows\Setup\Set\api.exe /5</code></li></ul><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/b03690bed3d99101ddd61d63fe01e631.png" alt="部署过程选项卡"></p><ul><li>部署设置<strong>只勾选</strong> <code>跳过OOBE</code>，账号创建工作由 XRSYSAPI 接管，<strong>请勿自作聪明勾选其它项目</strong><ul><li><strong>只有XP</strong>系统需要勾选 <code>开启Administrator</code></li></ul></li></ul><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/761ae897d357402a759101fca4183818.png" alt="系统封装选项卡"></p><ul><li>进入高级设置，全部取消勾选</li></ul><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/ceae7df7a7587c696a052dd6ff592560.png"></p><ul><li>封装后关闭计算机，点击开始封装，封装后立即进入 PE 打包</li></ul><h5 id="IT天空-EasySysprep-5-x2F-5S"><a href="#IT天空-EasySysprep-5-x2F-5S" class="headerlink" title="IT天空 EasySysprep 5 &#x2F; 5S"></a>IT天空 EasySysprep 5 &#x2F; 5S</h5><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/b05aaefe37d9befa577eb8812995a8d9.png" alt="桌面环境-封装"></p><ul><li>注册用户改为 <code>User</code>，注册组织改为 <code>Organization</code></li><li>网络位置改为 <code>工作网络</code></li><li>勾上所有的勾</li><li>封装后立即进入PE完成第二阶段的封装</li></ul><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/cfe5a3316904c75845d4781f47d47e40.png" alt="PE环境下-OEM"></p><ul><li>仅勾选注册信息，注册用户改为 <code>User</code>，注册组织改为 <code>Organization</code></li></ul><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/b7b97f9c868b4608c43f222fa1143aea.png" alt="PE环境下-优化"></p><ul><li>充分利用ES5S，全选优化，亦可不选</li></ul><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/4cea0bfd8536651c5b201223e8bd29f4.png" alt="PE环境下-部署"></p><ul><li>仅开启 <code>部署控制</code> 和 <code>计算机名</code></li><li>计算机名称设置前缀为 <code>PC</code></li></ul><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/f049190e0dd9c186e346879a057dd648.png" alt="PE环境下-系统"></p><ul><li>取消勾选变更用户目录</li><li>勾选转移虚拟内存，使用系统托管方式</li><li>关闭UAC</li></ul><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/9963dc11271c3add740adeb83b996525.png" alt="PE环境下-用户"></p><ul><li>（重要）请勿勾选任何与用户有关的选项<ul><li>账号创建工作由 XRSYSAPI 接管，<strong>请勿自作聪明勾选其它项目</strong></li></ul></li></ul><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/9c0511316bca4bda84c2d7097ac3c5db.png" alt="PE环境下-网络"></p><ul><li>取消勾选任何选项</li></ul><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/43efac3e2c216d0bde09f636ad5ea85c.png" alt="PE环境下-任务"></p><ul><li>部署前运行：<code>%SystemDrive%\Windows\Setup\Set\api.exe /1</code></li><li>部署中运行：<code>%SystemDrive%\Windows\Setup\Set\api.exe /2</code></li><li>部署后运行：<code>%SystemDrive%\Windows\Setup\Set\api.exe /3</code></li><li>登录时运行：<code>%SystemDrive%\Windows\Setup\Set\api.exe /4</code></li><li>进桌面运行(<strong>不等待</strong>)：<code>%SystemDrive%\Windows\Setup\Set\api.exe /5</code></li></ul><h5 id="IT天空-EasySysprep-4-x2F-4-5"><a href="#IT天空-EasySysprep-4-x2F-4-5" class="headerlink" title="IT天空 EasySysprep 4 &#x2F; 4.5"></a>IT天空 EasySysprep 4 &#x2F; 4.5</h5><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/91f4e26f7b14095ca95c0b4ad08f8e7e.png" alt="第一阶段-封装选项"></p><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/f7f8ae904f5338bb04e70178962e0c4d.png" alt="第一阶段-用户账户"></p><ul><li>（重要）请勿勾选任何与用户有关的选项<ul><li>账号创建工作由 XRSYSAPI 接管，<strong>请勿自作聪明勾选其它项目</strong></li></ul></li></ul><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/ca330c1dba7d239c35697060b167e5ad.png" alt="第二阶段-OEM信息设置"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/c0381aafc95e79533664e57d15bbcdc7.png" alt="第二阶段-系统优化"></p><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/fd244613030269489a788b091d24eb55.png" alt="第二阶段-部署设置"></p><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/27fa8c639e8f5e9e3cc56b7dff0df748.png" alt="第二阶段-网络设置"></p><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/7d02cdb4abbae1bbd4adcb1ebb81dbdd.png" alt="第二阶段-专用调用接口"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/0bb1d593967f8a5a50cccd0378a61c77.png" alt="第二阶段-通用调用接口"></p><h4 id="潇然系统TAG文件xrsys-txt、zjsoft-txt、xrok-txt"><a href="#潇然系统TAG文件xrsys-txt、zjsoft-txt、xrok-txt" class="headerlink" title="潇然系统TAG文件xrsys*.txt、zjsoft*.txt、xrok*.txt"></a>潇然系统TAG文件<code>xrsys*.txt</code>、<code>zjsoft*.txt</code>、<code>xrok*.txt</code></h4><p>这些文件为潇然系统的TAG文件，潇然系统的程序会将这些文件从磁盘各分区根目录复制到 <code>C:\Windows\Setup\</code> 文件夹下，以便程序开关某项功能、读取相关参数，由于接口众多，这里不一一列出，请前往相关文字描述中查看详细使用方式</p><h4 id="接口一：在-C-Windows-Setup-Set-目录下预留-DIY-接口"><a href="#接口一：在-C-Windows-Setup-Set-目录下预留-DIY-接口" class="headerlink" title="接口一：在 C:\Windows\Setup\Set 目录下预留 DIY 接口"></a>接口一：在 <code>C:\Windows\Setup\Set</code> 目录下预留 DIY 接口</h4><p>此接口由 <code>C:\Windows\Setup\Set\api.exe</code> 提供</p><h5 id="脚本执行接口"><a href="#脚本执行接口" class="headerlink" title="脚本执行接口"></a>脚本执行接口</h5><p>仅供封装使用，其余用途不推荐此接口！！！</p><ul><li><code>C:\Windows\Setup\Set\api1_bsq.bat</code>：部署前最后调用</li><li><code>C:\Windows\Setup\Set\api2_bsz.bat</code>：部署中最后调用</li><li><code>C:\Windows\Setup\Set\api3_bsh.bat</code>：部署后最后调用</li><li><code>C:\Windows\Setup\Set\api4_dls.bat</code>：登录时最后调用</li><li><code>C:\Windows\Setup\Set\api5_jzm.bat</code>：进桌面OSC执行前调用</li></ul><p>此接口使用 <code>CALL</code> 方式调用脚本，请勿添加 <code>EXIT</code> 命令，否则会导致部署失败</p><h5 id="程序执行接口"><a href="#程序执行接口" class="headerlink" title="程序执行接口"></a>程序执行接口</h5><ul><li><code>C:\Windows\Setup\Set\InDeploy\*.exe</code>：部署中以 <code>/S</code> 参数执行 <code>*.exe</code></li><li><code>C:\Windows\Setup\Set\InDeploy\*.msi</code>：部署中以 <code>/passive /qb-! /norestart</code> 参数执行 <code>*.msi</code></li><li><code>C:\Windows\Setup\Set\InDeploy\*.reg</code>：部署中以 <code>regedit /s</code> 方式导入注册表</li><li><code>C:\Windows\Setup\Set\Run\*.exe</code>：进桌面OSC执行前以 <code>/S</code> 参数执行 <code>*.exe</code></li><li><code>C:\Windows\Setup\Set\Run\*.msi</code>：进桌面OSC执行前以 <code>/passive /qb-! /norestart</code> 参数执行 <code>*.msi</code></li><li><code>C:\Windows\Setup\Set\Run\*.reg</code>：进桌面OSC执行前以 <code>regedit /s</code> 方式导入注册表</li></ul><p>为了减少系统占用，每执行一个文件就会删除一个</p><p>建议使用 WinRAR SFX 创建静默安装程序包</p><h4 id="接口二：在磁盘各分区-Xiaoran-API-目录下预留-DIY-接口"><a href="#接口二：在磁盘各分区-Xiaoran-API-目录下预留-DIY-接口" class="headerlink" title="接口二：在磁盘各分区 Xiaoran\API 目录下预留 DIY 接口"></a>接口二：在磁盘各分区 <code>Xiaoran\API</code> 目录下预留 DIY 接口</h4><p>此接口由 <code>C:\Windows\Setup\Set\api.exe</code> 提供</p><p>为了提高部署成功率和安全性，此接口默认禁用，需要在 <code>C:\Windows\Setup</code> 或磁盘任意分区根目录下创建 <code>xrsyssearchapi.txt</code> ，打上需要搜索磁盘各分区 API 的 TAG</p><p>为了方便演示，这里以D盘为例，示例中的 <code>D:</code> 可以为任意盘符，包括 C D E F G H I J K L M N O P Q R S T U V W X Y Z</p><h5 id="脚本执行接口-1"><a href="#脚本执行接口-1" class="headerlink" title="脚本执行接口"></a>脚本执行接口</h5><ul><li><code>D:\Xiaoran\API\api1_bsq.bat</code>：部署前最后调用</li><li><code>D:\Xiaoran\API\api2_bsz.bat</code>：部署中最后调用</li><li><code>D:\Xiaoran\API\api3_bsh.bat</code>：部署后最后调用</li><li><code>D:\Xiaoran\API\api4_dls.bat</code>：登录时最后调用</li><li><code>D:\Xiaoran\API\api5_jzm.bat</code>：进桌面OSC执行前调用</li></ul><p>此接口使用 <code>START</code> 方式调用脚本，最好添加 <code>EXIT</code> 命令，否则可能会导致部署卡住</p><h5 id="程序执行接口-1"><a href="#程序执行接口-1" class="headerlink" title="程序执行接口"></a>程序执行接口</h5><ul><li><code>D:\Xiaoran\API\InDeploy\*.exe</code>：部署中以 <code>/S</code> 参数执行 <code>*.exe</code></li><li><code>D:\Xiaoran\API\InDeploy\*.msi</code>：部署中以 <code>/passive /qb-! /norestart</code> 参数执行 <code>*.msi</code></li><li><code>D:\Xiaoran\API\InDeploy\*.reg</code>：部署中以 <code>regedit /s</code> 方式导入注册表</li><li><code>D:\Xiaoran\API\Run\*.exe</code>：进桌面OSC执行前以 <code>/S</code> 参数执行 <code>*.exe</code></li><li><code>D:\Xiaoran\API\Run\*.msi</code>：进桌面OSC执行前以 <code>/passive /qb-! /norestart</code> 参数执行 <code>*.msi</code></li><li><code>D:\Xiaoran\API\Run\*.reg</code>：进桌面OSC执行前以 <code>regedit /s</code> 方式导入注册表</li></ul><p>为了减少系统占用，每执行一个文件就会删除一个</p><p>建议使用 WinRAR SFX 创建静默安装程序包</p><p> <code>C:\Windows\Setup\Set\osc.exe</code> 也有类似接口，区别为OSCOnline前运行和OSCOnline后运行，由于稳定性欠佳，<del>暂不公开</del>（已完成开发）！</p><h4 id="接口三：Xiaoran-System-OSC-提供的接口"><a href="#接口三：Xiaoran-System-OSC-提供的接口" class="headerlink" title="接口三：Xiaoran System OSC 提供的接口"></a>接口三：Xiaoran System OSC 提供的接口</h4><p>此接口由 <code>osc.exe</code> 提供，仅提供桌面环境下的接口</p><p>此接口均使用 <code>START</code> 方式调用脚本，最好添加 <code>EXIT</code> 命令，否则可能会导致部署卡住</p><h5 id="在-C-Windows-Setup-Set-Run-目录下预留-DIY-接口"><a href="#在-C-Windows-Setup-Set-Run-目录下预留-DIY-接口" class="headerlink" title="在 C:\Windows\Setup\Set\Run 目录下预留 DIY 接口"></a>在 <code>C:\Windows\Setup\Set\Run</code> 目录下预留 DIY 接口</h5><ul><li><code>C:\Windows\Setup\Set\Run\1\api1.bat</code>：进桌面OSC执行后OSCOnline执行前调用</li><li><code>C:\Windows\Setup\Set\Run\1\*.exe</code>：进桌面OSC执行后OSCOnline执行前以 <code>/S</code> 参数执行 <code>*.exe</code></li><li><code>C:\Windows\Setup\Set\Run\1\*.msi</code>：进桌面OSC执行后OSCOnline执行前以 <code>/passive /qb-! /norestart</code> 参数执行 <code>*.msi</code></li><li><code>C:\Windows\Setup\Set\Run\1\*.reg</code>：进桌面OSC执行后OSCOnline执行前以 <code>regedit /s</code> 方式导入注册表</li><li><code>C:\Windows\Setup\Set\Run\2\api2.bat</code>：进桌面OSC执行后OSCOnline执行后调用</li><li><code>C:\Windows\Setup\Set\Run\2\*.exe</code>：进桌面OSC执行后OSCOnline执行后以 <code>/S</code> 参数执行 <code>*.exe</code></li><li><code>C:\Windows\Setup\Set\Run\2\*.msi</code>：进桌面OSC执行后OSCOnline执行后以 <code>/passive /qb-! /norestart</code> 参数执行 <code>*.msi</code></li><li><code>C:\Windows\Setup\Set\Run\2\*.reg</code>：进桌面OSC执行后OSCOnline执行后以 <code>regedit /s</code> 方式导入注册表</li></ul><h5 id="在磁盘各分区-Xiaoran-osc-目录下预留-DIY-接口"><a href="#在磁盘各分区-Xiaoran-osc-目录下预留-DIY-接口" class="headerlink" title="在磁盘各分区 Xiaoran\osc 目录下预留 DIY 接口"></a>在磁盘各分区 <code>Xiaoran\osc</code> 目录下预留 DIY 接口</h5><p>为了提高部署成功率和安全性，此接口默认禁用，需要在 <code>C:\Windows\Setup</code> 或磁盘任意分区根目录下创建 <code>xrsyssearchapi.txt</code> ，打上需要搜索磁盘各分区 API 的 TAG</p><p>为了方便演示，这里以D盘为例，示例中的 <code>D:</code> 可以为任意盘符，包括 C D E F G H I J K L M N O P Q R S T U V W X Y Z</p><ul><li><code>D:\Xiaoran\OSC\1\api1.bat</code>：进桌面OSC执行后OSCOnline执行前调用</li><li><code>D:\Xiaoran\OSC\1\*.exe</code>：进桌面OSC执行后OSCOnline执行前以 <code>/S</code> 参数执行 <code>*.exe</code></li><li><code>D:\Xiaoran\OSC\1\*.msi</code>：进桌面OSC执行后OSCOnline执行前以 <code>/passive /qb-! /norestart</code> 参数执行 <code>*.msi</code></li><li><code>D:\Xiaoran\OSC\1\*.reg</code>：进桌面OSC执行后OSCOnline执行前以 <code>regedit /s</code> 方式导入注册表</li><li><code>D:\Xiaoran\OSC\2\api2.bat</code>：进桌面OSC执行后OSCOnline执行后调用</li><li><code>D:\Xiaoran\OSC\2\*.exe</code>：进桌面OSC执行后OSCOnline执行后以 <code>/S</code> 参数执行 <code>*.exe</code></li><li><code>D:\Xiaoran\OSC\2\*.msi</code>：进桌面OSC执行后OSCOnline执行后以 <code>/passive /qb-! /norestart</code> 参数执行 <code>*.msi</code></li><li><code>D:\Xiaoran\OSC\2\*.reg</code>：进桌面OSC执行后OSCOnline执行后以 <code>regedit /s</code> 方式导入注册表</li></ul><p>为了减少系统占用，每执行一个文件就会删除一个</p><p>建议使用 WinRAR SFX 创建静默安装程序包</p><h4 id="接口扩展功能演示"><a href="#接口扩展功能演示" class="headerlink" title="接口扩展功能演示"></a>接口扩展功能演示</h4><p>通过 DIY 接口，可以轻松实现 XRAPI 和 XROSC 无法实现的功能，之后如有我们不想集成的功能，将放到此板块</p><p>注意：以下内容收集自网络，仅供参考，请勿用于非法活动，后果自负！</p><p>以下示例中的 <code>D:</code> 可以为任意盘符，包括 C D E F G H I J K L M N O P Q R S T U V W X Y Z</p><h5 id="例1：自动创建指定用户并设置密码，开启或关闭RDP微软远程桌面"><a href="#例1：自动创建指定用户并设置密码，开启或关闭RDP微软远程桌面" class="headerlink" title="例1：自动创建指定用户并设置密码，开启或关闭RDP微软远程桌面"></a>例1：自动创建指定用户并设置密码，开启或关闭RDP微软远程桌面</h5><p><code>D:\xrsyssearchapi.txt</code></p><p><code>D:\Xiaoran\API\api1_bsq.bat</code>：</p><ul><li>开启内置管理员用户Administrator：</li></ul><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span><span class="token comment">rem 打上开启内置管理员用户Administrator的TAG</span><span class="token command"><span class="token keyword">echo</span> <span class="token number">1</span>><span class="token variable">%SystemDrive%</span>\Windows\Setup\xrsysadmin.txt</span><span class="token command"><span class="token keyword">exit</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>或新建指定用户：</li></ul><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span><span class="token comment">rem 打上新建名为Xiaoran的用户的TAG，注意仅英文且不含空格</span><span class="token command"><span class="token keyword">echo</span> Xiaoran><span class="token variable">%SystemDrive%</span>\Windows\Setup\xrsysnewuser.txt</span><span class="token command"><span class="token keyword">exit</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>D:\Xiaoran\API\api5_jzm.bat</code>：</p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span><span class="token comment">rem 给当前用户设置密码为Password@123，注意此密码不安全请及时修改</span><span class="token command"><span class="token keyword">net</span> user <span class="token variable">%USERNAME%</span> Password@<span class="token number">123</span></span><span class="token comment">rem 打开RDP</span><span class="token comment">rem 增加防火墙规则</span><span class="token command"><span class="token keyword">netsh</span> advfirewall firewall add rule name=<span class="token string">"Remote Desktop"</span> protocol=TCP dir=in localport=<span class="token number">3389</span> action=allow</span><span class="token comment">rem 设置RDP端口（可选，默认开启3389）</span><span class="token command"><span class="token keyword">reg</span> add <span class="token string">"HKLM\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp"</span> <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/v</span> portnumber <span class="token parameter attr-name">/d</span> <span class="token number">3389</span> <span class="token parameter attr-name">/f</span></span><span class="token comment">rem WMIC方式开启RDP</span><span class="token command"><span class="token keyword">wmic</span> RDTOGGLE WHERE ServerName='<span class="token variable">%COMPUTERNAME%</span>' call SetAllowTSConnections <span class="token number">1</span></span> <span class="token comment">rem REG方式开启RDP</span><span class="token command"><span class="token keyword">reg</span> add <span class="token string">"HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server"</span> <span class="token parameter attr-name">/v</span> fDenyTSConnections <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/d</span> <span class="token number">0</span> <span class="token parameter attr-name">/f</span></span><span class="token comment">rem 检查端口状态</span><span class="token command"><span class="token keyword">netstat</span> -an|find <span class="token string">"3389"</span></span><span class="token operator">&amp;</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">echo</span>;RDPisOn||echo;RDPisOff</span><span class="token command"><span class="token keyword">exit</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>反之亦然，如果要关闭RDP：</p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span><span class="token comment">rem 关闭RDP</span><span class="token comment">rem WMIC方式关闭RDP</span><span class="token command"><span class="token keyword">wmic</span> RDTOGGLE WHERE ServerName='<span class="token variable">%COMPUTERNAME%</span>' call SetAllowTSConnections <span class="token number">0</span></span><span class="token comment">rem REG方式关闭RDP</span><span class="token command"><span class="token keyword">reg</span> add <span class="token string">"HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server"</span> <span class="token parameter attr-name">/v</span> fDenyTSConnections <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/d</span> <span class="token number">1</span> <span class="token parameter attr-name">/f</span></span><span class="token command"><span class="token keyword">exit</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="例2：自动下载安装2345推广集合包"><a href="#例2：自动下载安装2345推广集合包" class="headerlink" title="例2：自动下载安装2345推广集合包"></a>例2：自动下载安装2345推广集合包</h5><p>使用OSC提供的接口，在OSCOnline完毕之后再下载安装</p><p><code>D:\xrsyssearchapi.txt</code></p><p><code>D:\Xiaoran\OSC\1\api1.bat</code>：</p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span><span class="token comment">rem 设置aria2c路径和参数，这里白嫖XROSC的</span><span class="token command"><span class="token keyword">set</span> <span class="token variable">aria</span><span class="token operator">=</span><span class="token string">"%systemdrive%\Windows\Set\OSC\aria2c.exe"</span> <span class="token parameter attr-name">--check-certificate</span><span class="token operator">=</span>false <span class="token parameter attr-name">--save-not-found</span><span class="token operator">=</span>false <span class="token parameter attr-name">--always-resume</span><span class="token operator">=</span>false <span class="token parameter attr-name">--auto-save-interval</span><span class="token operator">=</span><span class="token number">10</span> <span class="token parameter attr-name">--auto-file-renaming</span><span class="token operator">=</span>false <span class="token parameter attr-name">--allow-overwrite</span><span class="token operator">=</span>true <span class="token parameter attr-name">-c</span></span><span class="token comment">rem 打上OSCOnline安装纯净版的TAG</span><span class="token command"><span class="token keyword">echo</span> <span class="token number">1</span>><span class="token variable">%SystemDrive%</span>\Windows\Setup\zjsoftxrsysonline.txt</span><span class="token comment">rem 进入缓存目录</span><span class="token command"><span class="token keyword">cd</span> <span class="token parameter attr-name">/d</span> <span class="token variable">%TEMP%</span></span><span class="token comment">rem 下载2345推广集合包，将链接替换成自己的</span>%aria% -x16 "http://url.xrgzs.top/2345pack"<span class="token comment">rem 自动安装推广包</span><span class="token command"><span class="token keyword">for</span> <span class="token variable">%%a</span> <span class="token keyword">in</span> <span class="token punctuation">(</span>p*.exe<span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token command"><span class="token keyword">start</span> <span class="token parameter attr-name">/wait</span> <span class="token variable">%%a</span> <span class="token parameter attr-name">/S</span> </span><span class="token operator">&amp;</span><span class="token operator">&amp;</span> <span class="token command"><span class="token keyword">del</span> <span class="token parameter attr-name">/f</span> <span class="token parameter attr-name">/q</span> <span class="token variable">%%a</span></span><span class="token command"><span class="token keyword">exit</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="关于问题反馈和联系方式的说明"><a href="#关于问题反馈和联系方式的说明" class="headerlink" title="关于问题反馈和联系方式的说明"></a>关于问题反馈和联系方式的说明</h3><p>如果使用过程中有问题，欢迎积极到B站、酷安私信反馈，或直接加我QQ！</p><ul><li>B站：<a href="https://space.bilibili.com/73271091">潇然工作室</a></li><li>酷安：<a href="https://www.coolapk.com/u/1324579">狂犬主子</a></li><li>QQ（推荐）：2744460679</li></ul><h2 id="小工具分享"><a href="#小工具分享" class="headerlink" title="小工具分享"></a>小工具分享</h2><p><a href="https://url.xrgzs.top/xrtools">本地下载</a>    <a href="https://lanzoux.com/b08x7teda">蓝奏云</a></p><p><a href="https://xrgzs.github.io/xrtools">潇然常用工具合集</a></p><hr><h2 id="免责声明"><a href="#免责声明" class="headerlink" title="免责声明"></a>免责声明</h2><p>本 Windows 系统及软件版权属各自产权人所有，只用于个人封装技术研究交流使用，不得用于商业用途，且本系统制作者不承担任何技术及版权问题，请在试用后 24 小时内删除。如果您对本系统有任何意见和建议，欢迎反馈，请购买正版 Windows 操作系统软件！</p>]]></content>
      
      
      <categories>
          
          <category> 潇然工作室 </category>
          
          <category> Windows </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 潇然工作室 </tag>
            
            <tag> Xiaoran Studio </tag>
            
            <tag> 潇然系统 </tag>
            
            <tag> Xiaoran System </tag>
            
            <tag> Windows </tag>
            
            <tag> 操作系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>潇然一键装机助理 Xiaoran Onekey</title>
      <link href="/xrok.html"/>
      <url>/xrok.html</url>
      
        <content type="html"><![CDATA[<h1 id="潇然一键装机助理-Xiaoran-Onekey"><a href="#潇然一键装机助理-Xiaoran-Onekey" class="headerlink" title="潇然一键装机助理 Xiaoran Onekey"></a>潇然一键装机助理 Xiaoran Onekey</h1><p>潇然一键装机助理是一个<strong>方便安装系统及系统维护的工具</strong>，同时提供<strong>丰富的扩展功能</strong>。</p><p>全面兼容 UEFI &#x2F; BIOS、MBR &#x2F; GPT 环境，支持桌面环境、PE 环境下<strong>在线一键重装系统</strong>、安装 PE 环境、一键分区、修复引导等功能。</p><p>不用外接 U 盘及光驱，<strong>步骤简单，让人人都成电脑系统装机大师</strong>，快点击<a href="https://url.xrgzs.top/xrok">“立即下载”</a>安装体验吧！</p><p><a href="https://url.xrgzs.top/xrok"><img src="https://p0.meituan.net/dpplatform/926490bf661dd8181fd8de812ae6e7e21366667.png"></a></p><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><h3 id="请务必仔细阅读以下提示后再使用本工具："><a href="#请务必仔细阅读以下提示后再使用本工具：" class="headerlink" title="请务必仔细阅读以下提示后再使用本工具："></a><font color="red"><strong>请务必仔细阅读以下提示后再使用本工具：</strong></font></h3><ul><li>此工具将长期处于开发测试阶段，每星期至少更新一次，<strong>请务必使用最新版本</strong></li><li>除非本人不用电脑，否则此工具将不会停止更新</li><li>此工具是<a href="https://xrgzs.github.io/xrsys.html">《潇然系统 Xiaoran System》</a>的一个重要组成部分</li><li>启动器会自动检测并升级程序版本，<strong>启动时会闪退后重新运行，为正常现象</strong></li><li>潇然一键装机助理中的“软件大全”功能已独立为 <a href="http://url.xrgzs.top/xrsoft">潇然软件商店</a>，此前版本的均不可用，请务必升级到最新版本</li><li>如遇升级导致多开的，请全部退掉后，重新运行</li><li>潇然一键装机助理会将您的 Wi-Fi 密码自动备份成 .xml 文件到 C 盘外的其它盘符下的 <code>Xiaoran\WLANPassword</code> 目录内，以便部署过程自动连接 Wi-Fi ，特此向用户声明</li><li>此奶测试玩具，由此文件包引起的硬盘崩坏、艳照丢失，一概不赔</li></ul><h4 id="在线重装注意事项："><a href="#在线重装注意事项：" class="headerlink" title="在线重装注意事项："></a><font color="darkred">在线重装注意事项：</font></h4><ol><li>请确保各盘符下 <code>OSDownload</code> 文件夹里面不要有任何文件，启动器有相关机制会清理所有 <code>OSDownload</code> 文件夹</li><li>请勿多开潇然一键装机助理，包括潇然软件商店，否则会造成 <code>OSDownload</code> 下的文件被误删，导致镜像损坏</li><li>为了避免文件被误删，请尽量到 PE 环境下安装，推荐使用<a href="https://xrgzs.github.io/xrpe.html">《潇然PE启动 Xiaoran PE》</a></li><li>部分局域网的安全网关设备可能会对部分文件（如：<code>api.exe</code>，会修改系统相关组件）进行拦截，导致潇然系统在线下载后部署失败，这种情况请尝试更换网络</li><li>部分运营商存在劫持现象，导致无法连接到我们的服务器，建议关闭 IPv6 并使用公共 DNS，如 <code>114.114.114.114</code>（114DNS，部分运营商存在劫持问题）、<code>223.5.5.5</code>（阿里DNS）和 <code>119.29.29.29</code>（DNSPod），参考：<a href="https://yukaidi.top/2023/256.html">《一键装机下载报错自助解决方案》</a></li><li>安装时建议勾选安装一键急救系统（桌面环境下默认半勾选），以便安装出错时重新进 PE 恢复镜像</li><li>（此功能正在维护调整中，目前暂不安装安全软件，需自行到潇然软件商店安装）<del>潇然一键装机助理在线重装（潇然系统）会默认安装 360安全卫士极速版 套装，如果不喜欢，请在非系统盘（如D盘）下创建一个名为 <code>zjsoftHR.txt</code> 的文件，打上需要安装 火绒安全软件 的 TAG</del></li></ol><h4 id="警告：使用前请务必退出所有杀毒软件！！！"><a href="#警告：使用前请务必退出所有杀毒软件！！！" class="headerlink" title="警告：使用前请务必退出所有杀毒软件！！！"></a><font color="darkred">警告：使用前请务必退出所有杀毒软件！！！</font></h4><p>如果觉得不放心可以不用退出，但会提高安装失败率！</p><p><em>火绒安全软件、腾讯电脑管家、金山毒霸实测可以不用退出；</em></p><p><font color="red"><strong>Windows Defender、360 必须退出，否则会破坏程序组件！</strong></font></p><p><strong>最好在 PE 环境下使用本工具，推荐使用<a href="https://xrgzs.github.io/xrpe.html">《潇然PE启动 Xiaoran PE》</a>！</strong></p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/34a7dcdc69a18eae0d9f109f2bafbc57.png"></p><h2 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h2><p><a href="https://url.xrgzs.top/xrok"><strong>最新完整版安装包</strong></a></p><p><a href="https://alist.xrgzs.top/xr/Xiaoran%20Studio/Onekey/XiaoranOL.exe">在线安装包</a>    <a href="https://alist.xrgzs.top/xr/Xiaoran%20Studio/Onekey/latest.exe">离线安装包</a>    <a href="http://xrgzs.6655.la/d/odb/Xiaoran%20Studio/Onekey/latest.exe">备用下载</a></p><p><a href="https://alist.xrgzs.top/xr/Xiaoran%20Studio/Onekey/AngelRC.zip">AngelRC潇然定制版</a>    <a href="https://alist.xrgzs.top/xr/Xiaoran%20Studio/Onekey/EasyRC.zip">EasyRC潇然定制版</a></p><p><a href="http://url.xrgzs.top/xrsoft">潇然软件商店下载</a></p><p><em>小提示：如果速度过慢，可以尝试重新点击链接下载，这样可以分配到更快的下载服务器！</em></p><hr><p><a href="http://url.xrgzs.top/pe64">64位PE模块下载</a>    <a href="http://url.xrgzs.top/pe64">32位PE模块下载</a>    <a href="https://alist.xrgzs.top/xr/Xiaoran%20Studio/Onekey/PE/XRPE.iso">Xiaoran PE ISO下载</a></p><p><a href="https://alist.xrgzs.top/xr/Xiaoran%20Studio/Onekey/PE/HotPE/XROK.HPM">HotPE集成模块下载</a>    <a href="https://alist.xrgzs.top/xr/Xiaoran%20Studio/Onekey/PE/USM/XROK.wim">USM集成模块下载</a>    <a href="https://alist.xrgzs.top/xr/Xiaoran%20Studio/Onekey/PE/EasyU/PETOOLS_OK.7z">优启通集成模块下载</a></p><hr><p><a href="https://alist.xrgzs.top/odb/Xiaoran%20Studio/Onekey/Other">备用纯净装机工具下载（与我们无关，仅供技术员备用）</a></p><hr><p><strong>【新】一行代码安装脚本——dll 简洁高速版（几乎支持所有系统）：</strong></p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">regsvr32</span> <span class="token parameter attr-name">/u</span> <span class="token parameter attr-name">/s</span> <span class="token parameter attr-name">/i<span class="token punctuation">:</span></span>http://url.xrgzs.top/c<span class="token parameter attr-name">/xrok</span> scrobj.dll</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="第一种-最方便-：桌面环境下使用潇然一键装机助理在线重装系统"><a href="#第一种-最方便-：桌面环境下使用潇然一键装机助理在线重装系统" class="headerlink" title="第一种(最方便)：桌面环境下使用潇然一键装机助理在线重装系统"></a>第一种(最方便)：桌面环境下使用潇然一键装机助理在线重装系统</h3><p><strong>要求：</strong></p><ol><li>原来的操作系统能正常使用，退出了所有杀毒软件</li><li>在线重装系统功能，需要连接到互联网</li><li>重装本地系统，需要连接到互联网或下载好PE模块</li></ol><p><video src="https://alist.xrgzs.top/d/odb/Xiaoran%20Studio/Onekey/%E6%BD%87%E7%84%B6%E4%B8%80%E9%94%AE%E8%A3%85%E6%9C%BA%E5%8A%A9%E7%90%86%E6%95%99%E7%A8%8B.mp4" controls width="100%" poster="https://m.360buyimg.com/babel/jfs/t20250317/79815/16/22660/57771/64149ac4F8a0a0082/5c701a12dce440be.jpg"></video></p><h3 id="第二种-推荐-：PE环境下使用潇然一键装机助理安装系统"><a href="#第二种-推荐-：PE环境下使用潇然一键装机助理安装系统" class="headerlink" title="第二种(推荐)：PE环境下使用潇然一键装机助理安装系统"></a>第二种(推荐)：PE环境下使用潇然一键装机助理安装系统</h3><p><strong>要求：</strong></p><ol><li>2 GB 以上 U 盘用于制作 WinPE 启动盘</li><li>启动盘 WinPE 系统支持联网，且组件较为完整</li><li>在线重装系统，需要连接到互联网；重装本地系统，无需连接互联网</li></ol><p>可以使用<a href="https://xrgzs.github.io/xrpe.html">《潇然PE启动 Xiaoran PE》</a>制作 PE 启动盘，或参考进阶玩法，将潇然一键装机助理集成到其它更加强大的 PE 项目中。</p><h2 id="进阶玩法"><a href="#进阶玩法" class="headerlink" title="进阶玩法"></a>进阶玩法</h2><h3 id="1、-新手必看-潇然一键装机助理在线重装系统列表详解"><a href="#1、-新手必看-潇然一键装机助理在线重装系统列表详解" class="headerlink" title="1、(新手必看)潇然一键装机助理在线重装系统列表详解"></a>1、(新手必看)潇然一键装机助理在线重装系统列表详解</h3><p>更多请看：<a href="https://xrgzs.github.io/xrsys.html">潇然系统</a></p><p><video src="https://alist.xrgzs.top/d/odb/Xiaoran%20Studio/Onekey/%E6%BD%87%E7%84%B6%E4%B8%80%E9%94%AE%E8%A3%85%E6%9C%BA%E5%8A%A9%E7%90%86%E6%95%99%E7%A8%8B2-%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%E7%B3%BB%E7%BB%9F.mp4" controls width="100%" poster="https://m.360buyimg.com/babel/jfs/t20250317/79815/16/22660/57771/64149ac4F8a0a0082/5c701a12dce440be.jpg"></video></p><h3 id="2、使用潇然一键装机助理自行构建最新版潇然系统镜像"><a href="#2、使用潇然一键装机助理自行构建最新版潇然系统镜像" class="headerlink" title="2、使用潇然一键装机助理自行构建最新版潇然系统镜像"></a>2、使用潇然一键装机助理自行构建最新版潇然系统镜像</h3><p>参考：<a href="https://xrgzs.github.io/posts/xrsys-build-image.html">《潇然系统镜像构建教程》</a></p><h3 id="3、在其它-WinPE-系统下使用潇然一键装机助理"><a href="#3、在其它-WinPE-系统下使用潇然一键装机助理" class="headerlink" title="3、在其它 WinPE 系统下使用潇然一键装机助理"></a>3、在其它 WinPE 系统下使用潇然一键装机助理</h3><p>潇然一键装机助理默认使用<strong>潇然PE</strong>，这是一个专为潇然一键装机助理定制的PE，仅集成与装机相关的功能。</p><p>更多请看：<a href="https://xrgzs.github.io/xrpe.html">《潇然PE启动 Xiaoran PE》</a></p><p>如果您需要使用其它更强大的PE，我们也为您提供以下的方法：</p><blockquote><p>备注：这里仅列出已经通过测试且可集成潇然一键装机助理的WinPE系统，实际上可以在PE内<strong>直接运行安装程序</strong>，无需看下面的内容修改更多选项！</p></blockquote><h4 id="系统总裁U盘魔术师USM"><a href="#系统总裁U盘魔术师USM" class="headerlink" title="系统总裁U盘魔术师USM"></a>系统总裁U盘魔术师USM</h4><p><strong>强烈推荐搭配系统总裁U盘魔术师USM V5、V6全能版使用</strong> ，这样内核超级完整，可以联网，还可以白嫖CeoMSX。搭配我们制作的扩展包，还顺便增加了对HotPE模块的支持。</p><details><summary>展开查看</summary><blockquote><p><a href="https://www.sysceo.com/Software-softwarei-id-121.html">U盘魔术师v5(USMv5)</a></p><p><a href="https://www.sysceo.com/Software-softwarei-id-129.html">U盘魔术师v6特别版(USMv6)</a></p></blockquote><p>下载<a href="https://alist.xrgzs.top/d/odb/Xiaoran%20Studio/Onekey/PE/USM/XROK.wim">XROK.wim</a> (实时更新)</p><p>不用解压，将 <code>XROK.wim </code>直接放入系统总裁U盘魔术师USM主程序根目录的 <code>Data\USMEFI\USM_TOOL</code> 文件夹下，如：</p><p><code>E:\USM_v6.0.2022.1125S\Data\USMEFI\USM_TOOL\XROK.wim</code></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/b6ab514c1468e24a080c06e8541b8372.png"></p><p>运行USM主程序 <code>Usm_x64.exe</code> 制作启动盘或 ISO 镜像即可，推荐使用 ISO + Ventoy 的方式制作U盘。</p><p>如果你已经制作好ISO镜像，那么将位于ISO文件的以下路径：<code>/USM_TOOL/XROK.wim</code>，后续可以使用 UltraISO 等工具把最新版 <code>XROK.wim</code> 替换进去。</p><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/b402002ee38fdd2d789bd6c1c47ba55f.png"></p><p>使用时第一次启动如果联网会自动联网下载补全到最新版本，如果未联网也不影响使用。</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/a7fd10d62380939016880c1c819b07fc.png" alt="预览"></p><p><strong>默认会调用 CeoMSX 安装 SRS 驱动，方便Win7装机。</strong></p></details><h4 id="IT天空优启通EasyU"><a href="#IT天空优启通EasyU" class="headerlink" title="IT天空优启通EasyU"></a>IT天空优启通EasyU</h4><details><summary>展开查看</summary><p>下载<a href="https://alist.xrgzs.top/xr/Xiaoran%20Studio/Onekey/PE/EasyU/PETOOLS_OK.7z">PETOOLS_OK.7z</a></p><p>不用解压，直接放入IT天空优启通EasyU主程序根目录的 <code>TOOLS</code> 文件夹下，如：</p><p><code>E:\EasyU_3.7.2023.0110\TOOLS\PETOOLS_OK.7z</code></p><p>运行优启通主程序 <code>EasyU_v3.7.exe</code> 制作启动盘或ISO镜像即可。</p><p>使用时第一次启动如果联网会自动联网下载补全到最新版本，如果未联网也不影响使用。</p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/ac623b6fbaca09b2492af2ea0a1adef9.png"></p></details><h4 id="HotPE"><a href="#HotPE" class="headerlink" title="HotPE"></a>HotPE</h4><details><summary>展开查看</summary><p>下载<a href="https://alist.xrgzs.top/xr/Xiaoran%20Studio/Onekey/PE/HotPE/XROK.HPM">HotPE集成模块下载</a></p><p>对于 Hot 等支持 HPM 模块的 PE，只需复制 HPM 文件到 <code>HotPEModule</code> 文件夹下，或直接在 PE 下双击 HPM 文件即可。</p><p><strong>潇然一键装机助理已被HotPE模块管理收录！！！</strong></p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/15e3b4a4d07c40c68cd36232c9a98143.png"></p></details><h4 id="FirPE"><a href="#FirPE" class="headerlink" title="FirPE"></a>FirPE</h4><details><summary>展开查看</summary><p>对于 FirPE，我们有 EasyRC 潇然定制版，因此直接替换即可。</p><p>下载<a href="https://alist.xrgzs.top/xr/Xiaoran%20Studio/Onekey/EasyRC.zip">EasyRC潇然定制版</a></p><p>解压替换 <code>FirPE-V1.8.2.iso</code> 内 <code>/PETOOLS/备份还原/EasyRC</code> 下的所有文件即可。</p></details><h4 id="其它PE"><a href="#其它PE" class="headerlink" title="其它PE"></a>其它PE</h4><p><strong>一般直接运行潇然一键装机助理完整版的安装程序即可</strong> ，或参考下面的内容将潇然一键装机助理集成到 PE 镜像，会涉及到一些有关修改 PECMD 的知识。</p><details><summary>展开查看</summary><p>挂载 <code>你的PE文件名.wim </code> 文件到 <code>挂载路径</code>。</p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">DISM</span>.exe /Mount-Image <span class="token parameter attr-name">/ImageFile<span class="token punctuation">:</span></span><span class="token string">"你的PE文件名.wim"</span> <span class="token parameter attr-name">/Index<span class="token punctuation">:</span></span><span class="token number">1</span> <span class="token parameter attr-name">/MountDir<span class="token punctuation">:</span></span><span class="token string">"挂载路径"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将潇然 PE 中的 <code>aria2c.exe</code>、<code>QiiVerison.txt</code>、<code>UjyQii.exe</code>、<code>UjyQii.ini</code>、<code>Xiaoran.bat</code>、<code>Xiaoran.ico</code> 几个文件和 <code>bin</code> 文件夹放入<code>挂载路径\Windows\</code>。</p><p>修改 <code>挂载路径\Windows\System32\PECMD.ini</code> 或 <code>挂载路径\Program Files\PETools.ini</code>，加入以下内容：</p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">LINK</span> !<span class="token variable">%Desktop%</span>\潇然一键装机助理,<span class="token variable">%WinDir%</span>\Xiaoran.bat,,<span class="token variable">%WinDir%</span>\Xiaoran.ico</span><span class="token command"><span class="token keyword">LINK</span> <span class="token variable">%Programs%</span>\潇然出品\潇然一键装机助理,<span class="token variable">%WinDir%</span>\UjyQii.exe,,<span class="token variable">%WinDir%</span>\Xiaoran.ico</span><span class="token command"><span class="token keyword">Exec</span> <span class="token variable">%WinDir%</span>\UjyQii.exe <span class="token parameter attr-name">/AutoInstall</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>卸载 PE，保存修改。</p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">DISM</span>.exe /Unmount-Wim <span class="token parameter attr-name">/MountDir<span class="token punctuation">:</span></span><span class="token string">"挂载路径"</span> <span class="token parameter attr-name">/commit</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>重新导出 WIM 镜像，优化 PE 大小。</p><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">DISM</span>.exe /Export-Image <span class="token parameter attr-name">/SourceImageFile<span class="token punctuation">:</span></span><span class="token string">"你的PE文件名.wim"</span> <span class="token parameter attr-name">/SourceIndex<span class="token punctuation">:</span></span><span class="token number">1</span> <span class="token parameter attr-name">/DestinationImageFile<span class="token punctuation">:</span></span><span class="token string">"你的PE文件名_已优化.wim"</span> <span class="token parameter attr-name">/Compress<span class="token punctuation">:</span></span>max <span class="token parameter attr-name">/Bootable</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>使用时第一次启动桌面图标，如果联网会自动联网检测更新，如果未联网也不影响使用；开始菜单图标不会检测更新。</p></details><h3 id="4、技术支持-x2F-远程维护使用小技巧"><a href="#4、技术支持-x2F-远程维护使用小技巧" class="headerlink" title="4、技术支持&#x2F;远程维护使用小技巧"></a>4、技术支持&#x2F;远程维护使用小技巧</h3><h4 id="客户电脑可正常使用："><a href="#客户电脑可正常使用：" class="headerlink" title="客户电脑可正常使用："></a>客户电脑可正常使用：</h4><ol><li>只想重装个系统：软件丢过去，选 <code>一键重装</code>，选个系统，自动完成操作</li><li>想要磁盘分区或者更换硬盘装系统：软件丢过去，点击右上角 &#x3D;&gt; <code>立即重启进入 WinPE</code>（PE下含网络和远程），引导客户打开远程，操作分区后，使用<code>潇然一键装机助理</code> &#x3D;&gt;  <code>一键重装</code></li></ol><h4 id="客户电脑不可使用："><a href="#客户电脑不可使用：" class="headerlink" title="客户电脑不可使用："></a>客户电脑不可使用：</h4><ol><li>其他能用的电脑：使用工具制作U盘，制作好直接去需要的电脑上启动操作<ul><li>客户U盘大多质量很差，可以就制作个U盘，不需要下载文件复制到U盘，写入太慢费时间，进PE里，大多机器都有网络，可直接进行在线操作</li></ul></li><li>其他能用的电脑：连接到同一局域网（交换机不得开启AP隔离等功能），运行并启用 <code>XRPE.ISO</code> 内的 <code>TinyPXE网启服务器.exe</code>，去需要的电脑上从网卡启动操作（支持批量），进入 XRiPXE<ul><li>笔记本电脑无有线网卡，只要主板 BIOS 支持，亦可使用 USB 网卡</li><li>部分主板默认未启用 PXE 启动功能，需要进 BIOS 开启</li><li>不支持 Wi-Fi PXE 启动</li><li>可用 iVentoy 替代 XRiPXE，方法更加简单，只需将我们的 <code>XRPE.ISO</code> 或 <code>pe64.wim</code> 放入对应的文件夹，启动 iVentoy 主程序</li></ul></li></ol><h3 id="5、在线重装定制"><a href="#5、在线重装定制" class="headerlink" title="5、在线重装定制"></a>5、在线重装定制</h3><p>如有批量部署、在线重装定制的需求，可以联系我们，<strong>往在线重装配置文件里增加您的项目</strong>，只需您提供下面的信息：</p><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">（必须）负责人的名字，联系方式：QQ及手机号，或公司名称-相关负责人<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">（必须）系统名称</span><span class="token punctuation">]</span></span><span class="token key attr-name">describe</span><span class="token punctuation">=</span><span class="token value attr-value">系统描述</span><span class="token key attr-name">Time</span><span class="token punctuation">=</span><span class="token value attr-value">更新时间</span><span class="token key attr-name">Bit</span><span class="token punctuation">=</span><span class="token value attr-value">系统大小</span><span class="token key attr-name">OSUrl</span><span class="token punctuation">=</span><span class="token value attr-value">（必须）系统下载地址,支持GHO/WIM/ESD/ISO格式；支持网盘转链、直链</span><span class="token key attr-name">OSFile</span><span class="token punctuation">=</span><span class="token value attr-value">（必须）下载后保存到本地的文件名,桌面客户端将以此文件名后缀来判断系统镜像文件格式</span><span class="token key attr-name">OSNewFile</span><span class="token punctuation">=</span><span class="token value attr-value">镜像为ISO格式时,需定义安装文件在ISO镜像里的所在路径,不可带盘符</span><span class="token key attr-name">Index</span><span class="token punctuation">=</span><span class="token value attr-value">（必须）WIM/ESD的安装索引,如安装镜像是WIM/ESD，需务必填写,否则程序将默认以卷1安装</span><span class="token key attr-name">exeSetup1Url</span><span class="token punctuation">=</span><span class="token value attr-value">（非必须）支持配置来自第三方软件安装包/万能驱动等任何文件下载地址；支持网盘转链、直链</span><span class="token key attr-name">ExeSetup1Path</span><span class="token punctuation">=</span><span class="token value attr-value">（非必须）文件复制到系统安装盘所在的文件夹,不可带盘符</span><span class="token key attr-name">ExeSetup1File</span><span class="token punctuation">=</span><span class="token value attr-value">（非必须）文件保存文件名</span><span class="token key attr-name">ExeSetup1MD5</span><span class="token punctuation">=</span><span class="token value attr-value">（非必须）文件的MD5校验值</span>（非必须）...同上,第二个捆绑包的下载地址,程序支持下载来自20个不同url的文件<span class="token key attr-name">UEFI</span><span class="token punctuation">=</span><span class="token value attr-value">（必须）定义此系统所支持的UEFI引导类型,如XP/7X86不支持UEFI引导,填0即可,如Win7/8/8.1/10的64位版本,填写1即可,如Win8/8.1/10的32位版本，填写2即可</span><span class="token key attr-name">Icon</span><span class="token punctuation">=</span><span class="token value attr-value">（非必须）定义此系统显示图标,值分别为  11  10  7 XP,具体请查看定义后的在线重装-选择系统界面;也可定义在线图标,本值留空后将读取IconUrl的值</span><span class="token key attr-name">md5</span><span class="token punctuation">=</span><span class="token value attr-value">（最好）md5的校验值,留空不校验,</span><span class="token key attr-name">ICONUrl</span><span class="token punctuation">=</span><span class="token value attr-value">（非必须）定义在线图标,需Icon=留空本值才生效</span><span class="token key attr-name">NoDownload</span><span class="token punctuation">=</span><span class="token value attr-value">1 定义是否允许[下载到本地] 功能</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol><li>标有 <code>必须</code> 的项目必须提供，<strong>否则我们将不会通过</strong></li><li>系统镜像、文件下载地址<strong>需要自备下载服务器</strong><ul><li>如果没有下载服务器，支持联系我们使用第三方的 123pan、Cloudreve 网盘解析，只需提供对应网盘文件<strong>（非文件夹）</strong>的分享链接<strong>（不带密码）</strong></li><li>如果您的系统镜像足够优秀，且能够符合我们的的理念，<strong>我们可以酌情为您免费分流</strong></li><li>如果系统涉及内部文件，不方便公开，可以自行在内网搭建 Web 下载服务器，通过内网 IPv4 地址私密访问<ul><li>公网服务器，我们可以为您收录最多3个系统镜像</li><li>内网服务器，我们只能为您收录最多1个系统镜像</li><li>如有兴趣另可定制自行部署配置文件服务器版本，不受限制</li></ul></li><li>如果下载服务器如果被篡改，导致系统文件带毒的，与本人及本工具均无任何关系，我们不承担任何刑事和法律责任，<strong>一切后果由提供系统镜像的负责人承担</strong><ul><li>包括正规网盘，也会出现CDN节点文件篡改现象</li><li>所以<strong>最好提供文件的 MD5 校验信息</strong>，如果校验不通过，程序将自动终止安装，保护客户的网络信息安全</li></ul></li></ul></li><li>系统镜像内<strong>不得包含违法乱纪、流氓推广、影响用户体验</strong>的内容<ul><li>如果<strong>包含少量流氓推广，我们可以酌情收录</strong>，也可能会强制对您的系统进行净化</li><li>如果使用<strong>隔壁总裁</strong>封装，或使用其驱动，未对浏览器配置推广进行拦截删除的，我们<strong>拒绝收录</strong></li><li>如果包含<strong>病毒木马后门</strong>，我们<strong>拒绝收录</strong>，并且会将相关木马程序送到相关安全机构进行检测</li><li>如果为<strong>公网公开提供</strong>，我们会对其进行测试，并指出存在的相关问题，并且<strong>拒绝收录，直到问题解决</strong></li><li>如果<strong>多次出现技术不到位、无法正常下载安装的</strong>，我们有权对您提供的<strong>所有系统拒绝收录</strong></li><li>如果<strong>3个月未发布更新，会从列表中删除</strong>，当然部分也会酌情保留</li></ul></li><li>对于满足上述要求的、安全成熟稳定的系统镜像，<strong>目前不会收取费用</strong></li><li>如需更多定制项目，或自行部署配置文件服务器，或自己不会弄的，请联系我们，我们可以尽量帮忙解决！</li></ol><h2 id="软件功能"><a href="#软件功能" class="headerlink" title="软件功能"></a>软件功能</h2><p><strong>首次运行</strong></p><p>解压程序数据并创建桌面快捷方式：</p><p><img src="https://p0.meituan.net/dpplatform/8d0738b5889474e1f35fe458b74a2c749228.png"></p><p>提示关闭安全软件：</p><p><img src="https://m.360buyimg.com/babel/jfs/t1/161213/40/35164/4413/63f1dd2eFe80ffb71/726859c6292bd0fc.png"></p><p><strong>系统安装</strong></p><p>安装指定的镜像文件：</p><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/38af7bbd7f1f52ef06fccf2f3a44e666.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/e65fc0386701cd74c4a75d2fae75970a.png"></p><p><strong>系统备份</strong></p><p>备份系统到指定文件：</p><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/ea4a0cd651ee0d28beb8794f0cc47cce.png"></p><p><strong>在线重装</strong></p><p>在线下载并重装系统，系统来源为微软 MSDN（MVS）及 Xiaoran System、Newxitong、Windsys、不忘初心等一些优秀的项目，推荐选择我们的装机版，能省下许多宝贵的时间。</p><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/c899e482dcc97ef0a052ef142e60f6dd.png"></p><p><strong>扩展工具</strong></p><p>附带一些装机小工具，方便装机人员使用。</p><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/93af36fd080806dad7cb5a78b59718a1.png"></p><p><strong>更多信息</strong></p><p>高级功能，如果出现问题可以调整设置。</p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/b41c90c57c160f691f63a8546f8d7d95.png"></p><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li><p>重装前请记得备份 C 盘里的重要资料；</p></li><li><p>系统镜像文件不能放在系统盘（通常为 C 盘）；</p></li><li><p>校验系统镜像 MD5，保证系统的完整；</p></li><li><p><strong>请勿关闭部署过程中的所有CMD窗口，否则系统将无法正常部署安装</strong>；</p></li><li><p>请勿删除<code>C:\Windows\Setup\Set</code>目录下的任何文件，否则<strong>系统将无法正常部署</strong>；</p></li><li><p>部分杀软提示有病毒，大概率是<strong>误报</strong>，请仔细甄别并手动添加信任，推荐使用<strong>火绒安全软件</strong>、360安全卫士极速版；</p></li><li><p>此封装作品<strong>可自定义性较强</strong>，我们欢迎对该作品进行<strong>二次修改</strong>使用，如 OEM 定制、批量装机、装机联盟推广等；</p></li><li><p>本镜像仅供学习交流测试，请在24小时内自行删除，<strong>如需长期使用请确保获得正规的正版系统授权</strong>，否则<strong>一切版权纠纷及后果由使用者自行承担</strong>；</p></li><li><p>如果在使用过程中遇到BUG，或者有好的建议，<strong>欢迎到联系我们进行反馈</strong>。</p></li></ol><h2 id="软件详情"><a href="#软件详情" class="headerlink" title="软件详情"></a>软件详情</h2><p><strong>傻瓜式</strong></p><p>无需专业知识，对各系统镜像格式进行专门的安装解决方案优化，支持从ISO&#x2F;wim&#x2F;esd&#x2F;gho&#x2F;swm等格式安装系统。</p><p><strong>系统支持</strong></p><p>支持原版&#x2F;Ghost版WinXP-Win11最新版的一键安装。</p><p><strong>软件插件包</strong></p><p>安装系统后自动导入，进入桌面即可使用。</p><p><strong>全新框架</strong></p><p>第五代推翻之前代码，全部重写代码。</p><p><strong>离线自动安装接口</strong></p><p>V3.5开始，重写代码，全面开放在WinPE里启动开始自动安装，比较合适在线重装软件开发者。</p><p>详见:<a href="http://bbs.51cxsoft.com/forum.php?mod=viewthread&tid=1300&extra=">http://bbs.51cxsoft.com/forum.ph ... tid=1300&extra=</a></p><p><strong>更多的命令行支持</strong></p><p>支持自动安装参数&#x2F;备份参数&#x2F;自动分区等命令行，详细见文件夹 命令行脚本示例。</p><p><strong>更好的新主板处理器对Win7的支持</strong></p><p>bin目录下自带USB3.X&#x2F;NVME补丁，可在安装系统后自动导入。</p><p><strong>独有的木马清除技术</strong></p><p>内置病毒特征库,系统还原后将自动清除。</p><p><strong>更多的扩展工具</strong></p><p>我们是不单单开发一款系统备份恢复工具，我们将自主开发的常用工具集成到扩展工具中，一款工具即可替代部分软件的大部分功能！</p><p><strong>自定义导入驱动</strong></p><p>将驱动文件放置于\bin\AddDriver 下 系统将自动导入。</p><p><strong>多核心</strong></p><p>ImageX、Wimlib-ImageX、Ghost、DISM 四核心。</p><p><strong>插件包</strong></p><p>可使用软件插件包,可在PE安装系统后自动导入，进入桌面即可使用。</p><p>详情:<a href="https://www.51cxsoft.com/2019/06/02/ujyqiisoftpackage/">https://www.51cxsoft.com/2019/06/02/ujyqiisoftpackage/</a></p><p><strong>高度兼容性及扩展性</strong></p><p>支持桌面环境、PE 环境，全面兼容 UEFI&#x2F;BIOS、MBR&#x2F;GPT 环境；</p><p>支持苹果电脑安装 Windows 系统、支持 OEM 版 Windows 镜像安装；</p><p>支持作为 SDK 进行二次开发，可开发为支持桌面环境的自动备份还原软件；</p><p>支持命令行参数调用。</p><p><strong>丰富的软件功能</strong></p><p>1、内置多个一键装机方案，根据当前用户环境自动匹配；</p><ul><li><strong>支持关闭Win11自动加密Bitlocker分区；</strong></li><li><strong>支持当系统不存在PE模块时，联网自动下载PE模块；</strong></li><li>支持优化调整还原后的系统；</li><li><strong>支持[自定义运行接口]；</strong></li><li>支持杀毒模式，安装系统后清空非系统盘并进行扇区重建；</li><li><strong>自带USB3.X&#x2F;11代12代13代酷睿VMD驱动&#x2F;Nvme驱动补丁，还原时可选择注入；</strong></li><li><strong>支持纯UEFI下安装win7X64；</strong></li><li><strong>支持开启安全启动时安装win7X64；</strong></li><li>支持调用IT天空|系统总裁|ceomsx万能驱动包，可在还原后自动在PE&#x2F;部署中&#x2F;桌面调用；</li><li>支持导入自定义驱动；</li><li>内置独创的木马清除技术；</li><li>支持导入软件推广包&#x2F;自定义浏览器主页；</li><li>支持自定义系统部署后的桌面壁纸；</li><li>支持自定义Ghost系统的部署背景图；</li><li>支持自定义系统的OEMlogo信息；</li><li>支持系统净化功能；</li><li>支持导入系统安装密钥；</li><li>支持在线重装Windows系统；</li><li>支持命令行参数调用；</li><li>支持在PE环境下在线重装Windows系统；</li><li>支持参数形式的自动化安装系统；</li><li>支持桌面环境下单系统盘无其他分区一键还原系统；</li><li>支持插件包，在还原系统阶段即安装完成，进入桌面即可使用；</li><li>支持自动识别主板品牌并导入OEM信息；</li><li>支持快速装机；</li><li>支持命令行参数调用，详见 命令行脚本示例 目录；</li><li>支持多种自定义，详见 装机助理支持文档.txt；</li><li>支持安装一键急救系统。</li></ul><p>2、内置多款装机小工具：</p><ul><li>[分区对拷]，[引导修复]，[一键分区]，[磁盘备份]，[驱动注入]，[注入USB3.X驱动]，[系统重置]，<br>[虚拟光驱]，[批量格式化磁盘]，[查看GHO密码]，[esd解密]等。</li></ul><p>3、其他自定义</p><ul><li>支持UjyQii.ini配置文件自定义程序。</li></ul><p>……更多请看<a href="https://www.51cxsoft.com/2021/05/07/ujyqiiv5/">优捷易一键装机助理</a></p><h2 id="更新日志"><a href="#更新日志" class="headerlink" title="更新日志"></a>更新日志</h2><h3 id="启动器更新日志"><a href="#启动器更新日志" class="headerlink" title="启动器更新日志"></a>启动器更新日志</h3><blockquote><p>23.7.5.1更新日期:2023-07-05<br>1、修复 联网检测使用 IPv6 无法 ping 的 BUG<br>2、修复 控制面板卸载程序没有显示具体版本号的 BUG<br>3、新增 运行时打开浏览器访问发布页面的功能<br>4、优化 相关逻辑</p><p>23.5.27.1更新日期:2023-05-27<br>1、修复 升级时没有修改控制面板卸载程序版本号的 BUG</p><p>23.4.28.1更新日期:2023-04-28<br>1、修复 系统内运行包含 <code>core.exe</code> 字样的进程会识别多开的 BUG</p></blockquote><h3 id="内核更新日志"><a href="#内核更新日志" class="headerlink" title="内核更新日志"></a>内核更新日志</h3><blockquote><p>5.23.5.1更新日期:2023-05-01<br>1、新增 扩展工具-时间同步,解决系统时间不一致的问题<br>2、新增 功能-系统列表配置文件-exeSetup*Url字段支持MD5校验<br>3、新增 UjyQii.INI配置文件可配置跳过WIM&#x2F;ESD自动还原时的校验<br>4、新增 扩展工具-BitLocker工具,用于辅助用户进行BitLocker操作<br>5、新增 扩展工具-注册表修复<br>6、新增 更多选项-[游戏性能优化]<br>7、优化 PE模块根据系统和内存进行自动选择<br>8、优化 若干细节及极端环境的兼容性<br>9、优化 XP下PE引导兼容性<br>10、优化 [更多选项]中的优化功能<br>11、优化 扩展工具-分区校验<br>12、优化 桌面端与PE端的通讯<br>13、优化 自定义Ghost主程序功能兼容Ghost12版本<br>14、优化 Ghost相关代码,提高兼容性<br>15、调整 WIM&#x2F;ESD默认核心调整为wimlib-iamgex<br>16、优化 因win10&#x2F;11系统机制导致的一处开机启动注册表残留问题<br>17、优化 软件UI、在线重装的UI<br>18、优化 软件插件包功能与功能扩展包功能合并并优化功能<br>19、优化 自动加载万能驱动的功能,去除配置文件字段[AutoRunDrv]及界面可选项,调整为自动搜索并倒计时调用<br>20、更新 Intel英特尔RST VMD Controller驱动19.5.3.1050版<br>21、更新 Nvme补丁<br>22、更新 Imagex&#x2F;bcdboot&#x2F;dism组件至10.0.22621.1<br>23、修复 系统备份的UI错位<br>24、修复 在Win7X64RTM下的部分BUG<br>25、修复 安装一键急救系统存在的一处bug<br>26、修复 一处设置开机启动的bug<br>27、修复 搜索万能驱动一处自定义bug<br>28、修复 还原SWM格式镜像的多处bug<br>29、修复 优化自动应答文件处理代码,解决部分系统出现的自动应答文件处理错误问题<br>30、移除 支持开启安全启动的主板安装windows7 64位</p></blockquote><p>……此处仅记录大版本信息，如需最新，更多请看安装文件夹下的<code>更新日志.txt</code></p><h3 id="问题反馈"><a href="#问题反馈" class="headerlink" title="问题反馈"></a>问题反馈</h3><p>如果使用过程中有问题，欢迎积极到B站、酷安私信反馈，或直接加我QQ！</p><ul><li>B站：<a href="https://space.bilibili.com/73271091">潇然工作室</a></li><li>酷安：<a href="https://www.coolapk.com/u/1324579">狂犬主子</a></li><li>QQ（推荐）：2744460679</li></ul><hr><h2 id="免责声明"><a href="#免责声明" class="headerlink" title="免责声明"></a>免责声明</h2><ol><li><p>本工具基于 UjyQii、EasyRC 等项目定制，版权归属 51cxsoft 所有，我们仅提供在线服务器！</p></li><li><p>本软件版权属各自产权人所有，只用于个人封装技术研究交流使用，不得用于商业用途，且本人及系统制作者不承担任何技术及版权问题，请在试用后 24 小时内删除。如果您对本系统有任何意见和建议，欢迎反馈，请购买正版 Windows 操作系统软件！</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 潇然工作室 </category>
          
          <category> Windows </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 潇然工作室 </tag>
            
            <tag> Xiaoran Studio </tag>
            
            <tag> 潇然系统 </tag>
            
            <tag> Xiaoran System </tag>
            
            <tag> Windows </tag>
            
            <tag> 操作系统 </tag>
            
            <tag> 潇然一键装机助理 </tag>
            
            <tag> Xiaoran Onekey </tag>
            
            <tag> 系统安装 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>潇然PE启动 Xiaoran PE</title>
      <link href="/xrpe.html"/>
      <url>/xrpe.html</url>
      
        <content type="html"><![CDATA[<h1 id="潇然PE启动-Xiaoran-PE"><a href="#潇然PE启动-Xiaoran-PE" class="headerlink" title="潇然PE启动 Xiaoran PE"></a>潇然PE启动 Xiaoran PE</h1><p><strong>潇然PE启动 （Xiaoran PE） 原是</strong>一个专为<a href="https://xrgzs.github.io/xrok.html">潇然一键装机助理</a>定制的PE启动模块，仅集成与装机相关的功能，以联网、实用、稳定、集成为定位，从<strong>自用</strong>角度出发；</p><p><strong>现在</strong>，由于本人对 Linux 部署有需求，还增加了 <strong>iPXE 网启环境</strong>，支持从网络启动最新的 Xiaoran PE、Live-CDs (Clonezilla、GParted、Debian Installer 等)</p><p><strong>至于PE是否纯净，主要是看安装工具</strong>，我们使用的是<a href="https://xrgzs.github.io/xrok.html">潇然一键装机助理</a>、CGI、Dism++、WinNTSetup，手动安装镜像都是纯净的，请放心使用！</p><blockquote><p><strong>如需多功能PE，我不是PE发烧友，无法为您提供</strong>，如有需求请前往：<a href="https://www.sysceo.com/usm">USM</a>、<a href="https://home.edgeless.top/">Edgeless</a>、<a href="https://firpe.cn/">FirPE Project</a>、<a href="https://www.angel-pe.cn/">AngelPE</a>、<a href="https://www.hotpe.top/">HotPE</a>、<a href="http://cowpe.myzwq.cn/">CowPE</a>、<a href="https://www.znpe.top/">ZnPE</a>、<a href="https://glasspe.cn/">Glass PE</a>、<a href="https://dawnpe.com/">DawnPE</a>、<a href="https://www.win-compe.top/">ComPE</a>等了解其它项目，或前往<a href="http://bbs.wuyou.net/forum.php?mod=forumdisplay&fid=83">无忧启动论坛-PE作品发布区</a>查找，如<a href="http://bbs.wuyou.net/forum.php?mod=viewthread&tid=370573">H3多启多模集成PE系统</a>、<a href="http://bbs.wuyou.net/forum.php?mod=viewthread&tid=434320">KuerPE</a>、<a href="http://bbs.wuyou.net/home.php?mod=space&uid=757909">LightningPE</a></p></blockquote><p><em>部分图标来自于<a href="https://icons8.com/icons/fluency">icons8.com</a></em></p><h2 id="下载获取"><a href="#下载获取" class="headerlink" title="下载获取"></a>下载获取</h2><p>WIM格式启动文件：<a href="http://url.xrgzs.top/pe64">pe64.wim</a>  |  <a href="http://url.xrgzs.top/pe32">pe32.wim</a></p><p><strong>ISO格式合盘（推荐）：<a href="https://alist.xrgzs.top/d/pxy/Xiaoran%20Studio/Onekey/PE/XRPE.iso">XRPE.iso</a></strong></p><p>潇然PE启动制作器（不推荐）：<a href="https://alist.xrgzs.top/xr/Xiaoran%20Studio/Onekey/PE/%E6%BD%87%E7%84%B6PE%E5%90%AF%E5%8A%A8%E5%88%B6%E4%BD%9C%E5%99%A8V1.04(Build%202023.4.24).exe">潇然PE启动制作器V1.04(Build 2023.4.24).exe</a> </p><p><strong>iPXE 命令：</strong></p><pre class="line-numbers language-ipxe" data-language="ipxe"><code class="language-ipxe">#!iPXEdhcpchain http:&#x2F;&#x2F;url.xrgzs.top&#x2F;ipxe<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>第一种：使用潇然PE启动制作器制作（不推荐）</p><p><del>第二种：使用Ventoy，直接放入pe64.wim和pe32.wim（大神推荐）</del>（仅 Legacy Boot 推荐，UEFI Boot 会出现分辨率 640x480 的问题）</p><p><strong>第三种：使用Ventoy，放入XRPE.iso（推荐使用此方法过渡）</strong></p><p><strong>第四种：使用UltraISO、Rufus等工具，将XRPE.iso写入到U盘或刻录到光盘（小白推荐）</strong></p><p><strong>第五种：虚拟机加载XRPE.iso（虚拟机推荐）</strong></p><p>第六种：在局域网内一台计算机上运行 <code>TinyPXE网启服务器.exe</code>，其它计算机通过 PXE 网卡启动</p><h2 id="关于为什么要特立独行，搞这个PE"><a href="#关于为什么要特立独行，搞这个PE" class="headerlink" title="关于为什么要特立独行，搞这个PE"></a>关于为什么要特立独行，搞这个PE</h2><p>不用感觉，只因确实有需求，确实有必要，就做了呗。。。</p><details><summary>展开查看一眼就会爆炸的屁话</summary><p>DQo+ICoq6ZKI5a+55p+Q5LqbZsSTbmfwn5C277yaKioNCj4NCj4g5Yir5oqK5oiR55qE6aG555uu77yM5YyF5ous5pys56uZ5ZKM5r2H54S257O757uf77yM5ZKM5aSnWOiPnOOAgeiAgVjmoYPjgIFY5p6X5pyo6aOO6YKj56eN5ZWG5Lia6aG555uu55u45o+Q5bm26K6677yM5pys6Lqr5a6a5L2N5ZKM5Ye65Y+R54K55bCx5LiN5ZCM77yM5oiR55+l6YGT5L2g5b6I5Y6J5a6z77yM5L2g5oqA5pyv5q+U5oiR6auY6LaF77yM5L2G6K+35Yu&#x2F;KirigJzwn5C255y855yL5Lq65L2O4oCdKirjgIINCj4NCj4g5oiR5Y+R5Ye65p2l5bCx5piv5Li65LqG6Ieq55So77yM5L2g6L+Z6KaB5oiR5oCO5LmI5ZKM5L2g8J+Qtuino+mHiu+8nyoq5YaN6K+05LiJ6YGN4oCc6Ieq55So4oCd4oCc6Ieq55So4oCd4oCc6Ieq55So4oCd77yM5L2g8J+QtuacgOWlvee7meaIkeeci+a4healmu+8ge+8ge+8gSoqDQo+DQo+ICoq5a+55LqO5Yqd5YGc6L+Z5Liq6aG555uu55qE77yM6K+F5ZKS44CB5Za35oiR44CB5a+55oiR6L+b6KGM5aiB6IOB44CB6YGT5b6357uR5p6255qE8J+Qtu+8jOaIkeWKneS9oOS7rOmDveWBmuS4quS6uu+8gSoqDQo+DQo+IOi&#x2F;mOaciemCo+S6m+WkqeWkqeadpeaJq+aIkeermeeahPCfkLbotLzvvIznrqHkvaDmiavlh7rlh6Dkur&#x2F;kuKrwn5C25rSe77yM5Yir6ICB5piv5p2l6Zeu5oiR55qEIPCfkLZI8J+QtuOAgfCfkLZvcmRQcmVzcyDniYjmnKzmmK&#x2F;lpJrlsJHvvIHvvIHvvIENCg0K5oiR55+l6YGT77yM5L2g5piv5aW95Lq677yM6K+35LiN6KaB5a+55Y+35YWl5bqn44CC5LiK6L+w5YaF5a656L+H5r+A77yM5LiO5L2g5rKh5pyJ5YWz57O777yM5Zyo5q2k5LuF5L2c6K2m56S677yM5oSf6LCi5L2g6IO96K+75Yiw6L+Z6YeM77yBDQoNCg0KDQoNCg0KDQoNCuW+iOWkmuS6uuinieW+l+aIkeaQnui&#x2F;meS4qlBF5rKh5oSP5LmJ77yM5ZCM57G75Lqn5ZOB5aSq5aSa5LqG77yM5pyJ5Lq655Sa6Iez54K55byA6L+Z5Liq572R56uZ77yM6L+Y5Lul5Li65Y+I5piv5Liq5YGaUEXnmoTjgILmnKzkurrmib&#x2F;orqTvvIznm67liY3nvZHnu5zkuIrkv67mlLnnmoRQReehruWunuW+iOWkmu+8jCoq6KaB5oOz5pCe5LiA5LiqUEXns7vnu5&#x2F;vvIzljYHlsoHlsI&#x2F;lranvvIzlr7nnlLXohJHmhJ&#x2F;ngrnlhbTotqPpg73og73lubIqKuOAgg0KDQrmnKzkurrku47lsI&#x2F;liLDlpKfkuIDnm7Tkvb&#x2F;nlKjlnKhJVOWkqeepukVhc3lV5LyY5ZCv6YCa77yM5oSf6KeJ6Juu5aW955qE77yM5bCx5pivKirpqbHliqjmnInngrnkuI3lhagqKuOAguWQjuadpeS5n+S9v+eUqOi&#x2F;h+ezu+e7n+aAu+ijgVVTTeS8mOebmOmtlOacr+W4iO+8jOWboOS4uioq5pyJ5rWP6KeI5Zmo5Lmm562+5o6o5bm&#x2F;6ICM5LiU5peg5rOV5YWz6ZetKirvvIzkuJTkvZPnp6&#x2F;ovoPlpKfvvIzlj4jmjaLmiJDkuoZJVOWkqeepukVhc3lV5LyY5ZCv6YCa77yM5LiA55u055So5Yiw546w5Zyo44CCDQoNCuS9huaYr+i&#x2F;keWHoOW5tO+8jOWcqOezu+e7n+ijheacuuaWuemdouWHuueOsOS6huW+iOWkp+eahOWPmOWKqO+8muS4gOaYryoq6L+c56iL57u05oqk5YW06LW3KirvvIzmr5TlpoLov5znqIvph43oo4Xns7vnu5&#x2F;vvJvkuozmmK8qKkdob3N05bCB6KOF54mI57O757uf6JC95rKhKirvvIzov57nlLXohJHlsI&#x2F;nmb3pg73nn6XpgZPopoHph43oo4Xljp&#x2F;niYjnuq&#x2F;lh4Dns7vnu5&#x2F;vvJvkuInmmK8qKuezu+e7n+WSjOi9r+S7tuS4jeaWreabtOaWsCoq77yMR2hvc3TlsIHoo4XniYjns7vnu5&#x2F;mjIHnu63mm7TmlrDpmr7luqblpKfjgILlr7nkuo7ov5nkupvpl67popjvvIznjrDlnKjmr5TovoPmtYHooYznmoTmlrnmoYjmmK8qKuWcqOe6v+mHjeijhSoq77yM5oiR5Lus5Zyo6L+Z5pa56Z2i5pyJ5LiA5a6a55qE6ZyA5rGC77yM5omA5Lul5a6a5Yi25LqGKirmvYfnhLbkuIDplK7oo4XmnLrliqnnkIYqKuOAgueEtuWQjuWvuea9h+eEtuezu+e7n+mhueebrui&#x2F;m+ihjOWkp+WNh+e6p++8jOWHoOS5jumHjeaWsOWGmeS6huS4quWwgeijheW3peWFt++8jOaOpeeuoeS6huS7juezu+e7n+WuieijheWIsOezu+e7n+S8mOWMlueahOWFqOi&#x2F;h+eoi++8jOWFqOmdouWunueOsOiHquWKqOWMluOAguS9v+eUqOS6huezu+e7n+WcqOe6v+aehOW7uuOAgeWPjOmpseWKqOOAgeaOpeeuoeWFtuS7luezu+e7n+mDqOe9sua1geeoi+etieaKgOacr++8jOaPkOmrmOS6huezu+e7n+ijheacuueahOaKgOacr+WQq+mHj++8jOWinuWKoOS6huezu+e7n+eahOaVsOmHj++8jOWHj+i9u+S6huW3peS9nOeahOi0n+aLheOAgg0KDQrov5nmrL7oo4XmnLrova&#x2F;ku7bmlK&#x2F;mjIHlnKjmoYzpnaLnjq&#x2F;looPkuIvph43oo4Xns7vnu5&#x2F;vvIzlr7nkuo7ov5znqIvnu7TmiqTmnaXor7TvvIzml6DpnIBV55uY5oiW6ICF5YWJ55uY5bCx5Y+v5Lul6KOF57O757uf77yM6Z2e5bi455qE5pa55L6&#x2F;77yM5L2G5piv5bCx6ZyA6KaB6YeN5ZCv5Yiw5LiA5LiqUEXns7vnu5&#x2F;mqKHlnZfov5vooYzns7vnu5&#x2F;plZzlg4&#x2F;nmoTov5jljp&#x2F;jgIINCg0K5aSn5a626YO955+l6YGT77yM5Lyg57uf56S+5Yy655qEUEXns7vnu5&#x2F;liIbkuLoqKue7tOaKpOeJiCoq5ZKMKirnvZHnu5zniYgqKuOAgue7tOaKpOeJiOW+gOW+gOS9k+enr+i+g+Wwj++8jOS9huS4jeiDvei&#x2F;nuaOpee9kee7nO+8m+e9kee7nOeJiOmAmuW4uOWumuS9jeWoseS5kOetieWFqOWKn+iDve+8jOS9k+enr+W6nuWkp++8jOWGheWtmOWNoOeUqOebuOW9k+mrmOOAgg0KDQrpgJrluLjnlLHkuo5QReezu+e7n+S4i+ayoeacieiZmuaLn+WGheWtmO+8jOS4uuS6huiKguecgeS9k+enr++8jOaIkeS7rOmDveS8muS9v+eUqCoq57u05oqk54mIKirnmoRQReezu+e7n+S9nOS4ulBF5qih5Z2X44CC5L2G5aaC5p6c57O757uf5LiL6L296ZSZ6K+v77yM5Y2z5L2&#x2F;5L2g5bCGUEXlronoo4XliLDkuobnoaznm5jkuIrvvIznlLHkuo7kvaDmsqHmnInnvZHnu5zvvIzkuZ&#x2F;kvJrpnZ7luLjpurvng6bjgILlj6blpJbvvIzpg6jliIbkvZPnp6&#x2F;lsI&#x2F;nmoTnvZHnu5zniYhQRe+8jOS4jeaUr+aMgeeJueauiuW4uOingeiuvuWkh+eahOmpseWKqOOAgg0KDQrlj6blpJbvvIzmnKzkurrmjqXop6bliLDnmoTorr7lpIfmgKfog73mma7pgY3ovoPlt67vvIwqKuW5s+Wdh+i&#x2F;kOihjOWGheWtmOS4jei2hei&#x2F;hyA0IEdCKirjgILlr7nkuo7ov5nkupvorr7lpIfvvIzlpoLmnpzkvb&#x2F;nlKjlrozmlbTniYggUEXvvIwqKuWImuW8gOacuuWGheWtmOWwseeIhua7oSoq44CC5Y+m5aSW5LiA5Lqb5a6M5pW054mIUEXoh6rluKbns7vnu5&#x2F;ov5DooYzlupPnlJroh7PmtY&#x2F;op4jlmajnrYnlip&#x2F;og73vvIzmnKzkurroo4XmnLrkuZ&#x2F;nlKjkuI3kuIrvvIzlj6rpnIDopoHog73mtYHnlYXov5znqIvlsLHooYzkuobjgIINCg0K5Zug5q2k77yM5a+55LqOKirkuIDmrL7lsI&#x2F;lt6fogIzlj4jlhajog73jgIHlrprkvY3nu7TmiqTnmoTnvZHnu5zniYggUEUqKueahOmcgOaxgu+8jOWwseWboOatpOiAjOeUn+OAguS9huacrOS6uuW5tuS4jeaYryBQRSDogIHnjqnlrrbvvIzmsqHmnInotrPlpJ&#x2F;nmoTnu4&#x2F;pqozvvIzml6Dms5Xoh6rooYzliLbkvZxQReOAguWPpuWklui&#x2F;mOimgeino+WGs+mpseWKqOaUtumbhumXrumimOOAguacrOS6uuiHquW3seS5n+WBmui&#x2F;hyBQRe+8jOWwseefpemBk+WkhOeQhuS9k+enr+WSjOWFvOWuueaAp+mXrumimOaYr+W+iOmavueahOOAgg0KDQrnm67liY3liLbkvZxQReW+iOeugOWNle+8jOe9keS4iuS5n+acieW+iOWkmuS4gOmUrueUn+aIkOW3peWFt++8jOS9huaYr+a1i+ivleS4gOS4qlBF55qE5YW85a655oCn5b6I6Zq+77yM5ZCM5pe26L+Y6KaB5a6M5ZaE6YOo5YiG57uE5Lu244CCKirkuIDkuKpQRemhueebruiDveWkn+W5v+azm+eahOS9v+eUqO+8jOivtOaYjui&#x2F;meS4qiBQRSDlt7Lnu4&#x2F;lvojmiJDnhp&#x2F;vvIzlvIDlj5HogIXlvojkuI3lrrnmmJPjgIIqKuS9huWmguaenOW8gOWPkeWHuuadpeayoeS6uueUqO+8jOWvueS6juW8gOWPkeiAheadpeivtO+8jOS5n+aYr+S4jeWAvOW+l+eahOOAguWcqOi&#x2F;meenjeaDheWGteS4i++8jOS9oOaJjeecn+ato+S9k+S8muWIsCBQRSDliLbkvZzogIXnmoTkuI3mmJPjgILmiYDku6XmnKzkurrov5jmmK&#x2F;lr7nnpL7ljLrlhoXmr5TovoPnqLPlrprnmoQgUEUg6aG555uu6L+b6KGM5L+u5pS544CCDQoNCioq5a6e6ZmF5LiK77yM5oiR5Lmf6byT5Yqx5aSn5a625bCd6K+V6Ieq5bex5a6a5Yi2IFBF44CCKirlnKjov5nkuKrov4fnqIvkuK3vvIzlj6&#x2F;ku6XlrabliLDmm7TlpJrmnInlhbMgV2luZG93cyDlhoXmoLjnmoTnn6Xor4bvvIzlsKTlhbbmmK&#x2F;lr7nkuo7liJrmjqXop6bnlLXohJHlubbkuJTlr7nmraTmhJ&#x2F;lhbTotqPnmoTlkIzlrabjgILnm67liY3vvIznvZHnu5zkuIrmnInlvojlpJrlrprliLbnmoQgUEUg57O757uf77yM5aSn5aSa5Lmf5piv5Zyo5Liq5Lq66ZyA5rGC55qE5Z+656GA5LiK77yM5Z+65LqO5Yir55qEIFBFIOezu+e7n+WumuWItuiAjOadpeeahO+8jOS9huWkp+WkmuS7pee+juWMluS4uuS4u++8jOacieeahOeUmuiHs+mDveS4jeazqOaYjuWHuuWkhOOAguWvueS6juacrOS6uuadpeivtO+8jOWFtuWunuagh+S4jeagh+S5n+aXoOaJgOiwk++8jOWPjeato+WPquaYr+iHqueUqO+8jOeOqeeOqeWwseWlveOAguS9huaYr+aIkei&#x2F;mOaYr+agh+S6hu+8jOS7peihqOekuuWvueWOn+S9nOiAheeahOWwiumHjeWSjOaUr+aMgeOAguW4jOacm+Wkp+WutuS5n+iDveWwiumHjeeQhuino+WOn+S9nOiAheeahOiJr+iLpueUqOW&#x2F;g+OAgg0KDQrmnKxQRemhueebru+8jOabtOWkmueahOi&#x2F;mOaYryoq6Ieq57uZ6Ieq6LazKirvvIzmnKzkurrkuZ8qKuS4jemcgOimgeWwhuatpOmhueebrui&#x2F;h+WkmuaOqOW5vyoq44CC5q+V56uf5Y+C6ICD5Lyg57uf6aG555uu77yM6YeN5Y+j6Zq+6LCD77yM55So5oi36YeP6LaK5aSn77yM6LSj5Lu76LaK5aSn77yM5oOz5a6a5Yi25Lmf6LaK6Zq+44CCDQoNCuW9k+eEtu+8jOmaj+edgOmhueebruS4jeaWreWujOWWhO+8jOebruWJjeaIkeS7rOeahFBF5Lmf5pSv5oyB5LqGKirmnI3liqHlmajpqbHliqjoh6rliqjlronoo4UqKuOAgSoq572R57uc5peg55uY5ZCv5YqoKirjgIEqKuiZmuaLn+acuuaUr+aMgSoq44CBKirlnKjnur&#x2F;mj5Lku7bmianlsZUqKuetieiuuOWkmuaWsOmynOeahOWKn+iDve+8jOi&#x2F;meS6m+mDveimgeaEn+iwouWQhOS9jeWkp+S9rOWvueacrOmhueebruaPkOS+m+Wkp+mHj+eahOW4ruWKqeOAguacrOS6uuebruWJjeS5n+abtOWKoOWBj+WQkeS6juS9v+eUqOi&#x2F;meS4qiBQRe+8jCoq5bey57uP5Z+65pys5pu&#x2F;5LujIElUIOWkqeepuiBFYXN5VSDkvJjlkK&#x2F;pgJrnmoTkvb&#x2F;nlKjpnIDmsYLvvIznlJroh7Pov5jlgZrlh7rkuobkuIDkupvotoXotooqKuOAgg0KDQrlj43mraPmnKzmnaXkuZ&#x2F;mmK&#x2F;lgZrnnYDnjqnnmoTvvIzoh6rlt7HlnKjov5nkuKrpobnnm67kuK3lrabliLDnn6Xor4bvvIwqKua7oei2s+S6humcgOaxgu+8jOW8gOW&#x2F;g+W&#x2F;q+S5kOWwseWlvSoq44CC5Lmf6KG35b+D56Wd5oS&#x2F;5ZCE5L2NUEXliLbkvZzogIXku6zvvIzog73lpJ&#x2F;liLbkvZzlh7rmm7TliqDotLTov5Hoh6rouqvpnIDmsYLnmoRQReOAgg0K</p><p><em><strong>以上内容纯属放屁，请勿当真，不代表作者的观点！</strong></em></p></details><h2 id="详细介绍"><a href="#详细介绍" class="headerlink" title="详细介绍"></a>详细介绍</h2><h3 id="PE启动制作器"><a href="#PE启动制作器" class="headerlink" title="PE启动制作器"></a>PE启动制作器</h3><p><strong>此制作器有些问题，不建议使用</strong></p><details><summary>展开查看</summary><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/1d5d5cecc2224d9b683fc9d78c4aed51.png" alt="启动提示界面"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/c0df7ada0495fb3b9b7ff9bb8f7494f9.png" alt="自动下载PE文件"></p><p>注意：提示 <code>CA certification</code> 或 <code>file allocation</code> 的错误均为正常现象！</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/a88a15fdce66a03136fa63868de560dc.png" alt="进入制作主界面"></p></details><h3 id="XRPE-ISO合盘"><a href="#XRPE-ISO合盘" class="headerlink" title="XRPE.ISO合盘"></a>XRPE.ISO合盘</h3><p><strong>本人自用，推荐使用</strong></p><ul><li><p>升级了 ISO 启动文件，修复了 UEFI 启动分辨率不正确的问题</p></li><li><p>默认开启“按任意键启动”，如需关闭请删除 ISO 文件内的 <code>/boot/bootfix.bin</code> 文件</p></li><li><p><strong>集成了 iPXE 网络启动功能，支持 Legacy Boot 下从 IPv6 &#x2F; HTTPS 启动潇然PE最新版、安装最新 Linux 发行版</strong></p></li><li><p><strong>自带 TinyPXE 网络启动服务器，支持 代理 DHCP，仅需双击根目录下的 <code>TinyPXE网启服务器.exe</code> 即可</strong></p></li><li><p><strong>PXE 网启兼容 Legacy Boot 和 UEFI Boot (x86_64)，真正实现一盘多用！</strong></p><p><em>为了兼容 UEFI 的安全启动，ISO-UEFI 暂不支持 iPXE，但您可以在另一台 PC 上部署 PXE 启动服务器，以便在 UEFI 下使用 iPXE</em></p></li></ul><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/9bb0a3cdd844f96fa76841ebe262b240.png" alt="BOOTMBR"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/37388e8fd6b42ce3aa99cd360a3e9fb5.png" alt="Tiny PXE Server"></p><h3 id="iPXE-启动环境"><a href="#iPXE-启动环境" class="headerlink" title="iPXE 启动环境"></a>iPXE 启动环境</h3><p>云端更新，一有问题立刻修复；全新菜单，关键信息一目了然</p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/91d3e699f41e625f129235ad5e42b3c9.png" alt="iPXE Cloud"></p><p>重新修改的 Ryanboot，更新了版本，并更换部分镜像源解决了连通性问题，让你装各种 Linux 发行版不再烦恼</p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/bf6bcfadfa7086d2d2a4b662253f5dd4.png" alt="ryanboot-mod"></p><h3 id="Win10-22H2-19045-3208-PE-x64-630MB-网络版"><a href="#Win10-22H2-19045-3208-PE-x64-630MB-网络版" class="headerlink" title="Win10 22H2 19045.3208 PE x64 630MB 网络版"></a>Win10 22H2 19045.3208 PE x64 630MB 网络版</h3><p><strong>自己使用 WinpeMaker 生成的 PE，版本特性和之前一样，非常好用</strong></p><ul><li><p>母盘：<code>zh-cn_windows_10_business_editions_version_22h2_updated_july_2023_x64_dvd_62f461c9.iso</code></p></li><li><p>升级内核版本，支持 UEFI 安全启动的新密钥；</p></li><li><p>系统组件非常完整，内置驱动基本够用，还使用 @Lightning 的 DrvIndex 工具加载了提取自<a href="http://bbs.c3.wuyou.net/forum.php?mod=viewthread&tid=349965">USBOS</a>的系统驱动，所以体积相较之前有所增加；</p></li><li><p><strong>支持平板电脑&#x2F;触控一体机下，32位应用程序使用手指触控操作，并且能够使用系统自带的OSK屏幕键盘！</strong></p><ul><li>目前已解决32为程序问题，OSK已换为FreeVK以提供更加体验</li></ul></li><li><p>支持额外软件从快捷方式、浏览器、HotPE 模块管理在线下载安装，建议设置虚拟内存（开始菜单有相关工具）；</p></li><li><p>支持自动安装 VMware Tools，修复了对 Hyper-V 虚拟机支持，Vbox Guest 组件可到 HotPE 模块管理在线下载安装；</p></li><li><p>支持在线下载 CeoMSX 完整版并自动挂载 WIM，支持桌面右键在线更换壁纸；</p></li><li><p>支持自动连接原系统下的 Wi-Fi，或读取各盘符下潇然一键装机助理备份的 Wi-Fi 密码 xml 配置文件</p></li><li><p>添加了多款维护工具</p></li></ul><p><strong>提示：启动至少需要1.2GB内存，适合4GB及以上机器使用！</strong></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/ca1f9875236263488a41520bf743205a.png" alt="桌面"></p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/6a19876b5767706a848a476213aaa2d9.png" alt="osk.exe"></p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/d70c9ce0f9fa462aa12c91326398bba0.png" alt="美化+在线更换壁纸"></p><p><img src="https://img1.imgtp.com/2023/05/31/w9U4ZUva.gif" alt="CeoMSX"></p><h3 id="（暂时弃用）Win10-22H2-19045-2728-PE-x64-500MB-网络版"><a href="#（暂时弃用）Win10-22H2-19045-2728-PE-x64-500MB-网络版" class="headerlink" title="（暂时弃用）Win10 22H2 19045.2728 PE x64 500MB 网络版"></a>（暂时弃用）Win10 22H2 19045.2728 PE x64 500MB 网络版</h3><p><strong>不支持HyperV，组件不完整，已弃用！</strong></p><details><summary>展开查看</summary><p>修改自<a href="http://wuyou.net/forum.php?mod=viewthread&tid=424001">@2013koko</a>，补全了部分组件，支持使用远程，不支持TV；使用@Lightning的工具加载了提取自<a href="http://bbs.c3.wuyou.net/forum.php?mod=viewthread&tid=349965">USBOS</a>的系统驱动，支持服务器阵列卡、笔记本等设备读取硬盘，支持Win10下免驱的声卡，支持自动连接WiFi；支持自动安装VMTools；支持软件从快捷方式、潇然一键装机助理、HotPE模块管理在线下载安装</p><p><strong>系统桌面</strong></p><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/de669c1ba93f963a6cc5b130b4b0a1fb.png"></p><p><strong>开始菜单</strong></p><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/77b2960cc58670ed867f13248eee9429.png"></p><p><strong>集成<a href="https://www.hotpe.top/">HotPE</a>的模块管理功能（2023.4新增）</strong></p><p>一些没有包含的程序可以到HotPE模块在线加载！</p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/c8f613be958de4708adff80bc893fc11.png"></p><blockquote><p><a href="https://www.hotpe.top/">HotPE模块</a>来自于广大网友制作，对于其内容和操作不当造成的后果，包括但不限于版权纠纷、数据损失，由使用者自行承担，本人不承担任何责任！</p></blockquote></details><h3 id="Win10-21H1-19043-844-PE-x86-300MB-网络版"><a href="#Win10-21H1-19043-844-PE-x86-300MB-网络版" class="headerlink" title="Win10 21H1 19043.844 PE x86 300MB 网络版"></a>Win10 21H1 19043.844 PE x86 300MB 网络版</h3><p><strong>目前使用Kuer大师的内核，替代原来16299先用一阵子，如果有问题再换回去</strong></p><ul><li>修改自<a href="http://bbs.wuyou.net/forum.php?mod=viewthread&tid=431383">@kuer</a>，补全了部分组件，支持使用远程；</li><li>使用 @Lightning 的 DrvIndex 工具加载了提取自<a href="http://bbs.c3.wuyou.net/forum.php?mod=viewthread&tid=349965">USBOS</a>的系统驱动，支持自动连接WiFi；</li><li>支持MTP(USB连接手机进行文件共享)、RNDIS(USB连接手机使用手机共享网络)、网启ISCSI；</li><li>支持自动安装 VMware Tools，修复了对 Hyper-V 虚拟机支持；</li><li>支持在线下载 CeoMSX 完整版并自动挂载 WIM，支持桌面右键在线更换壁纸</li></ul><p><strong>768MB内存可启动！</strong></p><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/2c9ebc8710da72147590b047b1533193.png" alt="系统桌面"></p><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/642b22a6e3909b5b791001b5c1c6506d.png" alt="开始菜单"></p><p><img src="https://ldbbs.ldmnq.com/bbs/topic/attachment/2023-5/908fe01a-2dbc-440a-8b9d-e75b2dfb8611.png" alt="美化+在线更换壁纸"></p><h3 id="（暂时弃用）Win10-1709-16299-15-PE-x86-300MB-网络版"><a href="#（暂时弃用）Win10-1709-16299-15-PE-x86-300MB-网络版" class="headerlink" title="（暂时弃用）Win10 1709 16299.15 PE x86 300MB 网络版"></a>（暂时弃用）Win10 1709 16299.15 PE x86 300MB 网络版</h3><details><summary>展开查看</summary><p>修改自<a href="http://bbs.wuyou.net/forum.php?mod=viewthread&tid=378234">@ljycslg</a>，支持读取4GB以上内存</p><p><strong>系统桌面</strong></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/40478ae8d5ccda550e94561c6f7cfd2c.png"></p><p><strong>开始菜单</strong></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/398af6487604d9456d328cb83364922e.png"></p></details><h2 id="问题反馈"><a href="#问题反馈" class="headerlink" title="问题反馈"></a>问题反馈</h2><p>如果使用过程中有问题，欢迎积极到<strong>B站、酷安私信</strong>反馈，或直接加我QQ！</p><ul><li>B站（推荐）：<a href="https://space.bilibili.com/73271091">潇然工作室</a></li><li>酷安：<a href="https://www.coolapk.com/u/1324579">狂犬主子</a></li><li>QQ：2744460679</li></ul><hr><h2 id="免责声明"><a href="#免责声明" class="headerlink" title="免责声明"></a>免责声明</h2><p>本 Windows 系统及软件版权属各自产权人所有，只用于个人封装技术研究交流使用，不得用于商业用途，且本系统制作者不承担任何技术及版权问题，请在试用后 24 小时内删除。如果您对本系统有任何意见和建议，欢迎反馈，请购买正版 Windows 操作系统软件！</p>]]></content>
      
      
      <categories>
          
          <category> 潇然工作室 </category>
          
          <category> Windows </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 潇然工作室 </tag>
            
            <tag> Xiaoran Studio </tag>
            
            <tag> 潇然系统 </tag>
            
            <tag> Xiaoran System </tag>
            
            <tag> Windows </tag>
            
            <tag> 操作系统 </tag>
            
            <tag> WinPE </tag>
            
            <tag> Xiaoran PE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Proxmox VE 常用命令整理</title>
      <link href="/posts/pve-cmd.html"/>
      <url>/posts/pve-cmd.html</url>
      
        <content type="html"><![CDATA[<h1 id="Proxmox-VE（PVE）常用命令整理"><a href="#Proxmox-VE（PVE）常用命令整理" class="headerlink" title="Proxmox VE（PVE）常用命令整理"></a>Proxmox VE（PVE）常用命令整理</h1><p>个人对虚拟化部署 <del>All in BOOM</del> Home Server 有需求，试过 ESXi、unRaid、Proxmox VE 等方案，认为 ESXi、PVE 这两款比较符合我的要求，前者适合专业的服务器使用，个人 PC 还是推荐基于 Debian 的后者。由于本人没有专业服务器，ESXi 比较吃我内存，故转投 PVE</p><p>由于PVE许多功能无法在Web UI中完成设置，需要使用一些命令、修改一些配置文件，本人记性又不太好。俗话说“好记性不如烂笔头”，故整理出本笔记供后续查看，本博客也重点更新此文章，如有需要请收藏</p><p>具体ESXi、PVE、unRaid的对比参考：<a href="https://zhuanlan.zhihu.com/p/166352130">https://zhuanlan.zhihu.com/p/166352130</a></p><p>学习PVE推荐博客（PVE的瑞士军刀）：<a href="https://foxi.buduanwang.vip/">https://foxi.buduanwang.vip/</a></p><p><strong>注意：本文大多数内容基于PVE7编写，和其它版本会有些出入，请悉知！</strong></p><h2 id="一、安装升级"><a href="#一、安装升级" class="headerlink" title="一、安装升级"></a>一、安装升级</h2><p>关于系统安装，属于是有手就行的操作，故不在赘述。</p><h3 id="（非必须）安装PVETools"><a href="#（非必须）安装PVETools" class="headerlink" title="（非必须）安装PVETools"></a>（非必须）安装PVETools</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LC_ALL</span></span><span class="token operator">=</span>en_US.UTF-8<span class="token function">apt</span> update <span class="token operator">&amp;&amp;</span> <span class="token function">apt</span> <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">git</span> <span class="token operator">&amp;&amp;</span> <span class="token function">git</span> clone https://github.com/ivanhao/pvetools.git<span class="token builtin class-name">cd</span> pvetools./pvetools.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="1、国内源设置"><a href="#1、国内源设置" class="headerlink" title="1、国内源设置"></a>1、国内源设置</h3><p>删除企业源：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc/apt/sources.list.d/pve-enterprise.list<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc/apt/sources.list.d/ceph.list<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>设置国内源：注意分版本</p><details><summary>展开查看PVE7专用命令</summary><p>仅适用于PVE7，其它版本请勿乱用！！！</p><p>编辑镜像源：</p><p>先备份一下再修改</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> /etc/apt/sources.list /etc/apt/sources.list.bak<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nano</span> /etc/apt/sources.list<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>中科大源（移动速度快）：</p><pre class="line-numbers language-none"><code class="language-none">deb http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;debian&#x2F; bullseye main contrib non-freedeb http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;debian&#x2F; bullseye-updates main contrib non-freedeb http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;debian&#x2F; bullseye-backports main contrib non-freedeb http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;debian-security bullseye-security main contrib deb http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;proxmox&#x2F;debian bullseye pve-no-subscription#deb http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;proxmox&#x2F;debian&#x2F;ceph-pacific bullseye main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>一键操作——中科大源：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">'EOF'<span class="token bash punctuation"> <span class="token operator">></span> /etc/apt/sources.list</span>deb http://mirrors.ustc.edu.cn/debian/ bullseye main contrib non-freedeb http://mirrors.ustc.edu.cn/debian/ bullseye-updates main contrib non-freedeb http://mirrors.ustc.edu.cn/debian/ bullseye-backports main contrib non-freedeb http://mirrors.ustc.edu.cn/debian-security bullseye-security main contrib deb http://mirrors.ustc.edu.cn/proxmox/debian bullseye pve-no-subscription#deb http://mirrors.ustc.edu.cn/proxmox/debian/ceph-pacific bullseye mainEOF</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></details><details><summary>展开查看PVE通用命令</summary><p>一键操作——中科大源：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 修改基础系统（Debian）的源文件：</span><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s|^deb http://ftp.debian.org|deb https://mirrors.ustc.edu.cn|g'</span> /etc/apt/sources.list<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s|^deb http://security.debian.org|deb https://mirrors.ustc.edu.cn/debian-security|g'</span> /etc/apt/sources.list<span class="token comment"># 修改 Proxmox 的源文件</span><span class="token builtin class-name">source</span> /etc/os-release<span class="token builtin class-name">echo</span> <span class="token string">"deb https://mirrors.ustc.edu.cn/proxmox/debian/pve <span class="token variable">$VERSION_CODENAME</span> pve-no-subscription"</span> <span class="token operator">></span> /etc/apt/sources.list.d/pve-no-subscription.list<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>对于 Proxmox Backup Server 和 Proxmox Mail Gateway，请将以上命令中的 <code>pve</code> 分别替换为 <code>pbs</code> 和 <code>pmg</code>。</p></details><h3 id="2、升级系统"><a href="#2、升级系统" class="headerlink" title="2、升级系统"></a>2、升级系统</h3><p>更新软件包数据库缓存：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> update<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>升级系统软件包：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> upgrade <span class="token parameter variable">-y</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>（可选，建议）安装<code>vim</code>代替难用的<code>vi</code>：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> <span class="token function">install</span> <span class="token function">vim</span> <span class="token parameter variable">-y</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>（可选，建议）安装 linux 6.2 内核代替 PVE7 (debian 11) 难用的 5.15 内核：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> <span class="token function">install</span> pve-kernel-6.2 <span class="token parameter variable">-y</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>注意：PVE8 已默认 linux 6.2 内核！</p><h3 id="3、替换-CT-模板源"><a href="#3、替换-CT-模板源" class="headerlink" title="3、替换 CT 模板源"></a>3、替换 CT 模板源</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> /usr/share/perl5/PVE/APLInfo.pm /usr/share/perl5/PVE/APLInfo.pm_back<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s|http://download.proxmox.com|http://mirrors.ustc.edu.cn/proxmox|g'</span> /usr/share/perl5/PVE/APLInfo.pmsystemctl restart pvedaemon<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="4、删除订阅弹窗提醒"><a href="#4、删除订阅弹窗提醒" class="headerlink" title="4、删除订阅弹窗提醒"></a>4、删除订阅弹窗提醒</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sed</span> <span class="token parameter variable">-i.bak</span> <span class="token string">"s/data.status.toLowerCase() !== 'active'/false/g"</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="二、磁盘管理"><a href="#二、磁盘管理" class="headerlink" title="二、磁盘管理"></a>二、磁盘管理</h2><h3 id="1、查看分区结构"><a href="#1、查看分区结构" class="headerlink" title="1、查看分区结构"></a>1、查看分区结构</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">fdisk</span> <span class="token parameter variable">-l</span>lvs<span class="token function">cat</span> /etc/pve/storage.cfg<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@pve:~<span class="token comment"># fdisk -l</span>Disk /dev/nvme0n1: <span class="token number">465.76</span> GiB, <span class="token number">500107862016</span> bytes, <span class="token number">976773168</span> sectorsDisk model: Asgard AN2 500NVMe-M.2/80               Units: sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytesSector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytesI/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytesDisklabel type: gptDisk identifier: 6F4A00AC-F4C9-4352-A8D4-63148EC21292Device           Start       End   Sectors   Size Type/dev/nvme0n1p1      <span class="token number">34</span>      <span class="token number">2047</span>      <span class="token number">2014</span>  1007K BIOS boot/dev/nvme0n1p2    <span class="token number">2048</span>   <span class="token number">2099199</span>   <span class="token number">2097152</span>     1G EFI System/dev/nvme0n1p3 <span class="token number">2099200</span> <span class="token number">976773134</span> <span class="token number">974673935</span> <span class="token number">464</span>.8G Linux LVMDisk /dev/mapper/pve-swap: <span class="token number">7.62</span> GiB, <span class="token number">8183087104</span> bytes, <span class="token number">15982592</span> sectorsUnits: sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytesSector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytesI/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytesDisk /dev/mapper/pve-root: <span class="token number">96</span> GiB, <span class="token number">103079215104</span> bytes, <span class="token number">201326592</span> sectorsUnits: sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytesSector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytesI/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytesroot@pve:~<span class="token comment"># lvs</span>  LV   VG  Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert  data pve twi-a-tz-- <span class="token number">338</span>.23g             <span class="token number">0.00</span>   <span class="token number">0.50</span>                              root pve -wi-ao----  <span class="token number">96</span>.00g                                                      swap pve -wi-ao----   <span class="token number">7</span>.62g                                                    root@pve:~<span class="token comment"># cat /etc/pve/storage.cfg</span>dir: <span class="token builtin class-name">local</span>        path /var/lib/vz        content iso,vztmpl,backuplvmthin: local-lvm        thinpool data        vgname pve        content rootdir,images<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2、扩展根目录"><a href="#2、扩展根目录" class="headerlink" title="2、扩展根目录"></a>2、扩展根目录</h3><p>在虚拟机配置栏，选择磁盘，点击移动磁盘到其他磁盘</p><p>使用命令删除lvm-thin：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">lvremove /dev/pve/data<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将lvm-thin的空间转移到pve-root：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">lvextend <span class="token parameter variable">-rl</span> +100%FREE /dev/pve/root<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>使用<code>df -h</code>查看，根目录已经扩大：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@pve:~<span class="token comment"># df -h</span>Filesystem            Size  Used Avail Use% Mounted onudev                  <span class="token number">3</span>.8G     <span class="token number">0</span>  <span class="token number">3</span>.8G   <span class="token number">0</span>% /devtmpfs                 781M  <span class="token number">1</span>.2M  780M   <span class="token number">1</span>% /run/dev/mapper/pve-root  450G  <span class="token number">3</span>.7G  427G   <span class="token number">1</span>% /tmpfs                 <span class="token number">3</span>.9G   25M  <span class="token number">3</span>.8G   <span class="token number">1</span>% /dev/shmtmpfs                 <span class="token number">5</span>.0M     <span class="token number">0</span>  <span class="token number">5</span>.0M   <span class="token number">0</span>% /run/lock/dev/nvme0n1p2       1022M  344K 1022M   <span class="token number">1</span>% /boot/efi/dev/fuse             128M   16K  128M   <span class="token number">1</span>% /etc/pvetmpfs                 781M     <span class="token number">0</span>  781M   <span class="token number">0</span>% /run/user/0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在网页上，删除lvm-thin：</p><p><img src="https://ldbbs.ldmnq.com/bbs/topic/attachment/2023-5/1c24a421-621a-4737-bafd-8a8a9d4589fa.png"></p><p><img src="https://ldbbs.ldmnq.com/bbs/topic/attachment/2023-5/993220ba-836b-480f-be8c-f029ebc6e727.png"></p><p>进入目录&#x2F;var&#x2F;lib&#x2F;vz查看所有内容：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ls</span> /var/lib/vz/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@pve:~<span class="token comment"># ls /var/lib/vz/</span>dump  images  private  snippets  template<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="三、硬件直通"><a href="#三、硬件直通" class="headerlink" title="三、硬件直通"></a>三、硬件直通</h2><h3 id="1、开启-IOMMU-支持"><a href="#1、开启-IOMMU-支持" class="headerlink" title="1、开启 IOMMU 支持"></a>1、开启 IOMMU 支持</h3><p>编辑 grub 配置文件中，Linux 内核的启动参数：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/default/grub<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>找到：</p><blockquote><p>GRUB_CMDLINE_LINUX_DEFAULT&#x3D;”quiet”</p></blockquote><p>Intel CPU改为：</p><blockquote><p>GRUB_CMDLINE_LINUX_DEFAULT&#x3D;”quiet intel_iommu&#x3D;on iommu&#x3D;pt”</p></blockquote><p>如需GVT-g改为：</p><blockquote><p>GRUB_CMDLINE_LINUX_DEFAULT&#x3D;”quiet intel_iommu&#x3D;on iommu&#x3D;pt i915.enable_gvt&#x3D;1”</p></blockquote><p>开启ACS改为：</p><blockquote><p>GRUB_CMDLINE_LINUX_DEFAULT&#x3D;”quiet intel_iommu&#x3D;on iommu&#x3D;pt pcie_acs_override&#x3D;downstream”</p></blockquote><p>AMD CPU改为：</p><blockquote><p>GRUB_CMDLINE_LINUX_DEFAULT&#x3D;”quiet amd_iommu&#x3D;on iommu&#x3D;pt pcie_acs_override&#x3D;downstream”</p></blockquote><p>显卡直通加上<code>video=vesafb:off video=efifb:off video=simplefb:off</code>，目的是屏蔽显卡，加了之后，启动进内核后停留在一个画面，<font color=red><strong>如需使用钩子、安装GUI请勿添加，通常无需添加！</strong></font></p><blockquote><p>GRUB_CMDLINE_LINUX_DEFAULT&#x3D;”quiet intel_iommu&#x3D;on iommu&#x3D;pt video&#x3D;vesafb:off video&#x3D;efifb:off video&#x3D;simplefb:off pcie_acs_override&#x3D;downstream”</p></blockquote><p>最全（不用改modprobe）：</p><blockquote><p>GRUB_CMDLINE_LINUX_DEFAULT&#x3D;”quiet intel_iommu&#x3D;on iommu&#x3D;pt pcie_acs_override&#x3D;downstream,multifunction initcall_blacklist&#x3D;sysfb_init video&#x3D;simplefb:off video&#x3D;vesafb:off video&#x3D;efifb:off video&#x3D;vesa:off disable_vga&#x3D;1 vfio_iommu_type1.allow_unsafe_interrupts&#x3D;1 kvm.ignore_msrs&#x3D;1 modprobe.blacklist&#x3D;radeon,nouveau,nvidia,nvidiafb,nvidia-gpu,snd_hda_intel,snd_hda_codec_hdmi,i915”</p></blockquote><p>说明：</p><ol><li>IOMMU (I&#x2F;O Memory Management Unit)中断重新映射。如果不中断重新映射，将无法使用 PCI 直通。设备分配将失败，并显示“无法分配设备”[设备名称]“：不允许操作”或“找不到中断重新映射硬件，将设备传递到非特权域不安全”错误。【 ‘Failed to assign device “[device name]”: Operation not permitted’ or ‘Interrupt Remapping hardware not found, passing devices to unprivileged domains is insecure.’ error.】 所有使用英特尔处理器和芯片组的系统，如果支持英特尔虚拟化技术定向 I&#x2F;O （VT-d），但不支持中断重新映射，将看到此类错误。较新的处理器和芯片组（AMD 和英特尔）提供中断重新映射支持；</li><li>PCIe直通需要主要主要开启虚拟化， Intel叫VT-d，AMD的叫AMD-V(i) ，都需要再主板BIOS里面开启；</li><li>Intel添加的为<code>intel_iommu=on</code>，AMD添加的为<code>amd_iommu=on</code>；</li><li><code>iommu=pt</code>：这仅在必要时才启用 IOMMU 转换，适配器不需要使用 DMA 转换到内存，因此可以提高虚拟机管理程序 PCIe 设备（未传递到 VM）的性能。意思就是开了能提高虚拟机调取PCIe的性能，那就开吧。</li><li><code>i915.enable_gvt=1</code>：Intel的 GVT-g 驱动程序集成在内核中，启用时加载模块。意思就是，想开启GVT-g的就添加这条，显卡直通的就不要添加了。</li></ol><h3 id="2、增加驱动黑名单"><a href="#2、增加驱动黑名单" class="headerlink" title="2、增加驱动黑名单"></a>2、增加驱动黑名单</h3><p><font color=red><strong>如果使用vGPU、Gvt-G、使用钩子、安装GUI请勿添加，通常无需添加！</strong></font></p><p>Intel显卡：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"blacklist snd_hda_intel"</span> <span class="token operator">>></span> /etc/modprobe.d/blacklist.conf <span class="token builtin class-name">echo</span> <span class="token string">"blacklist snd_hda_codec_hdmi"</span> <span class="token operator">>></span> /etc/modprobe.d/blacklist.conf <span class="token builtin class-name">echo</span> <span class="token string">"blacklist i915"</span> <span class="token operator">>></span> /etc/modprobe.d/blacklist.conf <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>AMD显卡：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"blacklist radeon"</span> <span class="token operator">>></span> /etc/modprobe.d/blacklist.conf <span class="token builtin class-name">echo</span> <span class="token string">"blacklist amdgpu"</span> <span class="token operator">>></span> /etc/modprobe.d/blacklist.conf <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>NVIDIA显卡：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"blacklist nouveau"</span> <span class="token operator">>></span> /etc/modprobe.d/blacklist.conf <span class="token builtin class-name">echo</span> <span class="token string">"blacklist nvidia"</span> <span class="token operator">>></span> /etc/modprobe.d/blacklist.conf <span class="token builtin class-name">echo</span> <span class="token string">"blacklist nvidiafb"</span> <span class="token operator">>></span> /etc/modprobe.d/blacklist.conf <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>解决增加PCI设备后虚拟机无法启动</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"options vfio_iommu_type1 allow_unsafe_interrupts=1"</span> <span class="token operator">>></span> /etc/modprobe.d/pve-blacklist.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3、绑定vfio"><a href="#3、绑定vfio" class="headerlink" title="3、绑定vfio"></a>3、绑定vfio</h3><p><font color=red><strong>通常无需执行此步骤！</strong></font></p><h4 id="查看自己的显卡、声卡的PCI地址、did和vid"><a href="#查看自己的显卡、声卡的PCI地址、did和vid" class="headerlink" title="查看自己的显卡、声卡的PCI地址、did和vid"></a>查看自己的显卡、声卡的PCI地址、did和vid</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">lspci <span class="token parameter variable">-nn</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>root@pve:~# lspci -nn<br>……<br><strong>00:02.0 VGA compatible controller [0300]: Intel Corporation HD Graphics 530 [8086:1912] (rev 06)</strong><br>……<br><strong>00:1f.3 Audio device [0403]: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family HD Audio Controller [8086:a170] (rev 31)</strong><br>……</p></blockquote><p>可以看到，显卡的PCI地址为00:02.0，did和vid为8086:1912，声卡以此类推</p><h4 id="执行命令增加vfio-pci选项"><a href="#执行命令增加vfio-pci选项" class="headerlink" title="执行命令增加vfio-pci选项"></a>执行命令增加vfio-pci选项</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"options vfio-pci ids=8086:1912,8086:a170"</span> <span class="token operator">></span> /etc/modprobe.d/vfio.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>注意：上面这条命令，ids&#x3D;后面跟直通组的所有设备，中间以英文逗号隔开，自己的设备需要自己替换，请勿照抄</p><h4 id="检查配置"><a href="#检查配置" class="headerlink" title="检查配置"></a>检查配置</h4><p>上述操作完成之后，再检查一下，是否将例子内容替换成自己的</p><p>使用以下命令查看：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /etc/modprobe.d/blacklist.conf<span class="token function">cat</span> /etc/modprobe.d/vfio.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>blacklist radeon<br>blacklist amdgpu<br>blacklist snd_hda_intel<br>blacklist snd_hda_codec_hdmi<br>blacklist i915<br>options vfio-pci ids&#x3D;8086:1912,8086:a170</p></blockquote><h3 id="4、加载相应的内核模块"><a href="#4、加载相应的内核模块" class="headerlink" title="4、加载相应的内核模块"></a>4、加载相应的内核模块</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> vfio <span class="token operator">>></span> /etc/modules<span class="token builtin class-name">echo</span> vfio_iommu_type1 <span class="token operator">>></span> /etc/modules<span class="token builtin class-name">echo</span> vfio_pci <span class="token operator">>></span> /etc/modules<span class="token builtin class-name">echo</span> vfio_virqfd <span class="token operator">>></span> /etc/modules<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>如需vGPU和GVT-g，还需：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> kvmgt <span class="token operator">>></span> /etc/modules<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>对于Nvidia显卡，避免一些莫名其妙的错误，需要：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"options kvm ignore_msrs=1"</span> <span class="token operator">></span> /etc/modprobe.d/kvm.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="5、更新grub和内核"><a href="#5、更新grub和内核" class="headerlink" title="5、更新grub和内核"></a>5、更新grub和内核</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">update-grub</span>update-initramfs <span class="token parameter variable">-k</span> all <span class="token parameter variable">-u</span><span class="token function">reboot</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="验证是否开启iommu"><a href="#验证是否开启iommu" class="headerlink" title="验证是否开启iommu"></a>验证是否开启iommu</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">dmesg</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-e</span> DMAR <span class="token parameter variable">-e</span> IOMMU <span class="token parameter variable">-e</span> AMD-Vi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>出现如下例子，则代表成功：</p><blockquote><p>……<br><strong>[    0.030895] DMAR: IOMMU enabled</strong><br>……<br><strong>[    0.303716] DMAR: Intel(R) Virtualization Technology for Directed I&#x2F;O</strong></p></blockquote><p>此时输入命令</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">find</span> /sys/kernel/iommu_groups/ <span class="token parameter variable">-type</span> l<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>&#x2F;sys&#x2F;kernel&#x2F;iommu_groups&#x2F;7&#x2F;devices&#x2F;0000:00:1c.0<br>&#x2F;sys&#x2F;kernel&#x2F;iommu_groups&#x2F;5&#x2F;devices&#x2F;0000:00:17.0<br>&#x2F;sys&#x2F;kernel&#x2F;iommu_groups&#x2F;13&#x2F;devices&#x2F;0000:06:00.0<br>……</p></blockquote><p>出现很多直通组，就代表成功</p><p>如果没有任何东西，就是没有开启，请检查主板BIOS VT-d设置和GRUB设置</p><blockquote><p>如硬件设备不支持，可以使用以下命令允许不安全的中断：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"options vfio_iommu_type1 allow_unsafe_interrupts=1"</span> <span class="token operator">></span> /etc/modprobe.d/iommu_unsafe_interrupts.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h3 id="6、显卡直通直通"><a href="#6、显卡直通直通" class="headerlink" title="6、显卡直通直通"></a>6、显卡直通直通</h3><h4 id="独显直通虚拟机"><a href="#独显直通虚拟机" class="headerlink" title="独显直通虚拟机"></a>独显直通虚拟机</h4><p>独显直通比较简单，直接在网页里面配置，机型按需设置，如legacy boot就用SeaBIOS+i440fx，uefi boot就用OVMF+q35，装好系统，添加PCI设备，选择你的显卡，所有功能最好勾上，PCI-Express勾不勾需要自行测试，i440fx无法勾选PCI-E，然后如果需要显卡显示到显示器，将虚拟机显示设为无，勾选主GPU</p><p>直通两张显卡可能会出现问题及解决方法：</p><p><a href="https://www.wunote.cn/article/5288/">https://www.wunote.cn/article/5288/</a></p><h4 id="核显直通虚拟机"><a href="#核显直通虚拟机" class="headerlink" title="核显直通虚拟机"></a>核显直通虚拟机</h4><p>建议6代以上机器尝试，实测6代i5 6500完美直通，任何版本驱动均无问题</p><p>注意：</p><ul><li>直通后无法开启虚拟机，请检查配置有没有错误，在配置正确的情况下尝试更新、降级PVE Linux内核。</li><li>直通给Windows虚拟机打上驱动后出现黑屏、花屏等问题，最好试试Linux，因为有时候是显卡的Windows驱动导致的</li></ul><p>Linux下查看显卡信息：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ls</span> /dev/dri<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="方案1-UDT直通（不推荐）"><a href="#方案1-UDT直通（不推荐）" class="headerlink" title="方案1-UDT直通（不推荐）"></a>方案1-UDT直通（不推荐）</h5><p>适用于5代以上的CPU核显</p><p>如果你的VMID是123，那么命令应该是</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">qm <span class="token builtin class-name">set</span> <span class="token number">123</span> <span class="token parameter variable">-args</span> <span class="token string">"-device vfio-pci,host=00:02.0,addr=0x18,x-vga=on,x-igd-opregion=on"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果你打算直通到群晖，需要在GUI面板上，将显卡设置成无，添加串口设备用于调试，同时将核显位置绑定到虚拟机的00:02位置，所以应该执行该命令</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">qm <span class="token builtin class-name">set</span> <span class="token number">123</span> <span class="token parameter variable">-args</span> <span class="token string">"-device vfio-pci,host=00:02.0,addr=0x02,x-vga=on,x-igd-opregion=on"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>PVE下黑群晖核显直通无法开启硬解的解决方法</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">qm <span class="token builtin class-name">set</span> <span class="token number">123</span> <span class="token parameter variable">-args</span> <span class="token string">"-device vfio-pci,host=00:02.0,addr=0x02,x-vga=on,x-igd-opregion=on"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果通过上述操作，核显不能输出到显示器，那么你应该尝试传统方式</p><h5 id="方案2-传统方式（推荐）"><a href="#方案2-传统方式（推荐）" class="headerlink" title="方案2-传统方式（推荐）"></a>方案2-传统方式（推荐）</h5><p>SeaBIOS+i440fx，要求宿主机BIOS中启用CSM，且最好以Legacy Boot引导模式启动，将显卡设置成无</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vi</span> /etc/pve/qemu-server/<span class="token operator">&lt;</span>VMID<span class="token operator">></span>.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在直通核显一行后面添加“legacy-igd&#x3D;1”，如下所示</p><blockquote><p>hostpci0: 0000:00:02,legacy-igd&#x3D;1</p></blockquote><p><strong>还要在首行添加以下内容（重要）</strong></p><blockquote><p>args: -set device.hostpci0.x-igd-gms&#x3D;1</p></blockquote><p>备用：-set device.hostpci0.addr&#x3D;02.0 -set device.hostpci0.x-igd-gms&#x3D;1 -set device.hostpci0.x-igd-opregion&#x3D;on</p><p>或</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">qm <span class="token builtin class-name">set</span> <span class="token operator">&lt;</span>VMID<span class="token operator">></span> <span class="token parameter variable">-args</span> <span class="token string">"-set device.hostpci0.x-igd-gms=1"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果还是不行，请看更多教程：</p><p><a href="https://foxi.buduanwang.vip/yj/1602.html">https://foxi.buduanwang.vip/yj/1602.html</a></p><p><a href="https://zyyme.com/pve-igpu-passthrough.html">https://zyyme.com/pve-igpu-passthrough.html</a></p><h5 id="方案3-GVTg"><a href="#方案3-GVTg" class="headerlink" title="方案3-GVTg"></a>方案3-GVTg</h5><p>参看设备支持的类型：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ls</span> /sys/bus/pci/devices/0000:00:02.0/mdev_supported_types<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>我这边i5 6500显示</p><blockquote><p>i915-GVTg_V5_4  i915-GVTg_V5_8</p></blockquote><blockquote><p><strong>附：GVT-g可支持数量和最多分辨率：</strong></p><ul><li>i915-GVTg_V5_1  # Video memory: &lt;512MB, 2048MB&gt;, resolution: up to 1920x1200<br>可用数量</li><li>i915-GVTg_V5_2  # Video memory: &lt;256MB, 1024MB&gt;, resolution: up to 1920x1200<br>可用数量</li><li><strong>i915-GVTg_V5_4  # Video memory: &lt;128MB, 512MB&gt;, resolution: up to 1920x1200</strong><br><strong>可用数量2</strong></li><li>i915-GVTg_V5_8  # Video memory: &lt;64MB, 384MB&gt;, resolution: up to 1024x768<br>可用数量1</li></ul></blockquote><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/a89d62d54a33ed4b9dea325a21a9759a.png"></p><p>群晖：seabios+i440fx</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">qm <span class="token builtin class-name">set</span> <span class="token number">123</span> <span class="token parameter variable">-args</span> <span class="token string">"-set 'device.hostpci0.addr=0x02'"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="7、硬盘直通虚拟机"><a href="#7、硬盘直通虚拟机" class="headerlink" title="7、硬盘直通虚拟机"></a>7、硬盘直通虚拟机</h3><p>引用佛西博客的图</p><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/830dd026e741952d99653ec804218b4f.png"></p><h4 id="RDM磁盘直通"><a href="#RDM磁盘直通" class="headerlink" title="RDM磁盘直通"></a>RDM磁盘直通</h4><p>将单个硬盘或者分区，通过qemu进行映射到虚拟机</p><p>通过这种方式，硬盘会在虚拟机内会认为是一个qemu-hdd</p><p>相当于将某块硬盘直通给虚拟机的磁盘控制器，据说性能衰减不大，但虚拟机一般获取不到磁盘信息，容易丢失数据，NAS勿用！！！！！</p><p>RDM磁盘直通，不需要开启iommu，只能在PVE命令行中添加</p><p>列出当前的硬盘列表：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ls</span> <span class="token parameter variable">-la</span> /dev/disk/by-id/<span class="token operator">|</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> dm<span class="token operator">|</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> lvm<span class="token operator">|</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> part<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>root@pve:~# ls -la &#x2F;dev&#x2F;disk&#x2F;by-id&#x2F;|grep -v dm|grep -v lvm|grep -v part<br>total 0<br>drwxr-xr-x 2 root root 540 Apr 28 16:39 .<br>drwxr-xr-x 6 root root 120 Mar  3 15:52 ..<br>lrwxrwxrwx 1 root root  13 Apr 28 16:39 nvme-eui.01000000010000005cd2e431fee65251 -&gt; ..&#x2F;..&#x2F;nvme2n1<br>lrwxrwxrwx 1 root root  13 Mar  3 15:52 nvme-eui.334843304aa010020025385800000004 -&gt; ..&#x2F;..&#x2F;nvme1n1<br>lrwxrwxrwx 1 root root  13 Apr 28 17:36 nvme-eui.334843304ab005400025385800000004 -&gt; ..&#x2F;..&#x2F;nvme0n1<br>lrwxrwxrwx 1 root root  13 Apr 28 16:39 nvme-INTEL_SSDPE2KX020T8_BTLJ039307142P0BGN -&gt; ..&#x2F;..&#x2F;nvme2n1<br>lrwxrwxrwx 1 root root  13 Mar  3 15:52 nvme-SAMSUNG_MZWLL800HEHP-00003_S3HCNX0JA01002 -&gt; ..&#x2F;..&#x2F;nvme1n1<br>lrwxrwxrwx 1 root root  13 Apr 28 17:36 nvme-SAMSUNG_MZWLL800HEHP-00003_S3HCNX0JB00540 -&gt; ..&#x2F;..&#x2F;nvme0n1<br>lrwxrwxrwx 1 root root   9 Mar  3 15:52 scsi-35000c500474cd7eb -&gt; ..&#x2F;..&#x2F;sda<br>lrwxrwxrwx 1 root root   9 Mar  3 15:52 wwn-0x5000c500474cd7eb -&gt; ..&#x2F;..&#x2F;sda</p></blockquote><p>注意：</p><ul><li>nvme开头的是nvme硬盘</li><li>ata开头是走sata或者ata通道的设备</li><li>scsi开头是scsi设备-阵列卡raid或者是直通卡上的硬盘</li></ul><p><strong>直通方法</strong></p><p>通过以下命令进行RDM直通：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">qm <span class="token builtin class-name">set</span> <span class="token operator">&lt;</span>vmid<span class="token operator">></span> <span class="token parameter variable">--scsiX</span> /dev/disk/by-id/xxxxxxx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>注意：</p><p><vmid>是你的虚拟机编号；</p><p>–scsiX中的scsi指的是虚拟机磁盘控制器类型，也可改为–sataX、–ideX；</p><p>–scsiX中的X是你想直通到虚拟机scsi控制器的那个插孔，为整数，如0、1、2、3，注意如果是sata控制器不能超过–sata5，因为q35最多只支持6个sata ports</p><p>例如虚拟机的vmid是123，打算直通intel的一个nvme硬盘，那么你可以使用下面命令</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">qm <span class="token builtin class-name">set</span> <span class="token number">101</span> <span class="token parameter variable">--scsi1</span> /dev/disk/by-id/nvme-INTEL_SSDPE2KX020T8_BTLJ039307142P0BGN<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果需要取消直通，直接在浏览器网页里面删除即可</p><h4 id="磁盘控制器直通"><a href="#磁盘控制器直通" class="headerlink" title="磁盘控制器直通"></a>磁盘控制器直通</h4><p>通常硬盘都是连接到硬盘控制器（Nvme硬盘除外，因为本来就是个PCI-E设备），由硬盘控制器管理。因此直通了磁盘控制器，就会让磁盘控制器下的所有硬盘间接直通到虚拟机</p><p>通过这种方式，硬盘会在虚拟机内会认为是一个物理磁盘，可以获得全部的磁盘属性，如SMART信息</p><p>NAS推荐这种方案，如果不想购买直通卡的话，可以将系统安装到NVME硬盘或USB外置移动硬盘中，然后直通主板SATA控制器给NAS虚拟机</p><p><strong>直通方法</strong></p><p>磁盘控制器直通，需要开启iommu，可以到网页中添加，q35注意勾选PCI-Express</p><h3 id="8、网卡直通"><a href="#8、网卡直通" class="headerlink" title="8、网卡直通"></a>8、网卡直通</h3><p>同PCI设备直通，但请勿直通PVE管理网口的网卡</p><p>I350-T4网卡，开启PCIe桥的ACS特性，可以直通每个网口给不同虚拟机（1对1），如需要直通一个网口给多个虚拟机（1对多），不使用软交换，需要使用到SR-IOV</p><h4 id="Intel-I350-T4-SR-IOV"><a href="#Intel-I350-T4-SR-IOV" class="headerlink" title="Intel I350-T4 SR-IOV"></a>Intel I350-T4 SR-IOV</h4><p>测试环境：</p><ul><li>i5-6500</li><li>华硕Z170-P</li><li>Winyao I350-T4</li></ul><p>参考：<a href="http://www.taodudu.cc/news/show-4764419.html">http://www.taodudu.cc/news/show-4764419.html</a></p><p><strong>查询相关信息</strong></p><p>查看网卡功能：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">lspci <span class="token parameter variable">-s</span> 01:00 <span class="token parameter variable">-v</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>root@pve:~#  lspci -s 01:00 -v<br>01:00.0 Ethernet controller: Intel Corporation I350 Gigabit Network Connection (rev 01)<br>        Subsystem: Device 1d1a:0000<br>        Flags: bus master, fast devsel, latency 0, IRQ 16, IOMMU group 12<br>        Memory at c8000000 (32-bit, non-prefetchable) [size&#x3D;1M]<br>        Memory at c8600000 (32-bit, non-prefetchable) [size&#x3D;16K]<br>        Expansion ROM at c8400000 [disabled] [size&#x3D;512K]<br>        Capabilities: [40] Power Management version 3<br>        Capabilities: [50] MSI: Enable- Count&#x3D;1&#x2F;1 Maskable+ 64bit+<br>        Capabilities: [70] MSI-X: Enable+ Count&#x3D;10 Masked-<br>        Capabilities: [a0] Express Endpoint, MSI 00<br>        Capabilities: [100] Advanced Error Reporting<br>        Capabilities: [140] Device Serial Number 2c-53-4a-ff-ff-05-bd-42<br>        Capabilities: [150] Alternative Routing-ID Interpretation (ARI)<br>        <strong>Capabilities: [160] Single Root I&#x2F;O Virtualization (SR-IOV)</strong><br>        Capabilities: [1a0] Transaction Processing Hints<br>        Capabilities: [1c0] Latency Tolerance Reporting<br>        Capabilities: [1d0] Access Control Services<br>        <strong>Kernel driver in use: igb</strong><br>        <strong>Kernel modules: igb</strong></p><p>01:00.1 Ethernet controller: Intel Corporation I350 Gigabit Network Connection (rev 01)<br>……</p><p>01:00.2 Ethernet controller: Intel Corporation I350 Gigabit Network Connection (rev 01)<br>……</p><p>01:00.3 Ethernet controller: Intel Corporation I350 Gigabit Network Connection (rev 01)<br>……</p></blockquote><ul><li>**Capabilities: [160] Single Root I&#x2F;O Virtualization (SR-IOV)**：支持SR-IOV<ul><li>如果没有这个，说明不支持SR-IOV，如果硬件确实支持，而系统没有识别，请更新网卡固件</li></ul></li><li><strong>Kernel driver in use: igb</strong>、<strong>Kernel modules: igb</strong>：使用<code>igb</code>驱动</li></ul><p>查看网卡名称：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ip</span> l<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>root@pve:~# ip l<br>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000<br>    link&#x2F;loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br>2: enp6s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master vmbr0 state UP mode DEFAULT group default qlen 1000<br>    link&#x2F;ether 38:d5:47:10:d3:4f brd ff:ff:ff:ff:ff:ff<br>3: <strong>enp1s0f0</strong>: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000<br>    link&#x2F;ether 2c:53:4a:05:bd:42 brd ff:ff:ff:ff:ff:ff<br>4: <strong>enp1s0f1</strong>: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000<br>    link&#x2F;ether 2c:53:4a:05:bd:43 brd ff:ff:ff:ff:ff:ff<br>5: <strong>enp1s0f2</strong>: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000<br>    link&#x2F;ether 2c:53:4a:05:bd:44 brd ff:ff:ff:ff:ff:ff<br>6: <strong>enp1s0f3</strong>: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000<br>    link&#x2F;ether 2c:53:4a:05:bd:45 brd ff:ff:ff:ff:ff:ff<br>7: vmbr0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000<br>    link&#x2F;ether 38:d5:47:10:d3:4f brd ff:ff:ff:ff:ff:ff</p></blockquote><p>查看网卡固件版本：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ethtool</span> <span class="token parameter variable">-i</span> <span class="token operator">&lt;</span>网卡名称<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>root@pve:~# ethtool -i enp1s0f0<br>driver: igb<br>version: 6.2.11-1-pve<br><strong>firmware-version: 0.93, 0x800005fd</strong><br>expansion-rom-version:<br>bus-info: 0000:01:00.0<br>supports-statistics: yes<br>supports-test: yes<br>supports-eeprom-access: yes<br>supports-register-dump: yes<br>supports-priv-flags: yes</p></blockquote><p>经过查询，说是需要升级固件版本到15.x以上，但看淘宝详情页说支持SR-IOV，原来在ESXI里面也启用过，杂牌网卡不敢乱搞，所以没有升级</p><p><strong>开启网卡设备SR-IOV</strong></p><p>进入设备目录</p><p>PCI：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /sys/bus/pci/devices/<span class="token operator">&lt;</span>PCI地址，如0000:01:00.<span class="token operator"><span class="token file-descriptor important">0</span>></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>或网卡名称</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /sys/class/net/<span class="token operator">&lt;</span>网卡名称，如enp1s0f<span class="token operator"><span class="token file-descriptor important">0</span>></span>/device<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>获取最大vf数量</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> sriov_totalvfs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>root@pve:&#x2F;sys&#x2F;bus&#x2F;pci&#x2F;devices&#x2F;0000:01:00.0# cat sriov_totalvfs<br>7</p></blockquote><p>回显数量是7，说明支持开启7个vf</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token number">7</span> <span class="token operator">></span> sriov_numvfs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>root@pve:&#x2F;sys&#x2F;bus&#x2F;pci&#x2F;devices&#x2F;0000:01:00.0# echo 7 &gt; sriov_numvfs<br>-bash: echo: 写错误: 无法分配内存</p></blockquote><p><strong>第二种方法</strong></p><p>我这边没有成功，提示“无法分配内存”，需要修改modprobe，或直接修改grub启动选项，参考第二种方法：</p><blockquote><p>参考：<a href="https://www.bilibili.com/video/av338824462">https://www.bilibili.com/video/av338824462</a></p><p>sr-iov在pve下的配置，主要配置有&#x2F;etc&#x2F;default&#x2F;grub添加的内容如下，有千兆与万兆区别：</p><ul><li>ixgbe模块：intel_iommu&#x3D;on,igfx_off iommu&#x3D;pt pcie_acs_override&#x3D;downstream,multifunction ixgbe.max_vfs&#x3D;10 pci&#x3D;realloc,assign-busses</li><li>igb模块：intel_iommu&#x3D;on,igfx_off iommu&#x3D;pt pcie_acs_override&#x3D;downstream,multifunction igb.max_vfs&#x3D;7 pci&#x3D;realloc,assign-busses</li></ul></blockquote><p>实际上，根据本文前面的配置，只需要追加：<code>pcie_acs_override=downstream,multifunction igb.max_vfs=7 pci=realloc,assign-busses</code>，关于<code>pci=realloc,assign-busses</code>：</p><blockquote><p>有的老主板没有SR-IOV选项的，需要传内核参数处理PCI，例如pci&#x3D;assign-busses,有些第三方光模块可能还需要pci&#x3D;realloc，如果2个都需要处理，那么就写成pci&#x3D;realloc,assign-busses</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/default/grub<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>GRUB_CMDLINE_LINUX_DEFAULT&#x3D;”quiet intel_iommu&#x3D;on iommu&#x3D;pt i915.enable_gvt&#x3D;1 pcie_acs_override&#x3D;downstream,multifunction igb.max_vfs&#x3D;7 pci&#x3D;realloc,assign-busses”</p></blockquote><p>然后更新一下grub和内核的配置，重启</p><p><strong>遇到问题</strong></p><p>重启后，我这边管理口的网卡名称变了，导致外部连不上PVE，还好之前给PVE装了LXDE和Firefox，通过PVE机器的Firefox重新调整了一下网卡设置才恢复，如果没有安装浏览器，需要手动更换绑定vmbr0的网卡</p><p>参考：<a href="https://wiki.debian.org/NetworkConfiguration">https://wiki.debian.org/NetworkConfiguration</a></p><p>由于PVE没有使用NetworkManager等现代组件管理网络，而是使用ifupdown2，所以只需编辑：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/network/interfaces<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>（待测）如果需要PVE支持DHCPv6，可以加上</p><blockquote><p>iface vmbr0 inet6 dhcp</p></blockquote></blockquote><p><strong>最终结果</strong></p><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250508/99682/33/34450/261001/6459fadaF723d6cb1/dc00e3e929b060c9.png"></p><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250508/119136/7/33704/243019/6459fb0bFb82981d3/92b7ac2ae1ab324d.png"></p><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250508/62014/10/20154/571954/6459fb5aF74f10be9/242cfbd428ab1c0b.png"></p><p>另外需要注意，这个网卡的PCI地址并不是按照网卡顺序来的，需要使用以下命令查看VF对应的PF：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">lshw <span class="token parameter variable">-class</span> net <span class="token parameter variable">-businfo</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>还有，调整完VF的数量以后，还需要使用上述命令重新查看网卡PCI地址，调整各个VM的网卡PCI地址</p><p>此外，对于网卡MAC地址的固化，目前本人没有研究过，请自行百度</p><p>参考：<a href="https://foxi.buduanwang.vip/yj/561.html">https://foxi.buduanwang.vip/yj/561.html</a></p><h2 id="四、进阶玩法"><a href="#四、进阶玩法" class="headerlink" title="四、进阶玩法"></a>四、进阶玩法</h2><h3 id="1、安装LXDE桌面环境"><a href="#1、安装LXDE桌面环境" class="headerlink" title="1、安装LXDE桌面环境"></a>1、安装LXDE桌面环境</h3><p>安装图形界面，方便管理，家庭用户建议安装</p><h4 id="设置locale"><a href="#设置locale" class="headerlink" title="设置locale"></a>设置locale</h4><p>添加 locale <code>zh_CN.UTF-8 UTF-8</code>，设定默认 locale 为中文<code>zh_CN.UTF-8</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">dpkg-reconfigure locales<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="安装LXDE"><a href="#安装LXDE" class="headerlink" title="安装LXDE"></a>安装LXDE</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> <span class="token function">install</span> lxde-core lxterminal fonts-noto-cjk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="安装常用软件"><a href="#安装常用软件" class="headerlink" title="安装常用软件"></a>安装常用软件</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> <span class="token function">install</span> firefox-esr firefox-esr-l10n-zh-cn synaptic remmina virt-viewer<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><input checked="" disabled="" type="checkbox"> firefox-esr：火狐长期支持版<ul><li><input checked="" disabled="" type="checkbox"> firefox-esr-l10n-zh-cn：火狐长期支持版中文语言包</li></ul></li><li><input checked="" disabled="" type="checkbox"> synaptic：新立得软件包管理器</li><li><input checked="" disabled="" type="checkbox"> remmina：远程桌面</li><li><input checked="" disabled="" type="checkbox"> virt-viewer：spice远程桌面客户端</li><li><input disabled="" type="checkbox"> mousepad：xfce默认文本编辑器</li></ul><h5 id="安装中文拼音输入法"><a href="#安装中文拼音输入法" class="headerlink" title="安装中文拼音输入法"></a>安装中文拼音输入法</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> <span class="token function">install</span> fcitx5 fcitx5-chinese-addons fcitx5-frontend-gtk3 fcitx5-frontend-qt5 fcitx5-module-xorg im-config<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>以上的包会占用1.5GB左右空间，系统运行时内存占用不到100MB</p><blockquote><p>BUG：LXDE如果安装了完整版，需要禁用connman，不然会与PVE冲突，造成断网</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl stop connmansystemctl disable connman<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></blockquote><h4 id="添加非root用户"><a href="#添加非root用户" class="headerlink" title="添加非root用户"></a>添加非root用户</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">useradd</span> <span class="token parameter variable">-m</span> user <span class="token parameter variable">-s</span> /bin/bash <span class="token parameter variable">-d</span> /home/user<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="设置用户密码"><a href="#设置用户密码" class="headerlink" title="设置用户密码"></a>设置用户密码</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">passwd</span> user <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="完成后重启"><a href="#完成后重启" class="headerlink" title="完成后重启"></a>完成后重启</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">reboot</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="（不建议）安装WPS"><a href="#（不建议）安装WPS" class="headerlink" title="（不建议）安装WPS"></a>（不建议）安装WPS</h4><p>Firefox访问：<a href="https://linux.wps.cn/">https://linux.wps.cn/</a> ，下载对应架构最新WPS Office For Linux Deb格式安装包</p><pre class="line-numbers language-none"><code class="language-none">cd ~&#x2F;下载sudo dpkg -i wps-office_11.1.0.11698_amd64.debsudo apt --fix-broken install<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="（不建议）安装docker"><a href="#（不建议）安装docker" class="headerlink" title="（不建议）安装docker"></a>（不建议）安装docker</h4><p>不建议在宿主机上直接安装docker，会给后面网络配置带来麻烦。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> <span class="token function">install</span> docker.io<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="安装Portainer-CE"><a href="#安装Portainer-CE" class="headerlink" title="安装Portainer CE"></a>安装Portainer CE</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> volume create portainer_data<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">8000</span>:8000 <span class="token parameter variable">-p</span> <span class="token number">9443</span>:9443 <span class="token parameter variable">--name</span> portainer <span class="token parameter variable">--restart</span><span class="token operator">=</span>always <span class="token parameter variable">-v</span> /var/run/docker.sock:/var/run/docker.sock <span class="token parameter variable">-v</span> portainer_data:/data portainer/portainer-ce:latest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="设置开机自启项目"><a href="#设置开机自启项目" class="headerlink" title="设置开机自启项目"></a>设置开机自启项目</h4><p>开始菜单&#x3D;&gt;首选项&#x3D;&gt;LXSession 默认应用程序&#x3D;&gt;自动启动</p><p>手动设为自动启动的程序：</p><ol><li>取消<code>@xscreensaver</code>关闭屏保</li><li>添加<code>@firefox-esr -kiosk -private-window https://127.0.0.1:8006</code>自动打开Proxmox VE Web后台</li><li>添加<code>@xfreerdp /v:&lt;RDP主机地址&gt; /u:&lt;RDP用户&gt; /p:&lt;RDP密码&gt; /audio /gfx:AVC420 /f </code>自动打开RDP远程桌面</li></ol><h4 id="（不建议）Lightdm-openbox自定义桌面环境"><a href="#（不建议）Lightdm-openbox自定义桌面环境" class="headerlink" title="（不建议）Lightdm + openbox自定义桌面环境"></a>（不建议）Lightdm + openbox自定义桌面环境</h4><p><strong>大小差不多，建议直接LXDE</strong></p><p>中文环境配置，添加locale为zh_CN.UTF-8 UTF-8，设定默认 locale 为中文zh_CN.UTF-8：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">dpkg-reconfigure locales<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>安装 Lightdm 桌面管理器及相关字体：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> <span class="token function">install</span> lightdm openbox fonts-noto-cjk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>安装GUI常用工具：</p><pre class="line-numbers language-none"><code class="language-none">apt install lxterminal firefox-esr firefox-esr-l10n-zh-cn synaptic<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>创建用户：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">useradd</span> <span class="token parameter variable">-m</span> user <span class="token parameter variable">-s</span> /bin/bash <span class="token parameter variable">-d</span> /home/user<span class="token function">passwd</span> user<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>创建用户组：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">groupadd</span> <span class="token parameter variable">-r</span> autologingpasswd <span class="token parameter variable">-a</span> user autologin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>配置自动登录：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vi</span> /etc/lightdm/lightdm.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Seat:*</span><span class="token punctuation">]</span></span><span class="token key attr-name">user-session</span><span class="token punctuation">=</span><span class="token value attr-value">openbox</span><span class="token key attr-name">autologin-user</span><span class="token punctuation">=</span><span class="token value attr-value">user</span><span class="token key attr-name">autologin-session</span><span class="token punctuation">=</span><span class="token value attr-value">openbox</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>配置 openbox 的启动项：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> ~/.config/openbox<span class="token function">cp</span> <span class="token parameter variable">-a</span> /etc/xdg/openbox/ ~/.config/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><a href="https://blog.csdn.net/whyliu_/article/details/124017844">https://blog.csdn.net/whyliu_/article/details/124017844</a></p><p><a href="https://www.404bugs.com/details/1077554175264215040">https://www.404bugs.com/details/1077554175264215040</a></p><h3 id="2、PVE查找硬盘文件位置"><a href="#2、PVE查找硬盘文件位置" class="headerlink" title="2、PVE查找硬盘文件位置"></a>2、PVE查找硬盘文件位置</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@pve:~<span class="token comment"># pvesm path local:123/vm-123-disk-0.qcow2</span>/var/lib/vz/images/123/vm-123-disk-0.qcow2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="3、内核管理"><a href="#3、内核管理" class="headerlink" title="3、内核管理"></a>3、内核管理</h3><p>直通报错？尝试换个内核！</p><h4 id="查看已安装内核"><a href="#查看已安装内核" class="headerlink" title="查看已安装内核"></a>查看已安装内核</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">dpkg --get-selections <span class="token operator">|</span><span class="token function">grep</span> kernel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="查看当前内核"><a href="#查看当前内核" class="headerlink" title="查看当前内核"></a>查看当前内核</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">uname</span> <span class="token parameter variable">-a</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="查找内核"><a href="#查找内核" class="headerlink" title="查找内核"></a>查找内核</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> search pve-kernel<span class="token operator">|</span><span class="token function">grep</span> pve-kernel-<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt-cache</span> search linux <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'PVE Kernel Image'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="安装内核"><a href="#安装内核" class="headerlink" title="安装内核"></a>安装内核</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> <span class="token function">install</span> pve-kernel-5.13.19-4-pve<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="查看当前系统内核启动顺序"><a href="#查看当前系统内核启动顺序" class="headerlink" title="查看当前系统内核启动顺序"></a>查看当前系统内核启动顺序</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">grep</span> menuentry /boot/grub/grub.cfg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="修改内核启动顺序"><a href="#修改内核启动顺序" class="headerlink" title="修改内核启动顺序"></a>修改内核启动顺序</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nano</span> /etc/default/grub<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>把默认的<code>GRUB_DEFAULT=“0”</code>改为</p><blockquote><p>GRUB_DEFAULT&#x3D;”Advanced options for Proxmox VE GNU&#x2F;Linux&gt;Proxmox VE GNU&#x2F;Linux, with Linux 5.13.19-4-pve”</p></blockquote><p>更新引导并重启</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">update-grub</span><span class="token function">reboot</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="4、虚拟内存"><a href="#4、虚拟内存" class="headerlink" title="4、虚拟内存"></a>4、虚拟内存</h3><h4 id="创建SWAP文件"><a href="#创建SWAP文件" class="headerlink" title="创建SWAP文件"></a>创建SWAP文件</h4><p>创建一个16G的swap，bs * count &#x3D;16G</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span>/swapfile <span class="token assign-left variable">bs</span><span class="token operator">=</span>1G <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">16</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>注意，这个swapfile存放在根目录下</p></blockquote><p>配置安全的权限</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">chmod</span> 0600 /swapfile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>格式化成swap</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkswap</span> /swapfile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>挂载swap</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">swapon</span> /swapfile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>验证</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">free</span> <span class="token parameter variable">-h</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="Swap策略"><a href="#Swap策略" class="headerlink" title="Swap策略"></a>Swap策略</h4><h5 id="临时调整swap策略"><a href="#临时调整swap策略" class="headerlink" title="临时调整swap策略"></a>临时调整swap策略</h5><p>方法1:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@PVE ~<span class="token punctuation">]</span><span class="token comment"># sysctl vm.swappiness=10</span>vm.swappiness <span class="token operator">=</span> <span class="token number">10</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>方法2:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@PVE ~<span class="token punctuation">]</span><span class="token comment"># echo 10 > /proc/sys/vm/swappiness</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="永久更改swappiness值"><a href="#永久更改swappiness值" class="headerlink" title="永久更改swappiness值"></a>永久更改swappiness值</h5><p>要想永久调整的话，需要在&#x2F;etc&#x2F;sysctl.conf修改，加上：</p><blockquote><p>vm.swappiness&#x3D;10</p></blockquote><p>验证</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@PVE ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/sysctl.conf</span><span class="token assign-left variable">vm.swappiness</span><span class="token operator">=</span><span class="token number">10</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>激活设置</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@PVE ~<span class="token punctuation">]</span><span class="token comment"># sysctl -p</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="5、PXE网启文件制作"><a href="#5、PXE网启文件制作" class="headerlink" title="5、PXE网启文件制作"></a>5、PXE网启文件制作</h3><p>这里只记录文件制作，具体怎么使用网启、怎样配置DHCP服务器，不在本篇暂不讨论，最多附一下编译 iPXE 所用到的软件包：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> gcc binutils <span class="token function">make</span> perl <span class="token function">mtools</span> <span class="token function">mkisofs</span> syslinux liblzma-dev isolinux<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>参考：<a href="https://github.com/morph027/pve-iso-2-pxe">https://github.com/morph027/pve-iso-2-pxe</a></p><p>首先需要准备一台 Linux 机器，建议使用 Debian 环境</p><p>获取脚本：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> <span class="token parameter variable">-O</span> pve-iso-2-pxe.sh https://ghproxy.com/https://raw.githubusercontent.com/morph027/pve-iso-2-pxe/master/pve-iso-2-pxe.sh<span class="token function">chmod</span> +x pve-iso-2-pxe.sh <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>安装相关软件包：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> cpio <span class="token function">file</span> zstd <span class="token function">gzip</span> genisoimage<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>下载最新ISO：</p><p><a href="http://proxmox.com/downloads">http://proxmox.com/downloads</a></p><p><a href="http://mirrors.ustc.edu.cn/proxmox/iso/">http://mirrors.ustc.edu.cn/proxmox/iso/</a></p><p>以ISO文件路径为参数，运行 <code>pve-iso-2-pxe.sh</code> 脚本：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>user㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/桌面<span class="token punctuation">]</span>└─$ <span class="token function">bash</span> pve-iso-2-pxe.sh proxmox-ve_7.4-1.iso<span class="token comment">#########################################################################################################</span><span class="token comment"># Create PXE bootable Proxmox image including ISO                                                       #</span><span class="token comment">#                                                                                                       #</span><span class="token comment"># Author: mrballcb @ Proxmox Forum (06-12-2012)                                                         #</span><span class="token comment"># Thread: http://forum.proxmox.com/threads/8484-Proxmox-installation-via-PXE-solution?p=55985#post55985 #</span><span class="token comment"># Modified: morph027 @ Proxmox Forum (23-02-2015) to work with 3.4                                      #</span><span class="token comment">#########################################################################################################</span>Using proxmox-ve_7.4-1.iso<span class="token punctuation">..</span>.extracting kernel<span class="token punctuation">..</span>.extracting initrd<span class="token punctuation">..</span>.adding iso <span class="token function">file</span> <span class="token punctuation">..</span>.<span class="token number">2193089</span> 块Finished<span class="token operator">!</span> pxeboot files can be found <span class="token keyword">in</span> /home/user/桌面.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>此时，ISO文件的同级目录会创建一个 <code>pxeboot</code> 文件夹，里面包含 <code>linux26</code> 和 <code>initrd</code> 两个文件</p><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/0f05676a25129a0a0b5b3073b0e409a7.png"></p><p>我们将它们上传到文件下载服务器，然后使用以下 iPXE 脚本进行引导：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#!ipxe</span>dhcp<span class="token builtin class-name">set</span> webserver http://10.0.2.1:5244/d/Cloud/System/Linux/VMmenu Please choose a version to bootitem <span class="token number">7</span>.X Proxmox-VE <span class="token number">7</span>.Xitem <span class="token number">6</span>.X Proxmox-VE <span class="token number">6</span>.Xitem <span class="token number">5</span>.X Proxmox-VE <span class="token number">5</span>.Xchoose <span class="token parameter variable">--default</span> <span class="token number">7</span>.X <span class="token parameter variable">--timeout</span> <span class="token number">5000</span> target <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">set</span> pveversion <span class="token variable">$&#123;target&#125;</span>menu Please choose an operating system to bootitem normal Install Proxmox-VE <span class="token variable">$&#123;pveversion&#125;</span>item debug Install Proxmox-VE <span class="token variable">$&#123;pveversion&#125;</span> <span class="token punctuation">(</span>Debug Mode<span class="token punctuation">)</span>choose <span class="token parameter variable">--default</span> normal <span class="token parameter variable">--timeout</span> <span class="token number">5000</span> target <span class="token operator">&amp;&amp;</span> goto <span class="token variable">$&#123;target&#125;</span>:debuginitrd <span class="token variable">$&#123;webserver&#125;</span>/proxmox/<span class="token variable">$&#123;pveversion&#125;</span>/initrdchain <span class="token variable">$&#123;webserver&#125;</span>/proxmox/<span class="token variable">$&#123;pveversion&#125;</span>/linux26 <span class="token assign-left variable">vga</span><span class="token operator">=</span><span class="token number">791</span> <span class="token assign-left variable">video</span><span class="token operator">=</span>vesafb:ywrap,mtrr <span class="token assign-left variable">ramdisk_size</span><span class="token operator">=</span><span class="token number">16777216</span> rw quiet <span class="token assign-left variable">initrd</span><span class="token operator">=</span>initrd <span class="token assign-left variable">splash</span><span class="token operator">=</span>verbose proxdebuggoto end:normalinitrd <span class="token variable">$&#123;webserver&#125;</span>/proxmox/<span class="token variable">$&#123;pveversion&#125;</span>/initrdchain <span class="token variable">$&#123;webserver&#125;</span>/proxmox/<span class="token variable">$&#123;pveversion&#125;</span>/linux26 <span class="token assign-left variable">vga</span><span class="token operator">=</span><span class="token number">791</span> <span class="token assign-left variable">video</span><span class="token operator">=</span>vesafb:ywrap,mtrr <span class="token assign-left variable">ramdisk_size</span><span class="token operator">=</span><span class="token number">16777216</span> rw quiet <span class="token assign-left variable">initrd</span><span class="token operator">=</span>initrd <span class="token assign-left variable">splash</span><span class="token operator">=</span>silentgoto end:end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>注意要点：</strong></p><ul><li><p>推荐文件服务器使用 Alist 本地挂载，尽量别用 Tiny PXE Server 的龟速 HTTPd（有些时候比 TFTP 还慢）；</p></li><li><p>不要使用 HTTPS 协议的文件服务器或 HTTPS 协议的网盘的转链，如有必要必须使用 HTTPS，请在编译 iPXE 前编辑 <code>ipxe/src/config/general.h</code> ，将 <code>#undef DOWNLOAD_PROTO_HTTPS</code> 改为 <code>#define DOWNLOAD_PROTO_HTTPS</code>；</p></li><li><p>路径中请勿包含空格；</p></li><li><p>请勿使用引号 <code>&quot;</code> 对启动参数进行引用（原文中的脚本是无法使用的，一定要写死）</p></li><li><p>如果一直卡在<code>............</code>，或提示 <code>Operation not supported</code>，说明 iPXE 下载错误（通常 <code>initrd</code> 文件在 1GB 以上，下载那么快肯定不正常），请检查服务器是否被正确搭建，iPXE 是否正确开启 HTTPS 支持</p></li></ul><p><strong>效果展示：</strong></p><p><img src="https://img03.mifile.cn/v1/MI_542ED8B1722DC/e5136a74571545be54fc142419483b45.png" alt="版本号选择"></p><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/406e336d5702df5f5540fd83ea1ad881.png" alt="启动模式选择"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/9507d3122276154e247a4dd8a283b0a6.png" alt="iPXE HTTP协议下载"></p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/50f374bc5a34876b9f0beb72feec92eb.png" alt="PVE 7.4实测可用"></p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/f508cb90a775c2fa2fefe9dcf1fdaebc.png" alt="虚拟机内测试"></p>]]></content>
      
      
      <categories>
          
          <category> 服务器运维 </category>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Debian </tag>
            
            <tag> Proxmox VE </tag>
            
            <tag> PVE </tag>
            
            <tag> 虚拟机 </tag>
            
            <tag> 虚拟化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Arch Linux 安装</title>
      <link href="/posts/arch-linux-install.html"/>
      <url>/posts/arch-linux-install.html</url>
      
        <content type="html"><![CDATA[<h1 id="Arch-Linux-安装"><a href="#Arch-Linux-安装" class="headerlink" title="Arch Linux 安装"></a>Arch Linux 安装</h1><p>个人整理笔记，目前仅供自用，不断修正中</p><p>本人认为 Arch Linux 只是个玩具，安装 Arch Linux 只为学习 Linux 系统结构（表示非常馋<a href="https://wiki.archlinuxcn.org/wiki/%E9%A6%96%E9%A1%B5">ArchWikiCN</a>，许多关于Linux的问题都可以在里面得到全面解答），一般建议体验 Arch Linux 直接使用 manjaro，正式环境如网站服务器还是用<del>CentOS(寄)、</del>Debian 靠谱些，有官方deb包可以直接装，Arch Linux 也没自由到哪里去</p><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>一定要明确你是以怎样的方式引导Arch Linux</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ls</span> /sys/firmware/efi/efivars<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>UEFI Boot会输出一堆东西（<code>efi</code> 变量），Legacy Boot会报错</p><h3 id="联网"><a href="#联网" class="headerlink" title="联网"></a>联网</h3><p><strong>安装过程要求必须连接到互联网！！！</strong></p><h4 id="连网线"><a href="#连网线" class="headerlink" title="连网线"></a>连网线</h4><p>自动连接，无需配置</p><h4 id="连WiFi"><a href="#连WiFi" class="headerlink" title="连WiFi"></a>连WiFi</h4><p>使用 <code>iwctl</code> 进行连接：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">iwctl <span class="token comment"># 进入交互式命令行</span>device list <span class="token comment"># 列出无线网卡设备名，比如无线网卡看到叫 wlan0</span>station wlan0 scan <span class="token comment"># 扫描网络</span>station wlan0 get-networks <span class="token comment"># 列出所有 wifi 网络</span>station wlan0 connect wifi-name <span class="token comment"># 进行连接，注意这里无法输入中文。回车后输入密码即可</span><span class="token builtin class-name">exit</span> <span class="token comment"># 连接成功后退出</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>若无线网卡无法显示，请参考：</p><p><a href="https://wiki.archlinuxcn.org/wiki/%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE#%E6%A3%80%E6%9F%A5%E8%AE%BE%E5%A4%87%E7%8A%B6%E6%80%81">https://wiki.archlinuxcn.org/wiki/网络配置/无线网络配置#检查设备状态</a></p></blockquote><h4 id="显示IP地址"><a href="#显示IP地址" class="headerlink" title="显示IP地址"></a>显示IP地址</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ip</span> a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果有显示，说明已经通过DHCP获取到ip地址</p><h4 id="测试网络连通性"><a href="#测试网络连通性" class="headerlink" title="测试网络连通性"></a>测试网络连通性</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ping</span> www.aliyun.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="校时"><a href="#校时" class="headerlink" title="校时"></a>校时</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">timedatectl set-timezone Asia/Shanghaitimedatectl statustimedatectl set-ntp <span class="token boolean">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="Linux须知"><a href="#Linux须知" class="headerlink" title="Linux须知"></a>Linux须知</h3><h4 id="文件系统和用户"><a href="#文件系统和用户" class="headerlink" title="文件系统和用户"></a>文件系统和用户</h4><ol><li><p>Linux系统下，不存在C盘、D盘、E盘，所有的硬件软件都是以文件形式存在的，最上层的目录是根目录，路径为 <code>/</code> ，并以一个树形结构从此向下一级一级区分，包括分区，如&#x2F;dev&#x2F;sda1，即第a块硬盘的第1个分区，而且不存在&#x2F;dev&#x2F;sda1&#x2F;…&#x2F;的，读取分区需要将其挂载到文件夹，如mount &#x2F;dev&#x2F;sda1 &#x2F;mnt</p></li><li><p>对于 Linux 的树形文件结构，存在相对路径与绝对路径之分：</p><ul><li>绝对路径代表从根目录 <code>/</code> 开始的完整路径：<ul><li>比如 <code>/home/myusername/Download</code></li></ul></li><li>相对路径代表从当前目录或当前目录的上级目录，到目标目录的一个部分路径：<ul><li><code>.</code> 代表当前目录</li><li><code>..</code> 代表当前目录的上级目录</li><li>比如当前你所在的目录为 <code>/home/myusername</code> ，那么绝对路径下的 <code>/home/myusername/Download</code> 文件夹的相对路径即为 <code>./Download</code></li><li>比如你当前所在的路径为 <code>/home/myusername/Download</code> ，向上寻找到 <code>/home/myusername/Desktop</code> 的相对路径即为 <code>../Desktop</code></li></ul></li></ul></li><li><p>简单来说，Linux 中存在两类用户：</p><ul><li><p>第一类用户即为 root 用户，也称为超级用户，它拥有系统中最高的权限</p></li><li><p>第二类用户就是除了 root 用户之外的普通用户，它们可以拥有不同等级的权限</p><p>使用 root 权限时需要十分小心</p></li></ul></li><li><p>理论上来说，任何图形化界面中的操作都可以用对应的命令行命令完成。如果你打开某个程序报错，不妨试试找到它的对应启动命令，在终端中执行此命令，并观察它运行时的错误日志输出，查阅相关资料，解决问题</p></li></ol><h4 id="终端操作基础"><a href="#终端操作基础" class="headerlink" title="终端操作基础"></a>终端操作基础</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ls</span> /some_path <span class="token comment"># 查看某个文件夹下的文件与子文件夹。/ 代表根目录，是 Linux 最顶端的路径，以此开头则为绝对路径</span><span class="token builtin class-name">pwd</span> <span class="token comment"># 查看当前终端所在路径</span><span class="token builtin class-name">cd</span> /home/testuser <span class="token comment"># 切换目录命令。将当前终端切换到某一个路径下</span><span class="token function">cp</span> ./a.py ./b.py <span class="token comment"># 复制命令。将当前路径下的 a.py 复制一份并命名为 b.py。./ 代表当前文件夹所在路径，以此开头则为相对路径</span><span class="token function">cp</span> <span class="token parameter variable">-r</span> ./a ./b <span class="token comment"># 复制整体文件夹</span><span class="token function">rm</span> b.py <span class="token comment"># 删除命令。删除 b.py</span><span class="token function">mv</span> a.py b.py <span class="token comment"># 移动（重命名）命令。将 a.py 更名为 b.py</span><span class="token function">mkdir</span> my_folder <span class="token comment"># 新建名为 my_folder 的文件夹</span><span class="token function">sudo</span> some_command <span class="token comment"># 使普通用户以 root 权限执行某些命令</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>参考：<a href="https://archlinuxstudio.github.io/ShellTutorial/#/">Linux 命令行与 Shell 脚本教程</a></p><h4 id="vim-的使用"><a href="#vim-的使用" class="headerlink" title="vim 的使用"></a>vim 的使用</h4><p>我们需要掌握一个能在终端中进行文本编辑的软件，这里介绍 vim。</p><p>创建并编辑名为 <code>hello.txt</code> 的文件：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> hello.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>此时可以看到进入了一个空的界面：</p><ul><li>此时处在 vim 的 <code>命令模式</code> 。在 <code>命令模式</code> 下，可以用一些快捷指令来对文本进行操作</li><li>输入 <code>a</code> 进入 vim 的 <code>编辑模式</code> ，此时即可输入任意文本进行编辑</li><li>在输入完成后按下 Esc 键，即可从 <code>编辑模式</code> 退出到 <code>命令模式</code> 。此时输入 <code>:wq</code> 即可保存并退出 vim</li></ul><p>下面介绍一些在命令模式下常用的命令：</p><ul><li><code>:wq</code> —— 保存退出</li><li><code>:q!</code> —— 不保存，强制退出</li><li><code>dd</code> —— 删除一行</li><li><code>2dd</code> —— 删除两行</li><li><code>gg</code> —— 回到文本第一行</li><li><code>shift</code> + <code>g</code> —— 转到文本最后一行</li><li><code>/xxx</code> —— 在文中搜索 xxx 内容。回车 <code>Enter</code> 搜索，按 <code>n</code> 键转到下一个</li><li><code>?xxx</code> —— 反向搜索</li></ul><p>可以在终端中输入以下命令来学习完整的 vim 教程：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">vimtutor<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="系统服务的介绍与操作"><a href="#系统服务的介绍与操作" class="headerlink" title="系统服务的介绍与操作"></a>系统服务的介绍与操作</h4><p>Linux 系统中运行着各种服务，你需要掌握查询，变更服务状态的方式。同时对创建服务最好也有大致的了解。</p><p>这里讲述命令 <code>systemctl</code> 的用法。以 <code>dhcpcd</code> 服务为例：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl start dhcpcd <span class="token comment"># 启动服务</span>systemctl stop dhcpcd <span class="token comment"># 停止服务</span>systemctl restart dhcpcd <span class="token comment"># 重启服务</span>systemctl reload dhcpcd <span class="token comment"># 重新加载服务以及它的配置文件</span>systemctl status dhcpcd <span class="token comment"># 查看服务状态</span>systemctl <span class="token builtin class-name">enable</span> dhcpcd <span class="token comment"># 设置开机启动服务</span>systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> dhcpcd <span class="token comment"># 设置服务为开机启动并立即启动这个单元</span>systemctl disable dhcpcd <span class="token comment"># 取消开机自动启动</span>systemctl daemon-reload dhcpcd <span class="token comment"># 重新载入 systemd 配置。扫描新增或变更的服务单元、不会重新加载变更的配置</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>参考：</p><p><a href="https://wiki.archlinux.org/index.php/Systemd#Basic_systemctl_usage">https://wiki.archlinux.org/index.php/Systemd#Basic_systemctl_usage</a></p><p><a href="https://www.freedesktop.org/software/systemd/man/systemd.service.html#Examples">https://www.freedesktop.org/software/systemd/man/systemd.service.html#Examples</a></p><h2 id="分区"><a href="#分区" class="headerlink" title="分区"></a>分区</h2><h3 id="查看硬盘"><a href="#查看硬盘" class="headerlink" title="查看硬盘"></a>查看硬盘</h3><p><code>lsblk</code> 或</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">fdisk</span> <span class="token parameter variable">-l</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这里我们的硬盘是&#x2F;dev&#x2F;sda，<strong>一定要看清楚你的盘到底是哪块，请勿无脑复制粘贴，小心格式错盘造成数据丢失</strong></p><h3 id="新建分区"><a href="#新建分区" class="headerlink" title="新建分区"></a>新建分区</h3><p>先给出最精简的分区表</p><h4 id="Legacy-Boot-MBR"><a href="#Legacy-Boot-MBR" class="headerlink" title="Legacy Boot + MBR"></a>Legacy Boot + MBR</h4><p>一个EXT4格式的主分区挂载到“&#x2F;”（根目录），用于存放系统、软件包和引导文件</p><p>一个SWAP格式的交换分区，即虚拟内存，大小一般 &lt;&#x3D; 电脑内存，这里是以分区形式使用，可用<strong>交换文件swapfile</strong>替代</p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/bf7bded7dc7e59f438ff2f26c29d7975.png"></p><ol><li>主板BIOS通过读取硬盘<strong>最开始保留扇区内的引导文件</strong>，引导到“&#x2F;dev&#x2F;sda1”上的<strong>GRUB2启动管理器</strong>，然后根据“&#x2F;boot&#x2F;grub&#x2F;grub.cfg”文件的配置引导到Linux</li></ol><h4 id="UEFI-Boot-GPT"><a href="#UEFI-Boot-GPT" class="headerlink" title="UEFI Boot + GPT"></a>UEFI Boot + GPT</h4><p>还需要一个FAT32格式的ESP分区，挂载到“&#x2F;boot&#x2F;efi”，不用分太大，500m即可</p><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/2a103e04f2aa58bca4b8aad39c9b478b.png"></p><h4 id="home分区"><a href="#home分区" class="headerlink" title="home分区"></a>home分区</h4><p>另可添加 home 分区，挂载到“&#x2F;home”，存放个人文件，系统滚挂后个人文件不会丢</p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/fa2d702f2707559d7d0956521471731a.png"></p><p>可以用<code>cfdisk /dev/sda</code>进入伪图形界面进行分区，实在不会或有问题的，重启进WinPE启动盘用DiskGenius，删掉所有分区和保留扇区后进行分区</p><p>这里使用fdisk</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">fdisk</span> /dev/sda<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>分别输入并回车：</p><ol><li><p><code>m</code>：查看帮助, 根据帮助进行分区</p></li><li><p><code>o</code>：创建MBR分区表，如果你是 UEFI Boot + GPT，输入<code>g</code></p></li><li><p><code>m</code>：记性不好，再看一遍帮助</p></li><li><p><code>n</code>：新建分区</p></li><li><p><code>p</code>：新建主分区</p></li><li><p><code>1</code>：新建第1个主分区，MBR分区表主分区默认能创建4个</p></li><li><p><code>2048</code>（保持默认，直接回车）：新建主分区的开始扇区为2048</p></li><li><p><code>+20G</code>：如果需要指定分区大小，如20G，就输入+20G，默认直接回车会占用整块硬盘</p></li><li><p>如需SWAP交换分区，重复4-8，如果拿捏不好分区大小，可以先<code>n</code>第<code>2</code>个<code>p</code> <code>+2G</code>, 再<code>n</code>第<code>1</code>个<code>p</code>直接回车</p></li><li><p><code>w</code>：将分区表写入硬盘</p></li></ol><h3 id="格式化分区"><a href="#格式化分区" class="headerlink" title="格式化分区"></a>格式化分区</h3><p>创建好分区后，还需要格式化分区以创建文件系统</p><p>查看硬盘分区</p><p><code>lsblk</code> 或 </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">fdisk</span> <span class="token parameter variable">-l</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这里我们是Legacy Boot + MBR环境，安装分区是&#x2F;dev&#x2F;sda1，使用交换文件，请勿无脑复制粘贴</p><p>把&#x2F;dev&#x2F;sda1格式化成EXT4：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mkfs.ext4 /dev/sda1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果要使用交换分区，把&#x2F;dev&#x2F;sda2格式化成SWAP：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkswap</span> /dev/sda2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果是UEFI Boot + GPT，把&#x2F;dev&#x2F;sda1格式化成SWAP：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mkfs.fat <span class="token parameter variable">-F32</span> /dev/nvme0n1p2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>上面给出的请勿无脑复制，需要对应上面图片的分区表按需调整</p><h3 id="挂载分区"><a href="#挂载分区" class="headerlink" title="挂载分区"></a>挂载分区</h3><p>待会儿安装程序pacstrap会将系统文件安装到&#x2F;mnt目录，因此我们需要挂载要存放系统文件的分区到&#x2F;mnt目录：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mount</span> /dev/sda1 /mnt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果刚才只创建了一个分区&#x2F;dev&#x2F;sda1，想使用交换文件，执行下面的命令创建一个2048MB的swapfile到刚刚挂载的&#x2F;mnt：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span>/mnt/swapfile <span class="token assign-left variable">bs</span><span class="token operator">=</span>1M <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">2048</span> <span class="token assign-left variable">status</span><span class="token operator">=</span>progress<span class="token function">chmod</span> 0600 /mnt/swapfile<span class="token function">mkswap</span> <span class="token parameter variable">-U</span> <span class="token function">clear</span> /mnt/swapfile<span class="token function">swapon</span> /mnt/swapfile<span class="token builtin class-name">echo</span> /mnt/swapfile none swap defaults <span class="token number">0</span> <span class="token number">0</span> <span class="token operator">>></span>/etc/fstab <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如果配置了home目录，还需：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mount</span> /dev/sda2 /mnt/home<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h3><p><strong>如果不换源，国内部分会慢得要死！！！</strong></p><h4 id="禁用-reflector-服务"><a href="#禁用-reflector-服务" class="headerlink" title="禁用 reflector 服务"></a>禁用 reflector 服务</h4><p>在特定情况下，reflector会误删某些有用的源信息，这里进入安装环境后的第一件事就是将其禁用。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl stop reflector.service<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="方式1"><a href="#方式1" class="headerlink" title="方式1"></a>方式1</h4><p>参考：<a href="http://mirrors.ustc.edu.cn/help/archlinux.html">http://mirrors.ustc.edu.cn/help/archlinux.html</a></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/pacman.d/mirrorlist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在文件的最顶端添加</p><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">Server</span> <span class="token punctuation">=</span> <span class="token value attr-value">https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch</span><span class="token key attr-name">Server</span> <span class="token punctuation">=</span> <span class="token value attr-value">https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch</span><span class="token key attr-name">Server</span> <span class="token punctuation">=</span> <span class="token value attr-value">https://repo.huaweicloud.com/archlinux/$repo/os/$arch</span><span class="token key attr-name">Server</span> <span class="token punctuation">=</span> <span class="token value attr-value">http://mirror.lzu.edu.cn/archlinux/$repo/os/$arch</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="方式2"><a href="#方式2" class="headerlink" title="方式2"></a>方式2</h4><p><strong>用不成</strong></p><p>使用命令</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman-mirrors <span class="token parameter variable">-i</span> <span class="token parameter variable">-c</span> China <span class="token parameter variable">-m</span> rank<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>执行后会弹出一个对话框，可以选择ustc源</p><h4 id="方式3"><a href="#方式3" class="headerlink" title="方式3"></a>方式3</h4><p>直接执行echo命令强制换成USTC源</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"Server = https://mirrors.ustc.edu.cn/archlinux/\<span class="token variable">$repo</span>/os/\<span class="token variable">$arch</span>"</span><span class="token operator">></span>/etc/pacman.d/mirrorlist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="装必需包"><a href="#装必需包" class="headerlink" title="装必需包"></a>装必需包</h3><p>安装 base 软件包和 Linux 内核以及常规硬件的固件（相比官方教程，增加了linux-headers和base-devel）</p><p>最新内核（会滚挂）：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacstrap <span class="token parameter variable">-K</span> /mnt base linux linux-headers linux-firmware base-devel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>lts稳定内核（推荐）：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacstrap <span class="token parameter variable">-K</span> /mnt base linux-lts linux-lts-headers linux-firmware base-devel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol><li>可以将 <code>linux</code> 替换为其他内核软件包：<ul><li><code>linux</code>、<code>linux-headers</code>：Stable — 原版的 Linux 内核和模块，采用了一些补丁</li><li><code>linux-lts</code>、<code>linux-lts-headers</code>：linux-lts — 受长期支持（LTS）的 Linux 内核和模块</li><li>参考：<a href="https://wiki.archlinuxcn.org/wiki/%E5%86%85%E6%A0%B8">https://wiki.archlinuxcn.org/wiki/%E5%86%85%E6%A0%B8</a></li></ul></li><li>linux-zen 内核不支持 nvidia 显卡</li><li>希望稳定使用，就选 linux-lts 内核</li><li>安装后仍然可以更换内核</li><li>在虚拟机或容器中安装时，可以不安装固件软件包 linux-firmware</li></ol><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="生成fstab"><a href="#生成fstab" class="headerlink" title="生成fstab"></a>生成fstab</h3><p>生成分区自动挂载 fstab 文件</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">genfstab <span class="token parameter variable">-U</span> /mnt <span class="token operator">>></span> /mnt/etc/fstab<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol><li><p>用 -U 或 -L 选项设置 UUID 或卷标</p></li><li><p>刚才的虚拟内存文件会自动转换目录，即由&#x2F;mnt&#x2F;swapfile变为&#x2F;swapfile</p></li><li><p>如需查看或更改更多挂载信息，如挂载ntfs分区，可以vim &#x2F;mnt&#x2F;etc&#x2F;fstab</p></li></ol><h3 id="change-root"><a href="#change-root" class="headerlink" title="change root"></a>change root</h3><p>改变根目录 chroot 到新安装的系统</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">arch-chroot /mnt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol><li>不能用chroot</li><li>此时，原来安装盘下的 <code>/mnt</code> 目录就变成了新系统的 <code>/</code> 目录</li></ol><h3 id="装常用包"><a href="#装常用包" class="headerlink" title="装常用包"></a>装常用包</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> <span class="token function">vim</span> networkmanager dhcpcd iwd <span class="token function">sudo</span> bluez usbmuxd ttf-dejavu wqy-zenhei noto-fonts-emoji ntfs-3g sof-firmware<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><input checked="" disabled="" type="checkbox"> vim：文本编辑器，可换为nano，更适合新手</li><li><input checked="" disabled="" type="checkbox"> networkmanager：联网用，网络管理组件</li><li><input checked="" disabled="" type="checkbox"> dhcpcd：联网用，DHCP动态获取IP地址需要</li><li><input checked="" disabled="" type="checkbox"> iwd：作为networkmanager的backend进行使用，连WiFi需要</li><li><input checked="" disabled="" type="checkbox"> sudo：非root用户暂时获取root权限需要</li><li><input checked="" disabled="" type="checkbox"> bluez：蓝牙模块需要</li><li><input checked="" disabled="" type="checkbox"> usbmuxd：usb连接手机共享网络需要</li><li><input checked="" disabled="" type="checkbox"> ttf-dejavu：开源字体</li><li><input checked="" disabled="" type="checkbox"> wqy-zenhei：中文字体，显示中文需要</li><li><input checked="" disabled="" type="checkbox"> noto-fonts-emoji：emoji字体，显示表情包需要</li><li><input checked="" disabled="" type="checkbox"> ntfs-3g：挂载ntfs磁盘需要</li><li><input checked="" disabled="" type="checkbox"> sof-firmware：声卡支持</li></ul><p>用软链接让vim替代vi</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ln</span> <span class="token parameter variable">-s</span> /bin/vim /bin/vi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="改时区"><a href="#改时区" class="headerlink" title="改时区"></a>改时区</h3><p>设置时区为中国上海</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ln</span> <span class="token parameter variable">-sf</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>使用如下命令，生成 &#x2F;etc&#x2F;adjtime，将系统时间(UTC)同步到硬件时间：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hwclock <span class="token parameter variable">--systohc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><strong>以下命令待测，无需理会：</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">timedatectl set-local-rtc <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如需将硬件时间设置为 localtime，解决Windows下时间错乱输入（需要Boot到系统）</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">timedatectl set-local-rtc <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果不存在 &#x2F;etc&#x2F;adjtime，systemd 会假定硬件时间按 UTC 设置。</p></blockquote><h3 id="改地区"><a href="#改地区" class="headerlink" title="改地区"></a>改地区</h3><p>如果不安装图形界面，不推荐设置中文，否则会无法显示文字</p><p>推荐设置为<code>en_GB.UTF-8</code></p><p>编辑 <code>/etc/locale.gen</code>，去掉 <code>en_US.UTF-8 UTF-8</code> 以及 <code>zh_CN.UTF-8 UTF-8</code> 行前的注释符号（<code>#</code>）</p><p>或执行以下命令</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> en_US.UTF-8 UTF-<span class="token operator"><span class="token file-descriptor important">8</span>></span>/etc/locale.gen<span class="token builtin class-name">echo</span> en_GB.UTF-8 UTF-<span class="token operator"><span class="token file-descriptor important">8</span>>></span>/etc/locale.gen<span class="token builtin class-name">echo</span> zh_CN.UTF-8 UTF-<span class="token operator"><span class="token file-descriptor important">8</span>>></span>/etc/locale.genlocale-gen<span class="token builtin class-name">echo</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>en_GB.UTF-<span class="token operator"><span class="token file-descriptor important">8</span>></span>/etc/locale.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol><li><p>不推荐在此设置任何中文 <code>locale</code>，会导致 <code>tty</code> 乱码</p></li><li><p>而中文的问题，一般会通过修改 ~&#x2F;.xprofile（DE） 或者 ~&#x2F;.xinitrc（WM） 进行解决</p></li></ol><h3 id="改主机名"><a href="#改主机名" class="headerlink" title="改主机名"></a>改主机名</h3><p>修改主机名（设备名称）为archlinux，可自行更换</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> archlinux <span class="token operator">></span>/etc/hostname<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>添加hosts信息</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"127.0.0.1<span class="token entity" title="\t">\t</span>localhost<span class="token entity" title="\n">\n</span>::1<span class="token entity" title="\t">\t</span>localhost<span class="token entity" title="\n">\n</span>127.0.0.1<span class="token entity" title="\t">\t</span>archlinux.localdomain archlinux"</span><span class="token operator">>></span>/etc/hosts<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="改密码"><a href="#改密码" class="headerlink" title="改密码"></a>改密码</h3><p>为 root 用户设置密码</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">passwd</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="修复引导"><a href="#修复引导" class="headerlink" title="修复引导"></a>修复引导</h3><p>安装相关软件包</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> grub efibootmgr os-prober<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>-S 选项后指定要通过pacman包管理器安装的包：<ul><li><input checked="" disabled="" type="checkbox"> <code>grub</code> —— 启动引导器</li><li><input checked="" disabled="" type="checkbox"> <code>efibootmgr</code> —— <code>efibootmgr</code> 被 <code>grub</code> 脚本用来将启动项写入 NVRAM</li><li><input checked="" disabled="" type="checkbox"> <code>os-prober</code> —— 为了能够引导 win10，需要安装 <code>os-prober</code> 以检测到它</li></ul></li></ul><p>安装grub到硬盘，注意不是分区</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">grub-install /dev/sda<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>启用os-prober支持自动添加其他系统启动项（如果是单系统可忽略）</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token assign-left variable">GRUB_DISABLE_OS_PROBER</span><span class="token operator">=</span>false<span class="token operator">>></span>/etc/default/grub<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>或进行如下修改</p><pre class="line-numbers language-none"><code class="language-none">vim &#x2F;etc&#x2F;default&#x2F;grub<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p><input checked="" disabled="" type="checkbox"> 修改 <code>GRUB_CMDLINE_LINUX_DEFAULT</code> 一行等号后面的参数</p><ul><li><input disabled="" type="checkbox"> （非必须）去掉最后的 <code>quiet</code> 参数，开启啰嗦模式</li><li><input disabled="" type="checkbox"> （非必须）把 <code>loglevel</code> 的数值从 <code>3</code> 改成 <code>5</code>。这样是为了后续如果出现系统错误，方便排错</li><li><input checked="" disabled="" type="checkbox"> 加入 <code>nowatchdog</code> 参数，这可以显著提高开关机速度</li></ul></li><li><p><input checked="" disabled="" type="checkbox"> 为了引导 win10，则还需要添加新的一行 <code>GRUB_DISABLE_OS_PROBER=false</code>，启用os-prober支持自动添加其他系统启动项（如果是单系统可忽略）</p></li></ul><p>最后生成 <code>GRUB</code> 所需的配置文件：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">grub-mkconfig</span> <span class="token parameter variable">-o</span> /boot/grub/grub.cfg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>某些主板安装完成没有启动条目的解决方案：在默认启动路径下安装 <code>GRUB</code></p><p>重新插入安装优盘，按原先顺序挂载目录（不需要再次创建文件夹了），<code>chroot</code> 到 <code>/mnt</code>，然后你可以直接把已经生成好的 <code>efi</code> 文件移动到默认目录下，如下命令所示：</p><pre class="line-numbers language-none"><code class="language-none">mv &#x2F;boot&#x2F;EFI&#x2F;grub &#x2F;boot&#x2F;EFI&#x2F;BOOTmv &#x2F;boot&#x2F;EFI&#x2F;GRUB&#x2F;grubx64.efi &#x2F;boot&#x2F;EFI&#x2F;BOOT&#x2F;BOOTX64.EFI<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>只有安装完成后你的主板不出现启动条目才需要尝试如下命令，正常安装无需执行</p><p>参考：<a href="https://wiki.archlinuxcn.org/wiki/GRUB/wiki/GRUB#%E7%BC%BA%E7%9C%81/%E5%90%8E%E5%A4%87%E5%90%AF%E5%8A%A8%E8%B7%AF%E5%BE%84">https://wiki.archlinuxcn.org/wiki/GRUB/wiki/GRUB#缺省/后备启动路径</a></p></blockquote><h3 id="退出重启"><a href="#退出重启" class="headerlink" title="退出重启"></a>退出重启</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">exit</span><span class="token function">umount</span> <span class="token parameter variable">-R</span> /mnt<span class="token function">reboot</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><p>输入用户root，然后输入刚才设置的密码</p><h3 id="联网-1"><a href="#联网-1" class="headerlink" title="联网"></a>联网</h3><p>默认是不能联网的，需要执行：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> NetworkManager<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>激活服务</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl start iwdsystemctl <span class="token builtin class-name">enable</span> iwdsystemctl start systemd-resolvedsystemctl <span class="token builtin class-name">enable</span> systemd-resolvedsystemctl <span class="token builtin class-name">enable</span> bluetoothsystemctl <span class="token builtin class-name">enable</span> NetworkManagersystemctl <span class="token builtin class-name">enable</span> dhcpcd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>配置</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/iwd/main.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>[General]<br>EnableNetworkConfiguration&#x3D;true<br>NameResolvingService&#x3D;systemd</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/NetworkManager/NetworkManager.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>[device]<br>wifi.backend&#x3D;iwd</p></blockquote><p>或用echo自动加入以上配置</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"[General]<span class="token entity" title="\n">\n</span>EnableNetworkConfiguration=true<span class="token entity" title="\n">\n</span>NameResolvingService=systemd"</span><span class="token operator">></span>/etc/iwd/main.conf<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"[device]<span class="token entity" title="\n">\n</span>wifi.backend=iwd"</span><span class="token operator">>></span>/etc/iwd/main.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>重启后即可联网（仅WiFi，网线不用）</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">reboot</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="设备驱动"><a href="#设备驱动" class="headerlink" title="设备驱动"></a>设备驱动</h3><p>如果没有使用root用户登录，注意命令前需自行补上sudo，或直接<code>sudo -i</code>；大多数命令重启后生效，可以自行<code>reboot</code></p><h4 id="虚拟机"><a href="#虚拟机" class="headerlink" title="虚拟机"></a>虚拟机</h4><h5 id="VirtualBox"><a href="#VirtualBox" class="headerlink" title="VirtualBox"></a>VirtualBox</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> virtualbox-guest-utilssystemctl <span class="token builtin class-name">enable</span> vboxservice.service<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h5 id="VMware"><a href="#VMware" class="headerlink" title="VMware"></a>VMware</h5><p>参考：<a href="https://wiki.archlinux.org/title/VMware/Install_Arch_Linux_as_a_guest">https://wiki.archlinux.org/title/VMware/Install_Arch_Linux_as_a_guest</a></p><p>拖拽复制粘贴</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> open-vm-tools gtkmm3systemctl <span class="token builtin class-name">enable</span> vmtoolsdsystemctl <span class="token builtin class-name">enable</span> vmware-vmblock-fusesystemctl start vmtoolsdsystemctl start vmware-vmblock-fuse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>如果还不能复制（能复制可忽略）</strong><br>使 vmware-user 在 X11 之后运行：<br>确保 <code>/etc/xdg/autostart/vmware-user.desktop</code> 存在（我的默认存在），如果文件不存在，请运行：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> /etc/vmware-tools/vmware-user.desktop /etc/xdg/autostart/vmware-user.desktop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>或添加 <code>vmware-user</code> 到 <code>Xinitrc</code></p><p>文件不支持复制</p></blockquote><p>时间同步</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">vmware-toolbox-cmd timesync <span class="token builtin class-name">enable</span>hwclock <span class="token parameter variable">--hctosys</span> <span class="token parameter variable">--localtime</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Xorg 配置（不使用桌面环境不用安装）</strong></p><p>安装以下驱动和依赖</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> xf86-input-vmmouse xf86-video-vmware mesa gtkmm gtk2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/mkinitcpio.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>通过 mkinitcpio.conf 加载以下模块：</p><blockquote><p>MODULES&#x3D;(vsock vmw_vsock_vmci_transport vmw_balloon vmw_vmci vmwgfx)</p></blockquote><p>然后运行：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mkinitcpio <span class="token parameter variable">-p</span> linux<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>为了让 X server 拥有 root 权限来加载驱动，可能还需要编辑下面的配置：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/X11/Xwrapper.config<span class="token assign-left variable">needs_root_rights</span><span class="token operator">=</span>yes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></blockquote><h4 id="CPU微码"><a href="#CPU微码" class="headerlink" title="CPU微码"></a>CPU微码</h4><h5 id="Intel-CPU"><a href="#Intel-CPU" class="headerlink" title="Intel CPU"></a>Intel CPU</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> intel-ucode<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="AMD-CPU"><a href="#AMD-CPU" class="headerlink" title="AMD CPU"></a>AMD CPU</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> amd-ucode<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>安装微码软件包后，重新生成 GRUB 配置以激活加载微码更新：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">grub-mkconfig</span> <span class="token parameter variable">-o</span> /boot/grub/grub.cfg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="显卡驱动"><a href="#显卡驱动" class="headerlink" title="显卡驱动"></a>显卡驱动</h4><h5 id="Intel核显驱动"><a href="#Intel核显驱动" class="headerlink" title="Intel核显驱动"></a>Intel核显驱动</h5><p>用Intel核显就装</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> mesa lib32-mesa vulkan-intel lib32-vulkan-intel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol><li><p>不建议安装 <code>xf86-video-intel</code>，而应使用 Xorg 的 modesetting 驱动（也就是什么都不用装的意思）</p></li><li><p>注意，只有 Intel HD 4000 及以上的核显才支持 vulkan</p></li></ol><h5 id="AMD显卡驱动"><a href="#AMD显卡驱动" class="headerlink" title="AMD显卡驱动"></a>AMD显卡驱动</h5><p>在 <a href="https://www.techpowerup.com/">TECHPOWERUP</a> 进行查询显卡架构</p><p>用AMD显卡（GCN架构）的就装开源驱动 AMDGPU</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> mesa lib32-mesa xf86-video-amdgpu vulkan-radeon lib32-vulkan-radeon<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>用ATI老显卡（GCN 1-2、HD 5000-2000、X1000及之前）的就装开源 ATI 驱动</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> mesa lib32-mesa xf86-video-ati<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="Nvidia显卡驱动"><a href="#Nvidia显卡驱动" class="headerlink" title="Nvidia显卡驱动"></a>Nvidia显卡驱动</h5><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/d50c70e1a98a03ed99e94f9b76280473.png"></p><p>参考：<a href="https://wiki.archlinuxcn.org/wiki/NVIDIA">https://wiki.archlinuxcn.org/wiki/NVIDIA</a></p><ul><li>对于 Turing (NV160&#x2F;TUXXX) 系列或更新的显卡，需要安装 nvidia-open 驱动</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> nvidia-open nvidia-settings lib32-nvidia-utils<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>DKMS：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> nvidia-open-dkms nvidia-settings lib32-nvidia-utils<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><ul><li>其他较新型号的独立显卡使用以下命令直接安装如下几个包即可：</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> nvidia-open nvidia-settings lib32-nvidia-utils<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>DKMS：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> nvidia-dkms nvidia-settings lib32-nvidia-utils<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><ul><li>如果是 GeForce 630 以下到 GeForce 400 系列的老卡，使用以下命令安装 <a href="https://aur.archlinux.org/packages/nvidia-390xx-dkms/">nvidia-390xx-dkms</a>aur 及其 32 位支持包：</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> nvidia-390xx-dkms nvidia-settings lib32-nvidia-390xx-utils<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>注意这里使用了yay，需要配置archlinuxcn源</p><ul><li>再老的显卡直接使用以下命令安装 <a href="https://wiki.archlinux.org/title/Nouveau_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">开源驱动</a> 即可：</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> mesa lib32-mesa xf86-video-nouveau<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果刚才是lts内核就装</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> mesa nvidia-lts nvidia-settings nvidia-utils nvidia-prime<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol><li><p>nvidia-dkms 与 nvidia-lts 不兼容，如果装lts驱动的话无需安装dkms 。</p></li><li><p>nvidia 驱动的安装与前面选择的内核有关</p></li><li><p>如果你安装的是 linux-lts 内核，那么需要将nvidia更换为nvidia-lts</p></li><li><p>linux-zen 不支持nvidia显卡（务必对号入座）</p></li><li><p>如果你选择安装 linux 新内核，则需要在启动选项中添加ibt&#x3D;off ，否则无法进入系统</p></li></ol><h5 id="双显卡"><a href="#双显卡" class="headerlink" title="双显卡"></a>双显卡</h5><p>参考：</p><p><a href="https://wiki.archlinuxcn.org/wiki/PRIME">https://wiki.archlinuxcn.org/wiki/PRIME</a></p><p><a href="https://github.com/Askannz/optimus-manager/wiki">https://github.com/Askannz/optimus-manager/wiki</a></p><p><a href="https://arch.icekylin.online/guide/rookie/graphic-driver.html#%E5%8F%8C%E6%98%BE%E5%8D%A1-%E6%A0%B8%E6%98%BE-%E7%8B%AC%E6%98%BE">https://arch.icekylin.online/guide/rookie/graphic-driver.html#双显卡-核显-独显</a></p><h4 id="声卡驱动"><a href="#声卡驱动" class="headerlink" title="声卡驱动"></a>声卡驱动</h4><h5 id="PipeWire（推荐）"><a href="#PipeWire（推荐）" class="headerlink" title="PipeWire（推荐）"></a><a href="https://wiki.archlinuxcn.org/wiki/PipeWire">PipeWire</a>（推荐）</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> pipewire alsa-utils pipewire-pulse pipewire-jack pipewire-alsa<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="PulseAudio"><a href="#PulseAudio" class="headerlink" title="PulseAudio"></a><a href="https://wiki.archlinuxcn.org/wiki/PulseAudio">PulseAudio</a></h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> alsa-utils pulseaudio pavucontrol<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如有提示，选择默认（直接回车）</p><h3 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h3><p>添加一个名为user的用户进入wheel用户组，并将bash作为启动命令</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">useradd</span> <span class="token parameter variable">-m</span> <span class="token parameter variable">-G</span> wheel <span class="token parameter variable">-s</span> /bin/bash user<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>设置user用户的密码</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">passwd</span> user<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>配置wheel用户组的sudo权限</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"%wheel ALL=(ALL:ALL) ALL"</span><span class="token operator">>></span>/etc/sudoers<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>重启系统（如需继续安装GUI，可以不用重启）</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">reboot</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>此时的系统已经基本可以使用了，但是还没有配置图形界面，如果你不需要图形界面，就只需登陆user用户就可以使用了</p><p>注意：从这里开始，如果登陆的是普通用户，所有的pacman和systemctl等修改到系统的命令都需要加sudo</p><blockquote><p>如果嫌麻烦，可以：</p><pre class="line-numbers language-none"><code class="language-none">echo alias pacman&#x3D;&#39;sudo pacman&#39;&gt;&gt;~&#x2F;.bashrcecho alias systemctl&#x3D;&#39;sudo systemctl&#39;&gt;&gt;~&#x2F;.bashrc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></blockquote><h2 id="GUI"><a href="#GUI" class="headerlink" title="GUI"></a>GUI</h2><p>参考：<a href="https://wiki.archlinuxcn.org/wiki/%E5%BB%BA%E8%AE%AE%E9%98%85%E8%AF%BB#%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2">https://wiki.archlinuxcn.org/wiki/建议阅读#图形界面</a></p><h3 id="换成中文"><a href="#换成中文" class="headerlink" title="换成中文"></a>换成中文</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>zh-CN.UTF-<span class="token operator"><span class="token file-descriptor important">8</span>></span>/etc/locale.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="安装窗口图形系统"><a href="#安装窗口图形系统" class="headerlink" title="安装窗口图形系统"></a>安装窗口图形系统</h3><p>窗口图形系统有两种选择：Xorg（X11）和Wayland</p><p>Wayland是比较先进的，虽然可以使用 Wayland 启动 KDE Plasma，但仍存在一些缺失的功能和已知问题。建议使用 Xorg 以获得最完整和稳定的体验</p><p>执行下面命令安装 Xorg 的一些组件：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> xorg xorg-server xorg-apps xorg-xinit xorg-xclock xterm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如有提示，选择默认（直接回车）</p><p>安装完成后，可执行 startx 测试 Xorg 是否正常工作。（执行 exit 退出 Xorg 测试界面）</p><h3 id="安装桌面环境"><a href="#安装桌面环境" class="headerlink" title="安装桌面环境"></a>安装桌面环境</h3><p>安装桌面环境前，请确保安装xorg和声卡驱动</p><h4 id="KDE"><a href="#KDE" class="headerlink" title="KDE"></a>KDE</h4><p>执行下面命令 一次性安装全部 KDE Plasma 应用：（可选）</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> plasma sddm kde-applicationssystemctl <span class="token builtin class-name">enable</span> sddm<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>下面是安装个人喜欢的一些 KDE 应用，执行</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> plasma sddm dolphin konsole kate kcalc kscreen ark okular spectacle gwenviewsystemctl <span class="token builtin class-name">enable</span> sddm<span class="token function">reboot</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>一条一条执行，如有提示，选择默认（直接回车）</p><ul><li><input checked="" disabled="" type="checkbox"> plasma：桌面环境</li><li><input checked="" disabled="" type="checkbox"> sddm：登录管理器，KDE配套的</li><li><input checked="" disabled="" type="checkbox"> dolphin：文件管理器</li><li><input checked="" disabled="" type="checkbox"> konsole：kde下的终端，功能多但是比较慢，也可以使用其他终端：<ul><li><input disabled="" type="checkbox"> alacritty</li><li><input disabled="" type="checkbox"> kitty</li></ul></li><li><input checked="" disabled="" type="checkbox"> kate：文本编辑器，很强大，但是资料比较少，需要自己配置<ul><li><input checked="" disabled="" type="checkbox"> vim：刚才已经装过了</li><li><input disabled="" type="checkbox"> neovim、gvim、nano</li><li><input disabled="" type="checkbox"> gedit</li><li><input disabled="" type="checkbox"> （sublime,vscode需要在AUR源或者Clansty源中安装）</li></ul></li><li><input checked="" disabled="" type="checkbox"> kcalc：计算器</li><li><input checked="" disabled="" type="checkbox"> kscreen：屏幕修改分辨率和刷新率</li><li><input checked="" disabled="" type="checkbox"> ark：解压与压缩</li><li><input checked="" disabled="" type="checkbox"> okular：PDF查看器</li><li><input checked="" disabled="" type="checkbox"> spectacle：截图工具，上面三件套配合KDE很方便</li><li><input checked="" disabled="" type="checkbox"> gwenview：看图工具</li></ul><p>KDE 全部应用详见 <a href="https://apps.kde.org/zh-cn/">https://apps.kde.org/zh-cn/</a></p><p>执行下面命令安装 Firefox</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> firefox<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>一次性安装全部中文字体</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> wqy-microhei wqy-microhei-lite wqy-bitmapfont wqy-zenhei ttf-arphic-ukai ttf-arphic-uming ttf-sarasa-gothic adobe-source-han-sans-cn-fonts adobe-source-han-serif-cn-fonts noto-fonts-cjk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><input checked="" disabled="" type="checkbox"> wqy-microhei</li><li><input checked="" disabled="" type="checkbox"> wqy-microhei-lite</li><li><input checked="" disabled="" type="checkbox"> wqy-bitmapfont</li><li><input checked="" disabled="" type="checkbox"> wqy-zenhei</li><li><input checked="" disabled="" type="checkbox"> ttf-arphic-ukai</li><li><input checked="" disabled="" type="checkbox"> ttf-arphic-uming</li><li><input checked="" disabled="" type="checkbox"> ttf-sarasa-gothic</li><li><input checked="" disabled="" type="checkbox"> adobe-source-han-sans-cn-fonts</li><li><input checked="" disabled="" type="checkbox"> adobe-source-han-serif-cn-fonts</li><li><input checked="" disabled="" type="checkbox"> noto-fonts-cjk</li></ul><h4 id="GNOME"><a href="#GNOME" class="headerlink" title="GNOME"></a>GNOME</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> gnomesystemctl <span class="token builtin class-name">enable</span> gdm<span class="token function">reboot</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="i3"><a href="#i3" class="headerlink" title="i3"></a>i3</h4><p>略</p><h2 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h2><h4 id="添加archlinuxcn源，并配置yay"><a href="#添加archlinuxcn源，并配置yay" class="headerlink" title="添加archlinuxcn源，并配置yay"></a>添加archlinuxcn源，并配置yay</h4><p>还要添加 Arch Linux CN 源，这个不添加会导致pacman无法安装yay</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/pacman.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在文件末尾添加：</p><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">archlinuxcn</span><span class="token punctuation">]</span></span><span class="token key attr-name">SigLevel</span> <span class="token punctuation">=</span> <span class="token value attr-value">Optional TrustAll</span><span class="token key attr-name">Server</span> <span class="token punctuation">=</span> <span class="token value attr-value">https://mirrors.ustc.edu.cn/archlinuxcn/$arch</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>SigLevel 那一行如果后面安装 archlinuxcn-keyring 时不会报错的话，可以不加</p><p>取消这两行前面的注释，不然有一部分32位包无法安装</p><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment"># [muiltilib]</span><span class="token comment"># Include = /etc/pacman.d/mirrorlist</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>安装 archlinuxcn-keyring 包导入 GPG key</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-Syyu</span><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> archlinuxcn-keyring<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>从 AUR 安装软件包，需要先安装 AUR Helper，这里以最有名的 yay 为例。</p><p>使用pacman安装yay：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> yay<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>使用下面命令安装 yay（Binary 版本，无需自己编译）：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> <span class="token parameter variable">--needed</span> <span class="token function">git</span> base-devel<span class="token function">git</span> clone https://aur.archlinux.org/yay-bin.git<span class="token builtin class-name">cd</span> yay-binmakepkg <span class="token parameter variable">-si</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h4 id="软件包管理器简介"><a href="#软件包管理器简介" class="headerlink" title="软件包管理器简介"></a>软件包管理器简介</h4><h5 id="Pacman"><a href="#Pacman" class="headerlink" title="Pacman"></a>Pacman</h5><p>在 archlinux 上安装的软件都通过 Pacman 来进行管理</p><h6 id="更新系统"><a href="#更新系统" class="headerlink" title="更新系统"></a>更新系统</h6><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-Syyu</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h6 id="更新软件包数据库"><a href="#更新软件包数据库" class="headerlink" title="更新软件包数据库"></a>更新软件包数据库</h6><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-Syy</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h6 id="更新已安装的软件"><a href="#更新已安装的软件" class="headerlink" title="更新已安装的软件"></a>更新已安装的软件</h6><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-Syu</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h6 id="查看不需要的包"><a href="#查看不需要的包" class="headerlink" title="查看不需要的包"></a>查看不需要的包</h6><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-Qtd</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h6 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h6><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> 软件名<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h6 id="搜索软件"><a href="#搜索软件" class="headerlink" title="搜索软件"></a>搜索软件</h6><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-Ss</span> 软件名<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h6 id="搜索安装的所有软件包，grep只显示指定软件名"><a href="#搜索安装的所有软件包，grep只显示指定软件名" class="headerlink" title="搜索安装的所有软件包，grep只显示指定软件名"></a>搜索安装的所有软件包，grep只显示指定软件名</h6><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -Q<span class="token operator">|</span><span class="token function">grep</span> 软件名<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h6 id="卸载软件包并删除配置文件"><a href="#卸载软件包并删除配置文件" class="headerlink" title="卸载软件包并删除配置文件"></a>卸载软件包并删除配置文件</h6><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-Rsunc</span> 软件名<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="yay"><a href="#yay" class="headerlink" title="yay"></a>yay</h5><p>yay 是一个用 Go 语言开发的 AUR Helper，具有高级依赖解决、PKGBUILD 下载、AUR 包名自动补全、移除生成依赖等功能。</p><p>参考：<a href="https://github.com/Jguer/yay">https://github.com/Jguer/yay</a></p><h6 id="安装-AUR-软件"><a href="#安装-AUR-软件" class="headerlink" title="安装 AUR 软件"></a>安装 AUR 软件</h6><p>yay 的用法和 Pacman 是基本一样的。有额外几条常用命令：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token comment"># 等同于 yay -Syu</span>yay 软件名 <span class="token comment"># 等同于 yay -Ss 软件名 &amp;&amp; yay -S 软件名</span>yay <span class="token parameter variable">-Ps</span> <span class="token comment"># 打印系统统计信息</span>yay <span class="token parameter variable">-Yc</span> <span class="token comment"># 清理不需要的依赖</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>注意：执行 yay 的所有命令时，前面不需要加 sudo</p><p>下面举几个安装 AUR 软件的例子：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> microsoft-edge-stable-bin <span class="token comment">#安装 Microsoft Edge</span>yay <span class="token parameter variable">-S</span> wps-office-cn wps-office-mui-zh-cn ttf-wps-fonts <span class="token comment">#安装 WPS Office</span>yay <span class="token parameter variable">-S</span> visual-studio-code-bin <span class="token comment">#安装 Visual Studio Code</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>所有 AUR 软件可在 <a href="https://aur.archlinux.org/">https://aur.archlinux.org/</a> 上查询</p><h6 id="更新-x2F-升级-AUR-软件"><a href="#更新-x2F-升级-AUR-软件" class="headerlink" title="更新&#x2F;升级 AUR 软件"></a>更新&#x2F;升级 AUR 软件</h6><p>执行下面命令更新 AUR 软件包数据库：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-Syy</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>备注：其中 -S 表示 sync（同步），-y 表示从服务器下载新的软件包数据库，-yy 表示强制更新软件包数据库。</p><p>执行下面命令，更新 AUR 软件包数据库并升级所有已安装的软件包：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-Syyu</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>备注：-u 表示 upgrade（升级）。</p><p>一般情况下，执行</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-Syyu</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>即可。</p><h6 id="卸载-AUR-软件"><a href="#卸载-AUR-软件" class="headerlink" title="卸载 AUR 软件"></a>卸载 AUR 软件</h6><p>个人建议卸载 AUR 软件时，连所有依赖项和配置文件一起删除。</p><p>执行下面命令即可：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-Rscnu</span> 包名<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>备注：-R 表示 Remove（移除），-s 删除不需要的依赖关系，-c（cascade）删除软件包及所有依赖于此的软件包，-n 表示 nosave（删除配置文件），-u 表示 unneeded（删除不需要的软件包）。</p><h6 id="搜索-AUR-软件"><a href="#搜索-AUR-软件" class="headerlink" title="搜索 AUR 软件"></a>搜索 AUR 软件</h6><p>执行下面命令搜索<strong>在线 AUR 软件包</strong>：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-Ss</span> 关键词<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>执行下面命令搜索<strong>本地 AUR 软件包</strong>：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-Qs</span> 关键词 <span class="token comment">#模糊匹配</span>yay <span class="token parameter variable">-Q</span> 包名 <span class="token comment">#精确匹配</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>备注：-Q 表示 Query（查询），-s 表示 search（搜索）。</p><h6 id="安装本地软件包"><a href="#安装本地软件包" class="headerlink" title="安装本地软件包"></a>安装本地软件包</h6><p>执行下面命令安装本地软件包：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-U</span> 软件包路径<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h6 id="清理无用软件包与缓存"><a href="#清理无用软件包与缓存" class="headerlink" title="清理无用软件包与缓存"></a>清理无用软件包与缓存</h6><p>执行下面命令清理安装包缓存：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-Scc</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>执行下面命令清理孤立软件包：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-Rscnu</span> <span class="token variable"><span class="token variable">$(</span>yay <span class="token parameter variable">-Qdtq</span><span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>本文仅讨论了 yay 的常用命令，如果需要查询所有命令，可执行</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">--help</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>显示 yay 的帮助信息。</p><p><strong>使用yay安装软件必须先安装打包工具，不然安装会在prepare阶段出错！！！</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> base-devel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>此外，还可以使用图形化的包管理软件（Pacman &#x2F; yay 的图形前端）<a href="https://github.com/aarnt/octopi">Octopi</a>。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> octopi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="安装中文拼音输入法"><a href="#安装中文拼音输入法" class="headerlink" title="安装中文拼音输入法"></a>安装中文拼音输入法</h4><h5 id="云拼音"><a href="#云拼音" class="headerlink" title="云拼音"></a>云拼音</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> manjaro-asian-input-support-fcitx5 fcitx5 fcitx5-configtool fcitx5-chinese-addons fcitx5-qt fcitx5-gtk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="搜狗拼音"><a href="#搜狗拼音" class="headerlink" title="搜狗拼音"></a>搜狗拼音</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> fcitx fcitx-configtool fcitx-qt5 manjaro-asian-input-support-fcitx fcitx-sogoupinyin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>两个任选一个就行了，建议用云拼音。</p><h4 id="安装zsh"><a href="#安装zsh" class="headerlink" title="安装zsh"></a>安装zsh</h4><p>通过以下命令安装 zsh 相关的包：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> <span class="token function">zsh</span> zsh-autosuggestions zsh-syntax-highlighting zsh-completions<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><input checked="" disabled="" type="checkbox"> <a href="https://github.com/zsh-users/zsh-autosuggestions"><code>zsh-autosuggestions</code></a> —— 命令自动补全插件</li><li><input checked="" disabled="" type="checkbox"> <a href="https://github.com/zsh-users/zsh-syntax-highlighting"><code>zsh-syntax-highlighting</code></a> —— 语法上高亮插件</li><li><input checked="" disabled="" type="checkbox"> <a href="https://github.com/zsh-users/zsh-completions"><code>zsh-completions</code></a> —— 补充补全定义</li></ul><p>安装 autojump 插件：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> autojump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>更改账户的默认 Shell：</p><p>非 root 账户</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 查看安装了哪些 Shell</span>chsh <span class="token parameter variable">-l</span> <span class="token comment"># 修改当前账户的默认 Shell</span>chsh <span class="token parameter variable">-s</span> /usr/bin/zsh <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>root（可以不为 root 账户更改默认 shell）</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">chsh <span class="token parameter variable">-l</span> <span class="token comment"># 查看安装了哪些 Shell</span><span class="token function">sudo</span> chsh <span class="token parameter variable">-s</span> /usr/bin/zsh root<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>注销并重新登录 &gt; 打开终端，此时会弹出如下界面进行设置：</p><ul><li>按下 0 将创建一个只包含注释的 ~&#x2F;.zshrc 文件，在下次启动时不会再次弹出设置选项。</li><li>按下 1 即可进入设置：根据提示完成设置即可。也可以创建一个只包含注释的 <code>~/.zshrc</code> 文件以使用默认值。</li><li>若希望重新设置，只需要把 <code>~/.zshrc</code> 文件删掉即可。</li></ul><p>为了让插件生效，需要修改 ~&#x2F;.zshrc。使用 vim 编辑 ~&#x2F;.zshrc 文件：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> ~/.zshrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将以下内容分别添加到需要设置 zsh 账户的 ~&#x2F;.zshrc 中：</p><pre class="line-numbers language-none"><code class="language-none">source &#x2F;usr&#x2F;share&#x2F;zsh&#x2F;plugins&#x2F;zsh-syntax-highlighting&#x2F;zsh-syntax-highlighting.zshsource &#x2F;usr&#x2F;share&#x2F;zsh&#x2F;plugins&#x2F;zsh-autosuggestions&#x2F;zsh-autosuggestions.zshsource &#x2F;usr&#x2F;share&#x2F;autojump&#x2F;autojump.zsh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>关闭并重新打开终端</p><h4 id="适合安装的软件"><a href="#适合安装的软件" class="headerlink" title="适合安装的软件"></a>适合安装的软件</h4><p>字体管理器：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> font-manager<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>U盘启动镜像：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> ventoy-bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>谷歌浏览器：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> google-chrome<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>网页APP管理器：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> webapp-manager<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>百度网盘：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> baidunetdisk-bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>远程桌面：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> remmina<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>远程登录：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> teamviewer<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>下载工具：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> motrix <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>md文档编辑器：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> typora<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>文本编辑器：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> kate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>wps，安装时版本选择建议选2(本地版，可登录wps云同步文档)：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> wps-office-cn wps-office-mui-zh-cn ttf-wps-fonts<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>媒体播放器：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> qmplay2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>网易云音乐：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> netease-cloud-music<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>图像处理：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> gimp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>画图：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> pinta<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>krita画图：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> karita<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>录屏：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> vokoscreen<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>专业录屏：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> obs-studio<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>音频处理：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> audacity<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>火焰截图：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> flameshot<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="安装-Windows-10-字体"><a href="#安装-Windows-10-字体" class="headerlink" title="安装 Windows 10 字体"></a>安装 Windows 10 字体</h4><h5 id="挂载-Win10-镜像"><a href="#挂载-Win10-镜像" class="headerlink" title="挂载 Win10 镜像"></a>挂载 Win10 镜像</h5><p>Win10 镜像可从 <a href="https://next.itellyou.cn/">https://next.itellyou.cn/</a> 下载。</p><p>下载完成后就要挂载 Win10 镜像了。</p><p>执行下面命令创建挂载点：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> /mnt/iso<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后执行下面命令挂载 Win10 镜像：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mount</span> <span class="token parameter variable">-o</span> loop 镜像路径 /mnt/iso<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>备注：-o 表示 options（选项），参数 loop 表示将一个文件作为硬盘分区挂载</p><h5 id="解压-Win10-镜像"><a href="#解压-Win10-镜像" class="headerlink" title="解压 Win10 镜像"></a>解压 Win10 镜像</h5><p>挂载完成后，需要安装 wimlib&#x2F;wimtools 来解压 install.wim&#x2F;install.esd 文件。请根据自己使用的发行版选择命令安装：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> wimlib <span class="token comment">#Arch/Manjaro/... 安装命令</span><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> wimtools <span class="token comment">#Debian/Ubuntu/Deepin/UOS/... 安装命令</span><span class="token function">sudo</span> yum <span class="token function">install</span> wimlib <span class="token comment">#RedHat/CentOS/Fedora/... 安装命令</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>先创建一个用于临时放置字体的文件夹：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> Win10Fonts<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>执行命令，解压 install.wim&#x2F;install.esd 中的 Fonts 文件夹<strong>（原版 Win10 镜像一般是 install.wim）</strong>：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> wimextract /mnt/iso/sources/install.wim <span class="token number">1</span> /Windows/Fonts --dest-dir<span class="token operator">=</span>Win10Fonts<span class="token comment">#适用 install.wim</span><span class="token function">sudo</span> wimextract /mnt/iso/sources/install.esd <span class="token number">1</span> /Windows/Fonts --dest-dir<span class="token operator">=</span>Win10Fonts<span class="token comment">#适用 install.esd</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h5 id="安装-Win10-字体"><a href="#安装-Win10-字体" class="headerlink" title="安装 Win10 字体"></a>安装 Win10 字体</h5><p>在系统字体目录新建一个文件夹用于存放 Win10 字体：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> /usr/share/fonts/Win10Fonts<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将解压得到的 ttf、ttc 字体复制到系统字体目录：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">cp</span> <span class="token parameter variable">-r</span> Win10Fonts/*.ttf /usr/share/fonts/Win10Fonts/<span class="token function">sudo</span> <span class="token function">cp</span> <span class="token parameter variable">-r</span> Win10Fonts/*.ttc /usr/share/fonts/Win10Fonts/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>更改权限：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">644</span> /usr/share/fonts/Win10Fonts/*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>刷新字体缓存：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> fc-cache <span class="token parameter variable">-fv</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>试着打开一下 WPS Office，那些熟悉的 Windows 字体是不是出现了呢？</p><h4 id="笔记本推荐安装TLP电源管理"><a href="#笔记本推荐安装TLP电源管理" class="headerlink" title="笔记本推荐安装TLP电源管理"></a>笔记本推荐安装TLP电源管理</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> tlp tlp-rdwyay <span class="token parameter variable">-S</span> tlpui<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>启动tlp服务</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> tlp.service<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> NetworkManager-dispatcher.service<span class="token comment"># 屏蔽以下服务以避免冲突，确保 TLP 无线设备的开关选项可以正确运行</span><span class="token function">sudo</span> systemctl mask systemd-rfkill.service<span class="token function">sudo</span> systemctl mask systemd-rfkill.socket<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>安装后，TLP 将在开机时自动启动。为了避免第一次重启系统，可以使用以下命令手动启动：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> tlp start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>检查 TLP 工作状态</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">tlp-stat <span class="token parameter variable">-s</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>注意看输出结果，它会要求输入其他的命令，照输就行。</p><p>检查要不要安装附加组件</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> tlp-stat <span class="token parameter variable">-b</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>按照输出用yay安装就行了</p><p>使用 TLP 显示相关系统信息</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> tlp-stat <span class="token parameter variable">-b</span> <span class="token comment"># 显示电池信息</span><span class="token function">sudo</span> tlp-stat <span class="token parameter variable">-d</span> <span class="token comment"># 显示磁盘信息</span><span class="token function">sudo</span> tlp-stat <span class="token parameter variable">-e</span> <span class="token comment"># 显示 PCI 设备信息</span><span class="token function">sudo</span> tlp-stat <span class="token parameter variable">-g</span> <span class="token comment"># 显示 GPU 信息</span><span class="token function">sudo</span> tlp-stat <span class="token parameter variable">-p</span> <span class="token comment"># 显示 CPU 信息</span>tlp-stat <span class="token parameter variable">-s</span> <span class="token comment"># 显示系统数据信息 / 验证 TLP 服务运行状况</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>参考：<a href="https://arch.icekylin.online/guide/advanced/power-ctl.html">https://arch.icekylin.online/guide/advanced/power-ctl.html</a></p><h4 id="避免关机时间过长"><a href="#避免关机时间过长" class="headerlink" title="避免关机时间过长"></a>避免关机时间过长</h4><p>编辑系统配置文件</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/systemd/system.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将文件中的DefaultTimeoutStartSec和DefaultTimeoutStopSec改成5s</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">DefaultTimeoutStartSec</span><span class="token operator">=</span>5s<span class="token assign-left variable">DefaultTimeoutStopSec</span><span class="token operator">=</span>5s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>最后执行 daemon-reload 使其生效。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl daemon-reload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>上述解决方案其实只是将这个等待时间缩小了，并没有解决实际问题。如果你想排查问题真正的原因所在，耐心等待其结束关机，然后重新启动电脑，执行以下命令：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">journalctl <span class="token parameter variable">-p5</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>按&#x2F;(斜杠键)搜索<code>Killing</code>关键字，找到你关机的时间附近所在的匹配行，你可以在附近看到到底是哪一个进程导致了 timeout,然后再去排查这个进程有什么问题即可。</p></blockquote><h4 id="启动时打开数字锁定键"><a href="#启动时打开数字锁定键" class="headerlink" title="启动时打开数字锁定键"></a>启动时打开数字锁定键</h4><p>参考：<a href="https://wiki.archlinuxcn.org/wiki/%E5%90%AF%E5%8A%A8%E6%97%B6%E6%89%93%E5%BC%80%E6%95%B0%E5%AD%97%E9%94%81%E5%AE%9A%E9%94%AE">https://wiki.archlinuxcn.org/wiki/启动时打开数字锁定键</a></p><h2 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h2><p><a href="https://wiki.archlinuxcn.org/">https://wiki.archlinuxcn.org/</a></p><p><a href="https://arch.icekylin.online/">https://arch.icekylin.online/</a></p><p><a href="https://zhuanlan.zhihu.com/p/513859236">https://zhuanlan.zhihu.com/p/513859236</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 操作系统 </tag>
            
            <tag> Arch Linux </tag>
            
            <tag> Linux </tag>
            
            <tag> pacman </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[转载]小慢哥IPv6系列</title>
      <link href="/posts/fzxiaomange-ipv6.html"/>
      <url>/posts/fzxiaomange-ipv6.html</url>
      
        <content type="html"><![CDATA[<p>原文：<a href="https://www.zhihu.com/column/fzxiaomange">https://www.zhihu.com/column/fzxiaomange</a></p><h2 id="IPv6系列-入门指南"><a href="#IPv6系列-入门指南" class="headerlink" title="IPv6系列-入门指南"></a>IPv6系列-入门指南</h2><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/606449be0206c3a32a63316b5913d57b.png"></p><p>本文是《IPv6系列》文章的第一篇《入门指南》，用于快速了解并上手IPv6。</p><p><strong>小慢哥的原创文章，欢迎转载</strong></p><h3 id="一-为什么要了解IPv6"><a href="#一-为什么要了解IPv6" class="headerlink" title="一. 为什么要了解IPv6"></a>一. 为什么要了解IPv6</h3><p>你以为我会讲些<strong>“正确的废话”</strong>，比如IPv6地址空间巨大，可以让地球上的每一粒沙子拥有一个IP地址？比如IPv6更加安全？</p><p><strong>错！</strong>我才不在意这些，这跟我们有什么关系。</p><p>我要讲的，是不上IPv6，会有哪些后果。</p><p>1️⃣ <strong>势不可挡</strong>：各大运营商已经在全面铺设IPv6，包括手机、家庭宽带，比如笔者所在地福州的移动4G手机，已经获得IPv6地址。</p><p>2️⃣ <strong>坐以待毙</strong>：当IPv6占用率达到一定比例的时候，我相信已有的网站、新申请备案的网站，会被强制要求上IPv6，如果不配置，已有网站停止运营、申请备案不予通过。甚至，到那时，手机、家庭宽带，会仅获得IPv6地址，无法获得IPv4地址。最后，IPv4从中国互联网中废除。</p><p>通过上述2点，可以知道，<strong>作为服务端（如WEB服务提供方）是必须要上IPv6的</strong>，否则不仅无法运营、连用户也都无法访问。</p><p><strong>那么，内网需要IPv6吗</strong></p><p>▪ 家庭内网，比如连着wifi的手机、电脑</p><p>▪ 企业内网，比如办公室内每个工位上的电脑</p><p>▪ 数据中心内网，比如机房内的服务器、公有云主机</p><p>这些内网环境，是否也需要配置ipv6地址？</p><p>答：<strong>只要你想访问IPv6互联网，就必须要在终端上配置IPv6地址</strong>。原因在于<strong>“IPv6优先原则”</strong>，越来越多的程序，比如各大编程语言的许多主流模块&#x2F;框架，在进行域名解析时，会通过dns优先查询AAAA记录（对应IPv4的A记录） ，若该域名有提供IPv6访问，就必然会解析出AAAA记录。接着，就会优先通过IPv6来访问（即使本机没有配置IPv6，甚至没有启用IPv6），如果IPv6网络不通，则该访问直接失败，即便有的模块&#x2F;框架在失败后会尝试IPv4，但已经增加了许多的延时</p><p><strong>综上所述，IPv6已经来临，而不是还在讨论中，现在没有任何理由继续固守IPv4了。与其坐以待毙，不如主动学习</strong></p><hr><h3 id="二-顾虑：IPv6地址太复杂了，记不住啊"><a href="#二-顾虑：IPv6地址太复杂了，记不住啊" class="headerlink" title="二. 顾虑：IPv6地址太复杂了，记不住啊"></a>二. 顾虑：IPv6地址太复杂了，记不住啊</h3><p>说的好像IPv4地址你能背下来似的，其实IPv6地址只是长度增加，并且展示方式从十进制改为十六进制，具体的计算方式是一样的。而且有dns在，没必要去背IP地址，就算是内网的IPv6地址，也可以通过DHCPv6或者路由器发送RA包来自动生成IPv6地址。</p><hr><h3 id="三-顾虑：每台服务器都有IPv6地址，会暴露整个内网，不安全"><a href="#三-顾虑：每台服务器都有IPv6地址，会暴露整个内网，不安全" class="headerlink" title="三. 顾虑：每台服务器都有IPv6地址，会暴露整个内网，不安全"></a>三. 顾虑：每台服务器都有IPv6地址，会暴露整个内网，不安全</h3><p>担心是对的，但解决方案也和IPv4一样，有2种：</p><p>▷ 可以在内网服务器上配置<strong>“IPv6私网地址”</strong>，这样公网就访问不到了。在IPv6中，私网地址是<code>fd00::/8</code>，这相当于IPv4的10.0.0.0&#x2F;8、172.16.0.0&#x2F;12、192.168.0.0&#x2F;16。然后在网关上配置<strong>NAT</strong></p><p>▷ 依然用“IPv6公网地址”（即全球单播地址），但在网关上配置<strong>“有状态防火墙”</strong></p><p>无论是哪种方案，最终都实现了“只出不进”，即服务器可以主动访问IPv6公网，但公网无法主动访问进来，保证了内网的安全。</p><hr><h3 id="四-顾虑：IPv6地址有好几种类型，很难区分和记忆"><a href="#四-顾虑：IPv6地址有好几种类型，很难区分和记忆" class="headerlink" title="四. 顾虑：IPv6地址有好几种类型，很难区分和记忆"></a>四. 顾虑：IPv6地址有好几种类型，很难区分和记忆</h3><p>什么全球单播、唯一本地、链路本地，类型太多了吧？其实，常用的IPv6地址，在IPv4中都能一一对应找到。</p><p>▷ <strong>全球单播</strong>：对应IPv4的公网</p><p>▷ <strong>唯一本地</strong>：对应IPv4的私网</p><p>▷ <strong>链路本地</strong>：在IPv4中也有对应，就是<code>169.254.x.x</code>（这在IPv4中也叫链路本地）</p><p>至于其他类型的地址，要不然是被废弃的，要不然就是很少用到的，除非工作所需碰到，否则完全不用理会，上面这3种类型已经足够用了。除了这3种，下面这2个特殊地址一定很常见</p><p>▷ <code>::1</code>，表示环回地址，对应IPv4中的<code>127.0.0.1</code></p><p>▷ <code>::</code>，表示未指定地址，对应IPv4中的<code>0.0.0.0</code></p><hr><h3 id="五-需要学哪些知识"><a href="#五-需要学哪些知识" class="headerlink" title="五. 需要学哪些知识"></a>五. 需要学哪些知识</h3><p>▷ 开发、测试、DBA：只需简单了解IPv6即可，也就是本文看明白后基本就够了</p><p>▷ 运维人员：除了需要了解IPv6，还需要掌握IPv6通讯的工作原理、防火墙的配置等等，详见《IPv6系列》后续文章</p><p>▷ 网工：需要深入了解IPv6，包括IPv6的各类数据包格式、各种架构、多播路由通讯等等</p><hr><h3 id="六-IPv6基础知识"><a href="#六-IPv6基础知识" class="headerlink" title="六. IPv6基础知识"></a>六. IPv6基础知识</h3><p>关于IPv6的教程，网络上已经有非常多写的很棒的教程了，笔者没有把握能写出更好的，因此《IPv6系列》文章，将把重点放在一些概念、解决方案、很多人没注意到的坑、工作原理等等</p><p><strong>IPv6地址长度</strong></p><p>▷ IPv4：32 bit</p><p>▷ IPv6：128 bit</p><p>可以这么记忆，IPv6比IPv4多了一倍的段落，并且每个段落里增加了一倍的长度，所以IPv6比IPv4长了2x2&#x3D;4倍</p><p><strong>IPv6地址组成</strong></p><p>▷ IPv4：网络号+主机号&#x2F;子网掩码，如<code>192.168.1.2/24</code></p><p>▷ IPv6：前缀ID+接口ID&#x2F;前缀长度，如<code>2001:0000:0000:0000:0011:0000:0000:0010/64</code></p><p><strong>地址简写</strong></p><p>▷ IPv4：不支持</p><p>▷ IPv6：压缩0</p><p>注意：IPv6单个段落内可重复压缩，比如上述可压缩为2001:0:0:0:11:0:0:10&#x2F;64；若多个段落连续为0，可压缩，但只能压缩一次，比如上述可进一步压缩为2001::11:0:0:10&#x2F;64，或者2001:0:0:0:11::10&#x2F;64，通常为前者</p><p><strong>检验方法</strong></p><p>找一台linux服务器，比如centos7系统，执行<code>ip addr add $&#123;IPv6地址&#125; dev eth0</code>，然后<code>ip addr show dev eth0</code>看一下会如何压缩</p><p><strong>IPv6地址分类</strong></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/80f2e7d5f7c6d072081394044f0a7da5.jpg"></p><p>注意：表格列出的是比较常见的地址，并非全部地址</p><p>另外，除了单播、多播，IPv6相比IPv4新增了一种任播（anycast），任播是属于单播范畴内的，无法单纯从地址识别出任播</p><p><strong>术语</strong></p><p>▪ 节点：任何运行IPv6的设备</p><p>▪ 路由器：转发不是发给自己的IPv6报文的节点</p><p>▪ 主机：非路由器的节点</p><p>▪ 接口：节点和链路相连的物理或逻辑配件</p><p>▪ 链路：由路由器分割的网络接口集合</p><p>▪ 邻居：同一链路上的节点</p><p>▪ 链路MTU：链路能传输的最大单位，即最大的IPv6报文字节数</p><p>▪ 路径MTU：IPv6源端和目的端之间能传输的最大的IPv6报文字节数，通常是路径中所有链路的最小链路MTU</p><hr><h3 id="七-IPv6地址生成"><a href="#七-IPv6地址生成" class="headerlink" title="七. IPv6地址生成"></a>七. IPv6地址生成</h3><p>▷ IPv4：手工指定、dhcp分配</p><p>▷ IPv6：手工指定、dhcp分配、自动生成</p><p>在IPv6里，主流方案就是<strong>自动生成IP</strong>，而不是手工指定或dhcp分配。当然，作为服务端是需要手工指定的，但对于更广阔的客户端来说，基本都是自动生成。这种自动生成的，叫做“无状态”，相对于“无状态”，通过dhcp获取到的固定IP，就叫做“有状态”（dhcp也支持“无状态”，这里不做详解）</p><p>除了协议规定的特殊地址，其他可自行分配的地址，都是可以在具体范围内自动生成的，包括链路本地、全球单播、唯一本地。其中全球单播、唯一本地，是在接收到路由器发送的RA包后自动生成，具体生成的是全球单播还是唯一本地，是根据RA包内容中的前缀而定</p><p><strong>如何自动生成的</strong></p><p>无需关心，只要记住一点，能用即可。因为有多种自动生成的方法，有通过mac地址换算而来，有通过某种算法获得，也可能是完全随机而来，而且有的自动生成的地址还会每隔一段时间自动更换，不同的操作系统实现方法不一样，无法统一</p><p><strong>为什么会出现这种无法统一的情况</strong></p><p>原因在于IPv6协议一直在发展，新协议推翻老协议，每个实现者（也就是不同的操作系统）的诞生时间不同，所参考的协议就有可能不同，而且有的协议还支持不只一种方式，不同实现者出于不同的考量就会采用不同的方式。怎么办？没办法，要不然不理会，要不然投入精力去研究其不同之处，没有一劳永逸的方法。（这段话不仅适用IPv6地址，还适用其他方面，比如DHCPv6等等）</p><hr><h3 id="八-常用命令"><a href="#八-常用命令" class="headerlink" title="八. 常用命令"></a>八. 常用命令</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text"># 查看ipip -6 addr# 查看路由ip -6 route# 查看多播地址ip -6 maddrnetstat -gn# 查dns AAAA记录（走ipv4线路）dig -t AAAA fzxiaomange.comnslookup -query=AAAA fzxiaomange.com# 查dns AAAA记录（走ipv6线路）dig @2620:0:ccc::2 -6 -t AAAA fzxiaomange.com nslookup -query=AAAA fzxiaomange.com 2620:0:ccc::2# 查dns AAAA记录（走ipv6线路的最纯粹、最完整、最靠谱方法）dig @2620:0:ccc::2 -t AAAA -6 fzxiaomange.com +trace# curlcurl -6 https://fzxiaomange.com# pingping6 fzxiaomange.com# trace routemtr -6 fzxiaomange.comtraceroute6 fzxiaomange.comtracert6 fzxiaomange.comtracepath6 fzxiaomange.com# 邻居地址解析，类似ipv4的arpingndisc6 -n 2002::102 eth0# iptables查看ip6tables-save# tcpdumptcpdump -nnn -i eth0 ip6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="九-在线测试工具"><a href="#九-在线测试工具" class="headerlink" title="九. 在线测试工具"></a>九. 在线测试工具</h3><p>▷ <strong>公共dns列表</strong></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">https://dns.icoa.cn/ipv6/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>▷ <strong>查询网站是否提供IPv6</strong></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">https://ready.chair6.net/http://ip6tools.com/#checkWebServer<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>▷ <strong>查询我自己是否拥有公网IPv6地址</strong></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">http://www.test-ipv6.comhttp://ip6tools.com/#WhatisMyIPv6Address<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><hr><h3 id="十-开启与关闭IPv6"><a href="#十-开启与关闭IPv6" class="headerlink" title="十. 开启与关闭IPv6"></a>十. 开启与关闭IPv6</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text"># 检查ipv6是否开启sysctl -a | grep ipv6 | grep disable # 如果输出的值是一堆0则表示ipv6是开启的ip -6 addr | grep inet6，如果有看到fe80则表示ipv6是开启的# 临时禁用ipv6sysctl -w net.ipv6.conf.all.disable_ipv6=1# 临时开启ipv6sysctl -w net.ipv6.conf.all.disable_ipv6=0# 彻底禁用ipv6在grub里添加ipv6.disable=1，然后重启操作系统<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="十一-在CentOS7上配置静态IPv6地址"><a href="#十一-在CentOS7上配置静态IPv6地址" class="headerlink" title="十一. 在CentOS7上配置静态IPv6地址"></a>十一. 在CentOS7上配置静态IPv6地址</h3><p>1️⃣ <strong>内核参数</strong></p><pre class="line-numbers language-text" data-language="text"><code class="language-text"># /etc/sysctl.conf里增加net.ipv6.conf.all.disable_ipv6=0net.ipv6.conf.default.disable_ipv6=0net.ipv6.conf.lo.disable_ipv6=0# 立即生效sysctl -p<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2️⃣ <strong>&#x2F;etc&#x2F;sysconfig&#x2F;network里增加一行</strong></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">NETWORKING_IPV6=yes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3️⃣ <strong>&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eth0</strong></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">DEVICE=eth0BOOTPROTO=noneONBOOT=yesIPV6INIT=yesIPV6ADDR=2002::102/64IPV6_DEFAULTGW=2002::1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>4️⃣ <strong>重启网络</strong></p><pre class="line-numbers language-text" data-language="text"><code class="language-text">systemctl restart network<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h3 id="十二-如何让我的网站对外提供IPv6服务"><a href="#十二-如何让我的网站对外提供IPv6服务" class="headerlink" title="十二. 如何让我的网站对外提供IPv6服务"></a>十二. 如何让我的网站对外提供IPv6服务</h3><p>1️⃣ <strong>找你的运营商要IPv6地址</strong></p><p>▷ 如果你的服务器是托管在电信机房里，那么就找电信运营商要，通常会给你一个&#x2F;48或&#x2F;56的地址段 ▷ 如果你的服务器用的是公有云，比如阿里云、腾讯云，就找他们要，只不过由于IPv6还未全面普及，因此有的地域有提供IPv6，有的没有。另外，提供IPv6的方案也不完全一样，有的是以双栈方式，就是你的云主机里可以直接看到IPv6地址，而有的是负载均衡或者弹性IP方式提供。笔者的网站是放在腾讯云上，用的就是IPv6的L4负载均衡</p><p>2️⃣ <strong>接下来，在dns里为自己的网站域名增加AAAA记录</strong>。（其实现在很多大厂dns服务器，即NS，还未提供纯IPv6线路的解析，比如笔者的个人网站域名解析商当前不支持ipv6-only，这点会在后续文章里进行详细说明）</p><p>3️⃣ <strong>最后一步，测试IPv6</strong>，可通过<code>https://ready.chair6.net/</code>进行查询</p><p>这里展示下笔者个人网站支持IPv6后的效果</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/253cd4de6fbe4627ee20216474fbc83b.jpg"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/0f33a53f994cbec40eb1ec3942219828.jpg"></p><h2 id="IPv6系列-初学者的10个常见困扰"><a href="#IPv6系列-初学者的10个常见困扰" class="headerlink" title="IPv6系列-初学者的10个常见困扰"></a>IPv6系列-初学者的10个常见困扰</h2><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/37c936a76dcba1dd60e8a8ff6667f949.png"></p><p>本文是《IPv6系列》文章的第二篇《常见困扰》，紧接《入门指南》，用于解答IPv6的10个常见困扰。</p><p><strong>小慢哥的原创文章，欢迎转载</strong></p><h3 id="本文缘由"><a href="#本文缘由" class="headerlink" title="本文缘由"></a>本文缘由</h3><p>在笔者的上一篇文章《IPv6系列-入门指南》里，简要阐述了以下内容：</p><p>▷ 掌握IPv6的必要性</p><p>▷ IPv6的3个常见顾虑</p><p>▷ IPv6基础知识</p><p>▷ 常用测试方法</p><p><strong>而在进一步的实践学习中，会遇到很多的困扰</strong>。笔者结合自己以及身边的同行兄弟们遇到的困扰，精心挑选出<strong>10个困扰</strong>在本文中进行解答。</p><p><strong>如果没有阅读过《IPv6系列-入门指南》，敬请劳神垂阅，以便知识的连贯。</strong></p><hr><h3 id="困扰1-IPv4和IPv6只有地址格式不同吗"><a href="#困扰1-IPv4和IPv6只有地址格式不同吗" class="headerlink" title="困扰1. IPv4和IPv6只有地址格式不同吗"></a>困扰1. IPv4和IPv6只有地址格式不同吗</h3><p>除了地址格式不同，IPv4与IPv6协议栈也不同，他们在逻辑上是<strong>完全不同的2个世界</strong></p><p>以下实践中经常会遇到的4个不同之处：</p><p>▷ <strong>基本通讯过程</strong>：ND替代ARP、多播替代广播、fe80地址成为标配、ICMP成为通讯核心</p><p>▷ <strong>IP配置方式</strong>：客户端以无状态自动配置IP成为主流，弱化DHCP</p><p>▷ <strong>DNS域名解析</strong>：AAAA记录替代IPv4的A记录、对应用存在优先级问题（优先解析AAAA还是A）</p><p>▷ <strong>应用层适应性</strong>：socket编程中AF_INET仅支持IPv4，AF_INET6仅支持IPv6</p><hr><h3 id="困扰2-IPv4到IPv6对应用程序是透明无感知的吗"><a href="#困扰2-IPv4到IPv6对应用程序是透明无感知的吗" class="headerlink" title="困扰2. IPv4到IPv6对应用程序是透明无感知的吗"></a>困扰2. IPv4到IPv6对应用程序是透明无感知的吗</h3><p><strong>错，是有感知的</strong>，上层应用程序需要进行改造。</p><p>举个例子，当访问<a href="https://link.zhihu.com/?target=http://fzxiaomange.com">http://fzxiaomange.com</a>时候，是要优先解析IPv6地址（AAAA）还是IPv4地址（A），因为总得选一条线路来发送请求。现在许多框架会优先选择IPv6。</p><p>注意：如果解析出AAAA记录，即使本机没有可路由IPv6地址，也有可能<strong>依然尝试通过IPv6进行请求，导致请求失败</strong>。</p><p>还有一个典型的例子，是程序会在<strong>应用层里交互底层IP地址</strong>，比如FTP主动模式会在应用层里交互IPv4地址，而如果实际可用的是IPv6地址，就可能导致后续连接的异常。</p><p><strong>无法做到透明无感知，是导致产生IPv4到IPv6的部分过渡方案的原因之一。</strong></p><hr><h3 id="困扰3-提供WEB服务，需要每台服务器都配置IPv6地址吗"><a href="#困扰3-提供WEB服务，需要每台服务器都配置IPv6地址吗" class="headerlink" title="困扰3. 提供WEB服务，需要每台服务器都配置IPv6地址吗"></a>困扰3. 提供WEB服务，需要每台服务器都配置IPv6地址吗</h3><p>现在有一种言论，说“IPv6地址无限多，每台服务器都可以配一个IP地址，不用做NAT”。</p><p><strong>这很容易误导人，具体如何使用IPv6，还得根据场景而定</strong>。比如笔者的个人博客<a href="https://link.zhihu.com/?target=http://fzxiaomange.com">http://fzxiaomange.com</a>，由nginx-&gt;php-&gt;mysql组成，分别位于3台服务器上，那只需要在nginx上配置IPv6地址，并在DNS上添加一条AAAA记录指向L7的IPv6地址即可。完全没必要在php、mysql服务器上配置IPv6地址，而且一旦配置了，就直接暴露内网了。</p><p>每个设备都配置IPv6，主要适用于<strong>偏客户端以及地址需求量大的场景</strong>，诸如物联网设备、手机4G、家庭宽带等。</p><p>另外，<strong>IPv6有NAT</strong>，适用于办公PC、机房服务器等需要访问IPv6网络，而不想被别人主动访问的场景。</p><hr><h3 id="困扰4-IPv4和IPv6要配在同一张网卡上吗"><a href="#困扰4-IPv4和IPv6要配在同一张网卡上吗" class="headerlink" title="困扰4. IPv4和IPv6要配在同一张网卡上吗"></a>困扰4. IPv4和IPv6要配在同一张网卡上吗</h3><p>都可以，首先需要先了解2个词<strong>“单栈”</strong>和<strong>“双栈”</strong>：</p><p><strong>以节点为角度</strong>（通用的解释）：</p><p>▷ 单栈：表示一个IPv6节点，也就是一台服务器，或一部手机，仅有IPv6地址，或仅有IPv4地址，前者叫做<strong>“IPv6单栈”</strong>或<strong>“IPv6-Only”</strong>，后者叫<strong>“IPv4单栈”</strong>或<strong>“IPv4-Only”</strong>。</p><p>▷ 双栈：表示一个IPv6节点，同时拥有IPv6地址和IPv4地址</p><p><strong>以网卡为角度</strong>：</p><p>▷ 单栈：表示一张网卡仅有IPv6地址，或仅有IPv4地址，示意图如下</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/f21b4d8e96607f197ba0d97118295083.jpg"></p><p>▷ 双栈：表示一张网卡同时拥有IPv6地址和IPv4地址</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/deaac12bbff297fc72f58d77c3c34234.jpg"></p><p>IPv4和IPv6在逻辑上是两个完全不相交的世界。如果终端处位于同一个物理层，比如同一个VLAN，那么网卡就只能同时配置IPv6地址和IPv4地址；反之，就必须一张网卡配置IPv6，另一张网卡配置IPv4。所以，<strong>关键看网络架构是如何设计，各有利弊</strong>。比如放同一张网卡上，就可以做到带宽共享，而放不同网卡，可以做到带宽分别限制与计费。</p><hr><h3 id="困扰5-我的网卡有fe80开头的地址，可以用来上公网吗"><a href="#困扰5-我的网卡有fe80开头的地址，可以用来上公网吗" class="headerlink" title="困扰5. 我的网卡有fe80开头的地址，可以用来上公网吗"></a>困扰5. 我的网卡有fe80开头的地址，可以用来上公网吗</h3><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/4bae6ef9c7a1cd66d2ab80b721663c93.jpg"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/c8021af47bca6d82faca1593dbedda6a.jpg"></p><p>当网卡启动的时候，会自动生成<strong>“链路本地地址”（Link-Local Address）</strong>，这是一个<strong>fe80::&#x2F;10</strong>的单播地址。“链路本地地址”用于<strong>IP自动配置</strong>、<strong>邻居发现</strong>等。</p><p><strong>注意事项</strong>：</p><p>▷ 核心：每张网卡都会存在“链路本地地址”，这是IPv6协议通讯的核心，不应当删掉</p><p>▷ 范围：仅在同一个二层范围内进行传播，不会被路由器做转发</p><p>▷ 地址：“链路本地地址”的算法不统一，有的操作系统会根据mac地址计算而来（EUI-64），而有的则是随机或其他某种算法计算而来</p><p>▷ 服务：“链路本地地址”虽然可以在二层内互通，但主要用于核心通讯以及某些网络高级协议。不适用于上层应用业务之间的通讯。因此不能用来上公网，也不能用于对外提供服务</p><hr><h3 id="困扰6-IPv6地址如何配置"><a href="#困扰6-IPv6地址如何配置" class="headerlink" title="困扰6. IPv6地址如何配置"></a>困扰6. IPv6地址如何配置</h3><p><strong>公网地址和私网地址</strong></p><p>▷ 公网地址：“全球单播地址”（Global Unicast Address，2000::&#x2F;3）</p><p>▷ 私网地址：“唯一本地地址”（Unique-Local Address，fc00::&#x2F;7）</p><p>细心的人可能会发现，为什么这里叫做“全球单播地址”，而“唯一本地地址”却不叫做“唯一本地单播地址”，好吧，其实都是简称，在RFC里是这么定义的：“Global Unicast Addresses”、“Link-Local IPv6 Unicast Addresses”。其实“全球单播地址”是可以叫做“全球地址”的，只是这样显得有点别扭。</p><p><strong>自动生成还是固定IP</strong></p><p>在IPv6里，任何单播地址都可以自动生成，也可以手工配置固定IP，具体看应用场景：</p><p>▷ 客户端：如果我想访问ipv6互联网，而不对外提供服务，那么使用自动生成即可，无需使用固定的ip地址</p><p>▷ 服务端：如果需要对外提供服务，那么ip地址就需要固定了，不能使用自动生成</p><p><strong>自动配置IP</strong></p><p>在ipv6里还分为2种方法：“有状态”与“无状态”</p><p>▷ 有状态（Stateful）：地址由DHCPv6 Server统一管理，DHCPv6 Client从中获得一个可用的IP地址</p><p>▷ 无状态（Stateless，简称<strong>SLAAC</strong>）：路由器发出<strong>“路由通告”报文（Router Advertisement，简称RA）</strong>，报文内包含了IPv6地址的前缀信息。当收到RA包后，就会根据其中前缀信息，自动生成一个或多个IP地址</p><hr><h3 id="困扰7-没有了ARP，如何解析MAC地址"><a href="#困扰7-没有了ARP，如何解析MAC地址" class="headerlink" title="困扰7. 没有了ARP，如何解析MAC地址"></a>困扰7. 没有了ARP，如何解析MAC地址</h3><p>ARP协议是IPv4用于解析目标MAC地址的协议，而在IPv6里，解析地址采用的是<strong>邻居发现（Neighbor Discovery Protocol，简称NDP或ND）</strong></p><p>ND不是一个具体协议，而是用来描述多个相关功能的协议的<strong>抽象集合</strong>，所涵盖的所有协议均是基于ICMPv6。其中有2种报文与解析MAC地址有关：</p><p>▷ <strong>邻居请求报文NS（Neighbor Solicitation）</strong>：请求解析</p><p>▷ <strong>邻居通告报文NA（Neighbor Advertisement）</strong>：响应解析</p><p>这与ping是非常类似的：</p><p>▷ ping：发送icmp的echo request报文，对端响应icmp的echo reply报文</p><p>▷ 地址解析：发送icmp的ns报文，对端响应icmp的na报文</p><hr><h3 id="困扰8-IPv6使用多播替代广播，需要做哪些改造"><a href="#困扰8-IPv6使用多播替代广播，需要做哪些改造" class="headerlink" title="困扰8. IPv6使用多播替代广播，需要做哪些改造"></a>困扰8. IPv6使用多播替代广播，需要做哪些改造</h3><p>IPv6使用多播替代了广播，多播的特点是不会像广播那样完全泛洪，而是数据包只发送给加入了多播组的机器。</p><p>但是，这有个前提，就是<strong>交换机要能识别并维护多播组的信息</strong>，主流交换机都具备此功能，然而并不都是默认开启的。对于二层交换机来说，需要开启<strong>MLDv2 Snooping</strong>。</p><p>顾名思义，就是交换机会识别<strong>“MLDv2成员报告”</strong>报文从哪个端口发来的，并记录下来，之后当交换机收到多播包后，会先查找其多播地址是否能在缓存里匹配上</p><p>▷ 匹配成功：仅会将数据包从相应的端口发出</p><p>▷ 匹配失败：就会泛洪，此时和广播毫无差异</p><hr><h3 id="困扰9-IPv6真的安全吗"><a href="#困扰9-IPv6真的安全吗" class="headerlink" title="困扰9. IPv6真的安全吗"></a>困扰9. IPv6真的安全吗</h3><p><strong>理想很美好</strong>，IPv6从设计之初，就进行了大量的安全方面的设计，“完整的”IPv6在安全方面有至少以下3个优势：</p><p>▷ 原生支持的端到端加密</p><p>▷ 安全的邻居发现（<strong>Secure Neighbor Discovery，简称SEND</strong>）</p><p>▷ 更大的地址空间</p><p><strong>现实很残酷</strong>，只有第3点发挥了作用，更大的地址空间，减少了被非法扫描到的概率。而第1、2点并没真正普及起来，因为<strong>协议本身就很复杂、学习难度很大、实现起来也很不容易</strong>。因此IETF为了加速IPv6的普及，<strong>对安全性不再强制要求</strong>。这也导致了IPv6实际上并没有预期中的那么安全，在IPv4里存在的地址欺骗、虚假网关等情况，在IPv6里依然存在。</p><hr><h3 id="困扰10-如何学习IPv6"><a href="#困扰10-如何学习IPv6" class="headerlink" title="困扰10. 如何学习IPv6"></a>困扰10. 如何学习IPv6</h3><p>网上能找到非常多的IPv6教程，其中有很多教程都是通篇讲IPv6地址、IP包格式、ICMP包格式，这很容易让初学者打退堂鼓。笔者虽然不是专业的网工，但愿能抛砖引玉，推荐的学习步骤如下：</p><p>1️⃣ IPv6的历史、设计理念</p><p>2️⃣ IPv6的地址格式、分类、前缀计算，以及与IPv4的对比</p><p>3️⃣ IP地址、网关路由的配置与查看</p><p>4️⃣ 服务端实践，尝试给自己的网站增加IPv6</p><p>5️⃣ 客户端实践，让自己的PC访问IPv6互联网</p><p>6️⃣ 应用层实践，自己写一对C&#x2F;S程序，能同时支持IPv4与IPv6</p><p>7️⃣ IPv6通讯原理，抓包分析每个包，熟悉ND、DHCPv6等</p><p>8️⃣ IPv4与IPv6的互访、过渡</p><p>9️⃣ IPv6安全</p><p>具体领域的IPv6，例如移动IPv6</p><h3 id="后续说明"><a href="#后续说明" class="headerlink" title="后续说明"></a>后续说明</h3><p>在《IPv6系列》后续文章中，笔者会有选择性地对“困扰10”中提到的部分内容整理成文。为什么是有选择性，因为笔者并非网工出身，没有把握写出更好的文章，不能误人子弟。</p><h2 id="IPv6通讯原理-不能忽略的网卡启动过程"><a href="#IPv6通讯原理-不能忽略的网卡启动过程" class="headerlink" title="IPv6通讯原理-不能忽略的网卡启动过程"></a>IPv6通讯原理-不能忽略的网卡启动过程</h2><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/30d4798cac8469bb243a3e71d2417406.png"></p><p><strong>本文主题：通过抓包分析，深入观察网卡启动过程的每个步骤，从而逐步掌握通讯原理。</strong></p><p>小慢哥的原创文章，欢迎转载</p><h3 id="一-为什么不能忽略网卡启动过程"><a href="#一-为什么不能忽略网卡启动过程" class="headerlink" title="一. 为什么不能忽略网卡启动过程"></a>一. 为什么不能忽略网卡启动过程</h3><p>掌握网络技术，除了看RFC协议外，最直接高效的方法就是<strong>“亲眼所见”</strong>。</p><p>其中<strong>抓包分析</strong>是最为关键的方法，能了解到：</p><p>▷ What：对应哪个协议</p><p>▷ Why：协议用途</p><p>▷ When：协议之间的关联</p><p>▷ How：报文地址和内容</p><p><strong>网卡启动是网络通讯的第一步，只有夯实基础方能展翅高飞。</strong></p><hr><h3 id="二-实验环境"><a href="#二-实验环境" class="headerlink" title="二. 实验环境"></a>二. 实验环境</h3><p>本文以CentOS 7为实验环境，创建两个network namespace（名字分别为ns1和ns2），并通过veth网卡桥接到同一个linux bridge（名字为br0），来模拟最简单的环境，即两台同二层服务器。</p><p><strong>先贴出mac地址：</strong></p><p>▷ ns1内的mac：52:54:00:00:00:01</p><p>▷ ns2内的mac：52:54:00:00:00:02</p><p><strong>实验步骤：</strong></p><p>1️⃣ 在ns1里启动网卡，但不抓包查看</p><p>2️⃣ 在ns2里启动网卡，同时在br0上进行抓包分析</p><p><strong>观察：</strong></p><p>▷ ns2会产生哪些包</p><p>▷ ns1是否会对ns2进行响应</p><p><strong>本文最后会附上实验脚本和抓包文件的下载地址。</strong></p><hr><h3 id="三-网卡启动前-x2F-后的样子"><a href="#三-网卡启动前-x2F-后的样子" class="headerlink" title="三. 网卡启动前&#x2F;后的样子"></a>三. 网卡启动前&#x2F;后的样子</h3><p><strong>网卡启动前的样子</strong></p><p>在ns2里启动网卡之前，先对ns2里的网络环境进行查看，命令如下</p><pre class="line-numbers language-text" data-language="text"><code class="language-text"># 查看网卡状态ip netns exec ns2 ip link# 查看ipv6地址ip netns exec ns2 ip -6 addr# 查看ipv6路由ip netns exec ns2 ip -6 route# 查看ipv6多播地址ip netns exec ns2 ip -6 maddr<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/a056d63382f3ae63879d847f413eec00.jpg"></p><p>可以看到此时eth0处于DOWN的状态，接下去，对eth0进行UP。</p><p><strong>网卡启动后的样子</strong></p><pre class="line-numbers language-text" data-language="text"><code class="language-text"># 启动网卡ip netns exec ns2 ip link set eth0 up<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>进入ns2里查看</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/6ad97e9aedd84c9fa88fadd3f0427af0.jpg"></p><p>可以看到，此时网卡已启动，并获得了一个链路本地地址（图中fe80开头的）</p><p><strong>抓到了哪些包呢</strong></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/f6aa5bbb42e9999d9c117e470b6ef114.jpg"></p><p>这些包都是什么意思，如何产生，为何产生，请接着往下看。</p><hr><h3 id="四-结论写在前"><a href="#四-结论写在前" class="headerlink" title="四. 结论写在前"></a>四. 结论写在前</h3><p>网卡启动过程一共有5步，详见示意图（右边的数字，表示对应抓包图中的第几个包）：</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/14e3edcc3155610a90421e7b786f8ef2.jpg"></p><p>接下来，将对这5步进行逐步讲解。</p><hr><h3 id="Step1-生成“链路本地地址”"><a href="#Step1-生成“链路本地地址”" class="headerlink" title="Step1. 生成“链路本地地址”"></a>Step1. 生成“链路本地地址”</h3><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/8982c1a63746fae52d8926bf8d851789.jpg"></p><p>（本步骤尚未产生数据包）</p><p><strong>“链路本地地址”是什么</strong></p><p>▷ 当网卡启动时会根据某种算法自动生成链路本地地址（Link-Local Address）。</p><p>▷ 具体生成的地址，与操作系统有关，有的根据MAC地址换算而来（EUI-64），有的则是随机生成，并不统一。</p><p>▷ “链路本地地址”是范围为<strong>fe80::&#x2F;10</strong>的单播地址。</p><p>▷ “链路本地”顾名思义，只在同一个二层内传播，不会被路由器转发。</p><p><strong>“链路本地地址”有什么作用</strong></p><p>▷ 地址自动配置</p><p>▷ 邻居发现协议</p><p>▷ 路由转发（可以作为下一跳地址）</p><hr><h3 id="Step2-生成“被请求节点多播地址”"><a href="#Step2-生成“被请求节点多播地址”" class="headerlink" title="Step2. 生成“被请求节点多播地址”"></a>Step2. 生成“被请求节点多播地址”</h3><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/e7bcb3f762a4ad609de2c487dfcf4edd.jpeg"></p><p>（本步骤尚未产生数据包）</p><p><strong>“被请求节点多播地址”是什么</strong></p><p>在IPv6的世界中，每生成一个ip地址（准确说是单播地址），无论什么类型，都会对应生成一个“被请求节点多播地址”（Solicited-Node multicast address）。</p><p>组成方式：<strong>FF02::1:FF00:0&#x2F;104 + 单播地址的最后24bit</strong>。可以看到，该地址是通过单播地址推导而成，不是随机的。上图中红框里的地址就是“链路本地地址”对应的“被请求节点多播地址”。</p><p><strong>为什么需要“被请求节点多播地址”</strong></p><p>就4个字：“地址解析”</p><p>▷ IPv4中用ARP做地址解析，ARP是基于广播的。</p><p>▷ IPv6没有广播，只有多播。既然是多播，就总得有一个多播地址才行，于是应运而生。</p><p><strong>“被请求节点多播地址”工作原理</strong></p><p>当他人想解析我的MAC地址时，发送一个“地址解析请求包”到这个多播地址，然后属于该多播地址的成员（也就是“我”）就会收到该数据包，最后“我”返回MAC地址给对方。这样就完成了“地址解析”的流程。</p><p><strong>“被请求节点”这5个字到底是什么意思</strong></p><p>别人请求解析我的地址，那么我就是被请求的节点。我生成“被请求节点多播地址”的目的，就是让别人能够请求到我。</p><hr><h3 id="Step3-“多播成员报告”"><a href="#Step3-“多播成员报告”" class="headerlink" title="Step3. “多播成员报告”"></a>Step3. “多播成员报告”</h3><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/26765d18e026b4842772eb19b851dc82.jpg"></p><p>（对应抓包图中的No. 1&#x2F;2&#x2F;4&#x2F;6）</p><p><strong>什么是“多播成员报告”</strong></p><p>▷ MLDv2协议（多播控制协议）中的一种报文类型（Membership Report）。</p><p>▷ 通俗理解就是对外宣称“我要加入某某多播组”。</p><p>▷ 成员报告是单向的，不会收到回应包。</p><p><strong>为什么要进行“多播成员报告”</strong></p><p>▷ 只要生成多播地址，就要进行成员报告，这是多播的工作机制。</p><p>▷ 成员报告的目的是为了减少网络中的多播流量。</p><p><strong>要报告的是哪个成员</strong></p><p>▷ 要报告的成员不是单播地址，而是多播地址。</p><p>▷ 这里指的就是“被请求节点多播地址”。即“我要加入ff02::1:ff00:2多播组”</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/348c4e45bdff97458839291728ea9ea2.jpg"></p><hr><h3 id="Step4-“重复地址检测”"><a href="#Step4-“重复地址检测”" class="headerlink" title="Step4. “重复地址检测”"></a>Step4. “重复地址检测”</h3><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/a903ebe32dc97f5368628b67b5f21427.jpg"></p><p>（对应抓包图中的No. 3）</p><p><strong>什么是“重复地址检测”</strong></p><p>▷ 为了防止IP地址冲突，每生成一个单播地址，都会进行一次“重复地址检测”（Duplicate Address Detection，简称DAD）。</p><p>▷ 此刻，就是对Step1生成的“链路本地地址”进行检测。</p><p><strong>何时进行“重复地址检测”</strong></p><p>▷ 在生成单播地址并完成发送一次“MLDv2成员报告”后，就会随机延时一小段时间进行检测。</p><p>▷ 在centos7里检测次数可通过内核参数net.ipv6.conf.eth0.dad_transmits进行修改，若设置为0表示不进行检测。</p><p><strong>“重复地址检测”的工作原理</strong></p><p>▷ 举个例子：我想给我家小狗取名，叫“球球”，但不想和邻居家的小狗重名，于是我大声喊：“球球”。如果没有任何狗狗看过来，那就可以认定此名字没有冲突。</p><p>▷ 专业解释：发送一个地址解析包（Neighbor Solicitation，简称NS），请求解析的地址就是自己的地址，并等待回应，若超时仍未得到回应（Neighbor Advertisement，简称NA），即可认为地址可用。</p><hr><h3 id="Step5-“无状态地址自动配置”"><a href="#Step5-“无状态地址自动配置”" class="headerlink" title="Step5. “无状态地址自动配置”"></a>Step5. “无状态地址自动配置”</h3><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/b618cbf680f1630ea8295bac67443cef.jpg"></p><p>（对应抓包图中的No. 5&#x2F;7&#x2F;8）</p><p><strong>什么是“无状态地址自动配置”</strong></p><p>在IPv6中，有2种自动配置IP地址的方法：</p><p>▷ DHCPv6：也叫做“有状态分配”</p><p>▷ SLAAC：“无状态地址自动配置”（Stateless Address Autoconfiguration）</p><p><strong>SLAAC的作用是什么</strong></p><p>▷ 自动配置IP地址</p><p>▷ 自动配置网关</p><p>注：这里说的IP地址，是指“全球单播地址”或者“唯一本地地址”，也就是俗称的公网地址和私网地址。而不是“链路本地地址”。</p><p><strong>工作原理</strong></p><p>涉及到这2种报文：</p><p>▷ “路由器请求”（Router Solicitation，简称RS）</p><p>▷ “路由器通告”（Router Advertisement，简称RA）</p><p>当收到路由器回应的RA报文后，就会根据报文中的IP前缀信息，自动生成IP地址，并将网关指向该路由器的“链路本地地址”。</p><p><strong>如何能够收到RA报文呢</strong></p><p>有2种办法：</p><p>▷ 路由器定期发送RA报文</p><p>▷ 自己主动发送RS报文，路由器收到后就会立刻回应RA报文</p><p>由于本次实验中没有路由器，因此截图中仅能看到主动发送的RS报文，而没有得到回应。</p><hr><h3 id="思考题"><a href="#思考题" class="headerlink" title="思考题"></a>思考题</h3><p>1️⃣ 在生成“全球单播地址”或“唯一本地地址”之后，还会采用“链路本地地址”做基础通讯吗？</p><p>2️⃣ 为什么“多播成员报告”可以减少网络中不必要的多播流量，接入层交换机要进行额外配置吗？</p><p>3️⃣ “地址重复”时，是否会自动更换IP？</p><p>4️⃣ RA包只能包含一个IP前缀信息吗？一个前缀只能生成一个IP地址吗？生成的地址是什么样的？</p><p>5️⃣ 若存在多台路由器，网关会指向谁？</p><p>6️⃣ 如果不想自动配置IP，只想手工配置IP，可以忽视RA包吗？如何忽视?</p><p>上述问题，将在《IPv6系列》的下一篇文章中进行解答。</p><hr><h3 id="附-实验脚本与抓包文件"><a href="#附-实验脚本与抓包文件" class="headerlink" title="附. 实验脚本与抓包文件"></a>附. 实验脚本与抓包文件</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text"># 实验脚本https://fzxiaomange.com/attachment/ipv6-init.sh# 抓包文件https://fzxiaomange.com/attachment/ipv6-init.pcap<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="IPv6系列-详解自动分配IPv6地址"><a href="#IPv6系列-详解自动分配IPv6地址" class="headerlink" title="IPv6系列-详解自动分配IPv6地址"></a>IPv6系列-详解自动分配IPv6地址</h2><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/3b459ee46b259fc9971e2d9ba6ed6d8b.png"></p><p><strong>深入研究自动分配IPv6地址的Stateless(无状态)与Stateful(有状态)方式</strong></p><p>小慢哥的原创文章，欢迎转载</p><h3 id="一-Link-Local-Address的生成方式"><a href="#一-Link-Local-Address的生成方式" class="headerlink" title="一. Link-Local Address的生成方式"></a>一. Link-Local Address的生成方式</h3><p>生成“链路本地地址”，有2种方式</p><p>▷ 手动配置</p><p>▷ 自动配置</p><p>其中“自动配置”根据算法，又分为</p><p>▷ eui64：根据mac地址换算而来</p><p>▷ stable_secret：跟随网络环境的变化而变化，处于固定网络环境时其值将固定</p><p>▷ random：随机生成</p><hr><h3 id="二-Global-Address的生成方式"><a href="#二-Global-Address的生成方式" class="headerlink" title="二. Global Address的生成方式"></a>二. Global Address的生成方式</h3><p><strong>生成“全球单播地址”（或者“唯一本地地址”），有2种方式</strong></p><p>▷ 手动配置</p><p>▷ 自动配置</p><p><strong>其中“自动配置”根据获取方式，又分为</strong></p><p>▷ 无状态（Stateless）：根据路由通告报文RA（Router Advertisement）包含的prefix前缀信息自动配置IPv6地址，组成方式是Prefix + (EUI64 or 随机)。Stateless也可以称为SLAAC（Stateless address autoconfiguration）</p><p>▷ 有状态（Stateful）：通过DHCPv6方式获得IPv6地址</p><p><strong>其中“有状态”又分为2种</strong></p><p>▷ 有状态DHCPv6（Stateful DHCPv6）：IPv6地址、其他参数（如DNS）均通过DHCPv6获取</p><p>▷ 无状态DHCPv6（Stateless DHCPv6）：IPv6地址依然通过路由通告RA方式生成，其他参数（如DNS）通过DHCPv6获取</p><p><strong>为了避免混淆，在此解释下有状态、无状态到底是什么意思</strong>：首先，请明确一点，有状态、无状态仅针对于IPv6地址分配方式，并不包含其他参数</p><p>▷ 有状态：可控、可管理。在网络中存在一个IP地址管理者，它能够识别客户端，根据不同的客户端，分配对应的IPv6地址，客户端与服务端之间需要维护IP地址的租期及续约。目前实现这种效果的，就是DHCPv6协议，IP地址管理者就是DHCPv6 Server</p><p>▷ 无状态：不可控、难管理。在网络中只有网关，没有IP地址管理者。因此无人去识别客户端，每个客户端根据网关发送的相同的RA报文内容，自行配置IPv6地址</p><hr><h3 id="三-RA报文中3个关键的Flag"><a href="#三-RA报文中3个关键的Flag" class="headerlink" title="三. RA报文中3个关键的Flag"></a>三. RA报文中3个关键的Flag</h3><p>RA报文中存在3个关键的flag bit：</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/4ea2db92dfe09d548ce81d25fa4b23ab.jpg"></p><p>▷ <strong>Autonomous flag</strong>（简称A flag）：表示是否配置无状态IP。在一个RA报文中，可存在多个prefix，比如2401::&#x2F;64、2402::&#x2F;64、2403::&#x2F;64，每个prefix都可以独立配置A flag</p><p>▪ 为on时（对应bit位为1）：表示客户端应当在该prefix范围内自动生成IPv6地址（客户端通过DAD自行保证地址可用），并配置子网路由条目、网关</p><p>▪ 为off时（对应bit位为0）：表示客户端不应当在该prefix范围内自动生成IPv6地址，但是可以配置子网路由条目、网关</p><p>▷ <strong>Managed flag</strong>（简称M flag）：表示是否配置有状态IP。M flag是RA报文的全局参数，一个RA报文只有一个M flag</p><p>▪ 为on时（对应bit位为1）：表示在stateless流程结束后开始stateful流程，也就是告诉客户端可以通过DHCPv6来获得IPv6地址和其他参数（如DNS列表）</p><p>▪ 为off时（对应bit位为0）：表示不通过DHCPv6来获得IPv6地址。</p><p>▷ <strong>Other flag</strong>（简称O flag）：表示是否通过DHCPv6获得除IP以外的其他参数（如DNS列表）。O flag也是RA报文中的全局参数，一个RA报文只有一个O flag。注意：仅当M flag为off时，该参数才会被读取。</p><p>▪ 为on时（对应bit位为1）：当M flag为on，或者M flag为off且至少有一个A flag为on时，将通过DHCPv6获得其他参数</p><p>▪ 为off时（对应bit位为0）：当M flag为on时，依然将通过DHCPv6获得其他参数；当M flag也为off时，将不通过DHCPv6获得其他参数</p><hr><h3 id="四-流程示意图"><a href="#四-流程示意图" class="headerlink" title="四. 流程示意图"></a>四. 流程示意图</h3><p>无状态和有状态并不是相互对立的，他们可以同时存在，也就是一张网卡上可以同时出现通过RA生成的IP以及通过DHCPv6获得的IP。通过下面这张笔者绘制的流程图可知晓其中奥秘。</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/6f275a37807de2fa1c10a0f2c91b1f21.jpg"></p><p>从图中可以看到，顺序为：</p><p>1️⃣ Stateless自动配置“链路本地地址”</p><p>2️⃣ Stateless自动配置“全球地址”（或“唯一本地地址”）</p><p>3️⃣ Stateful自动配置“全球地址”（或“唯一本地地址”）和其他参数，其中Stateful阶段中存在Stateful DHCPv6或Stateless DHCPv6</p><p>注意：部分客户端操作系统或网络管理器当Stateless阶段没有收到RA报文后，就到此结束，不会走Stateful阶段，比如CentOS 7、Ubuntu 17的默认逻辑都是这样，而windows server 2012就会继续走Stateful阶段。</p><hr><h3 id="五-测试获得IP效果"><a href="#五-测试获得IP效果" class="headerlink" title="五. 测试获得IP效果"></a>五. 测试获得IP效果</h3><p><strong>测试环境</strong>：客户端基于CentOS 7+NetworkManager（即系统默认的网络管理方式）进行测试</p><p>▪ 网关会发送RA报文，包含一个prefix</p><p>▪ DHCPv6 Server会分配IP、DNS</p><p><strong>测试内容</strong>：测试M、O、A flag在所有排列组合的情况下</p><p>▪ 客户端是否会通过RA报文配置无状态IP</p><p>▪ 客户端是否会通过RA报文配置prefix子网路由</p><p>▪ 客户端是否会通过RA报文配置gateway</p><p>▪ 客户端是否会通过DHCPv6获得有状态IP</p><p>▪ 客户端是否会通过DHCPv6获得DNS</p><p><strong>测试结果</strong>：</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/3c3124b9952bfbd8db63dd5667d35fd3.jpg"></p><hr><h3 id="六-应用场景（选择无状态还是有状态）"><a href="#六-应用场景（选择无状态还是有状态）" class="headerlink" title="六. 应用场景（选择无状态还是有状态）"></a>六. 应用场景（选择无状态还是有状态）</h3><p>何时采用无状态、何时采用有状态，关键看应用场景。核心在于是否需要控制IP地址，比如保持IP不变，如果需要控制，就采用有状态；如果无需控制，就采用无状态。</p><p>▷ 服务端领域：如对外提供服务，通常需要采用有状态IP。因为业务IP的突然变化容易导致业务中断（除非做好服务发现）</p><p>▷ 客户端领域：如移动设备、办公室内PC机，只需要上IPv6互联网，并不需要对外提供服务，可以采用无状态IP</p><hr><h3 id="七-后续内容"><a href="#七-后续内容" class="headerlink" title="七. 后续内容"></a>七. 后续内容</h3><p>由于篇幅有限，本文尚未贴出实验的详细配置。将会在《IPv6系列》后续文章里，贴出实验的完整信息，包括RA、DHCPv6的配置，以及客户端的配置，敬请关注。</p><hr><h3 id="附-参考文档"><a href="#附-参考文档" class="headerlink" title="附. 参考文档"></a>附. 参考文档</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">http://www.6deploy.eu/tutorials/080-6deploy_ipv6_autoconfiguration_mechs_v0_4.pdfhttps://cshihong.github.io/2018/02/01/DHCPv6基础/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 服务器运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 服务器运维 </tag>
            
            <tag> 网络 </tag>
            
            <tag> IPv6 </tag>
            
            <tag> DHCPv6 </tag>
            
            <tag> SLAAC </tag>
            
            <tag> 网络协议 </tag>
            
            <tag> IP地址 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>17种字体的官方下载链接</title>
      <link href="/posts/font-commonly-used-download.html"/>
      <url>/posts/font-commonly-used-download.html</url>
      
        <content type="html"><![CDATA[<h1 id="17种字体的官方下载链接"><a href="#17种字体的官方下载链接" class="headerlink" title="17种字体的官方下载链接"></a>17种字体的官方下载链接</h1><p>视频字幕设计专用，转自<a href="https://www.bilibili.com/video/BV1GY4y1U7oq">影视飓风</a></p><h2 id="一、免费商用字体"><a href="#一、免费商用字体" class="headerlink" title="一、免费商用字体"></a>一、免费商用字体</h2><p>思源黑体：<a href="https://fonts.adobe.com/fonts/source-han-sans-simplified-chinese">https://fonts.adobe.com/fonts/source-han-sans-simplified-chinese</a></p><p>方正黑体（gb2312-80）：<a href="https://www.foundertype.com/index.php/FontInfo/index/id/131">https://www.foundertype.com/index.php/FontInfo/index/id/131</a></p><p>得意黑：<a href="https://atelier-anchor.com/typefaces/smiley-sans/">https://atelier-anchor.com/typefaces/smiley-sans/</a></p><p>冬青黑体：<a href="http://www.tensentype.com/font/list.aspx?sid=1&key=%E5%86%AC%E9%9D%92%E9%BB%91">http://www.tensentype.com/font/list.aspx?sid=1&amp;key=%E5%86%AC%E9%9D%92%E9%BB%91</a></p><p>锐字真言体：<a href="http://www.reeji.com/font/da832bda4ceec4dfa51419a0bb6b467c">http://www.reeji.com/font/da832bda4ceec4dfa51419a0bb6b467c</a></p><p>MiSans：<a href="https://cdn.cnbj1.fds.api.mi-img.com/vipmlmodel/font/MiSans/MiSans.zip">https://cdn.cnbj1.fds.api.mi-img.com/vipmlmodel/font/MiSans/MiSans.zip</a></p><p>OPPO Sans：<a href="https://www.coloros.com/index/newsDetail?id=72">https://www.coloros.com/index/newsDetail?id=72</a> （点击文中【点此下载】即可）</p><p>文泉驿微米黑：<a href="http://wenq.org/wqy2/index.cgi?MicroHei">http://wenq.org/wqy2/index.cgi?MicroHei</a></p><p>字制区喜脉体：<a href="https://fontqu.com/download.html?popup_id=1000000367">https://fontqu.com/download.html?popup_id=1000000367</a> （但此官方下载链接已失效）</p><p>阿里巴巴普惠体：<a href="https://www.alibabafonts.com/#/font">https://www.alibabafonts.com/#/font</a></p><p>Adobe 黑体（汉字部分为华文黑体）：随Adobe正版软件同时获取授权</p><p>二、需购买或申请商用授权的字体</p><p>苹方：Mac OS、iOS系统自带</p><p>微软雅黑：Windows系统自带</p><p>中易宋体：Windows系统默认的「宋体」</p><p>中易黑体：Windows系统默认的「黑体」</p><p>华文黑体：可使用Adobe黑体平替</p><p>文悦新青年：<a href="https://wenyue.cn/fonts/506">https://wenyue.cn/fonts/506</a></p><p>龙门石碑体：<a href="https://www.dynacw.com.cn/product/product_download_detail.aspx?fid=47">https://www.dynacw.com.cn/product/product_download_detail.aspx?fid=47</a></p><p>三、单独授权字体</p><p>逗你玩趣黑体：<a href="https://www.hellofont.cn/font-detail?fontid=6498">https://www.hellofont.cn/font-detail?fontid=6498</a></p>]]></content>
      
      
      <categories>
          
          <category> 办公技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 视频剪辑 </tag>
            
            <tag> 视频制作 </tag>
            
            <tag> 字幕 </tag>
            
            <tag> 设计 </tag>
            
            <tag> 字体 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Lucky的STUN内网穿透利用UPNP和NAT1在公网打洞并配置伪DDNS</title>
      <link href="/posts/lucky-stun-upnp-nat1.html"/>
      <url>/posts/lucky-stun-upnp-nat1.html</url>
      
        <content type="html"><![CDATA[<h1 id="使用Lucky的STUN内网穿透利用UPNP和NAT1在公网打洞并配置伪DDNS"><a href="#使用Lucky的STUN内网穿透利用UPNP和NAT1在公网打洞并配置伪DDNS" class="headerlink" title="使用Lucky的STUN内网穿透利用UPNP和NAT1在公网打洞并配置伪DDNS"></a>使用Lucky的STUN内网穿透利用UPNP和NAT1在公网打洞并配置伪DDNS</h1><h2 id="背景-x2F-需求"><a href="#背景-x2F-需求" class="headerlink" title="背景&#x2F;需求"></a>背景&#x2F;需求</h2><p>我的要求很简单，就是在外网访问家里NAS服务器上的文件，实现远程办公</p><p>这时候有人会说，简单嘛，要个公网IP不就行了</p><p>好，下面就是本人办过的宽带和要公网IP的经历：</p><p>电信宽带，有公网IPv6地址，至于公网IPv4地址，我要不到</p><p>联通宽带，有公网IPv6地址，至于公网IPv4地址，听说很容易要到，不过我没有联通宽带</p><p>移动宽带，有公网IPv6地址，至于IPv4是不是公网，懂得都懂，目前我正在用</p><p>4G、5G网络，有公网IPv6地址，至于IPv4是不是公网，想都别想</p><blockquote><p>补充一些小常识：</p><p>公网IPv4地址可以通过NAT网关实现网络地址转换分配给多个设备，这个网关设备就是路由器，通过路由器上端口映射、端口转发或DMZ主机等功能，即可通过ip+端口或域名+端口的形式，访问内网的设备</p><p>公网IPv6地址不用解释，由于数量多，可以不用NAT技术来解决地址数量问题（当然也是可以NAT的，具体看这篇文章：<a href="https://www.xrgzs.top/posts/openwrt-istoreos-x-wrt-config-ipv6-nat6.html">《OpenWrt iStoreOS X-WRT 配置 IPv6 NAT6》</a>），缺点就是IPv6目前没有做到全面覆盖（未来也不可能做到），IPv4 Only网络下访问局域网设备非常头疼，此外IPv6地址也是难记得要命</p><p>当然，对于80、443端口，即HTTP、HTTPS默认服务端口，可以配置虚拟主机，实现一个端口绑定多个域名</p></blockquote><h2 id="不同方案及网络原理"><a href="#不同方案及网络原理" class="headerlink" title="不同方案及网络原理"></a>不同方案及网络原理</h2><p>远程访问家用设备（NAS等）的方法对比：<a href="https://zhuanlan.zhihu.com/p/431090794">https://zhuanlan.zhihu.com/p/431090794</a></p><p>说到内网穿透，即网络打洞，实际上有很多种方案，如花生壳、frp等基于端口映射的方案，这些方案本人都尝试过，对于今天这篇文章，存在以下几个问题：</p><ul><li>需要一台有公网IPv4服务器做端口转发</li><li>费用高昂，普通用户没必要</li><li>配置复杂，超出知识范围</li><li>速度慢，受限于公网IPv4服务器流量和带宽</li><li>延迟高，每次连接都需要经过公网IPv4服务器中转</li></ul><p>基于以上问题，本人一直在查找方案，经朋友推荐，了解到了一款软硬路由公网神器——Lucky(大吉)</p><p>项目地址：</p><p><a href="https://lucky666.cn/">https://lucky666.cn/</a></p><p><a href="https://github.com/gdy666/lucky">https://github.com/gdy666/lucky</a></p><h3 id="NAT是什么？"><a href="#NAT是什么？" class="headerlink" title="NAT是什么？"></a>NAT是什么？</h3><p>NAT（Network Address Translation）网络地址转换</p><h3 id="打洞原理"><a href="#打洞原理" class="headerlink" title="打洞原理"></a>打洞原理</h3><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250403/185100/7/33724/169451/642b0afeFab8c2db5/0d55f1985ff6b59b.png"></p><p><em>图源自natter</em></p><p>这种STUN（Session Traversal Utilities for NAT，NAT会话穿越应用程序）内网穿透技术，可以帮助解决因NAT技术所带来的网络连接问题</p><p>STUN技术允许NAT1用户获取公网端口，通过路由端口转发或者LUCKY内置转发，将内网服务端口暴露到外网，从而实现内网穿透的目的</p><p>这个技术有以下几个好处：</p><ul><li>不需要一台有公网IPv4服务器做端口转发</li><li>无需付费，最多就是购买个域名</li><li>配置简单，最多浏览器F12抓抓包</li><li>速度快，受限于你宽带的上传带宽</li><li>延迟低，和你游戏联机的技术一样</li></ul><p>不过也有一些缺点：</p><ul><li>访问地址不固定，穿透后端口千变万化</li><li>无法DDNS，DNS无法设置解析</li><li>稳定性未知，保活比较难做</li></ul><p>对于前两点，可以配合WebHook调用相关API，搭配Cloudflare的页面规则或YOURLS进行301&#x2F;302跳转，可以近似实现DDNS的功能</p><h2 id="使用经历"><a href="#使用经历" class="headerlink" title="使用经历"></a>使用经历</h2><p>不过一开始以为是OpenWrt路由专用，我手上又没OpenWrt设备，就不打算试</p><p><a href="https://www.right.com.cn/forum/thread-8267181-1-1.html">https://www.right.com.cn/forum/thread-8267181-1-1.html</a></p><p>听说可以实现另一种形式的内网穿透，本人非常激动，然后就看了看与它相关项目Natter，在Windows下用Python试了试没有成功，说有防火墙（实际没有）和没有权限。研究了一下文档，发现在DDNS的实现上还有问题，就放弃了</p><p>Natter：<a href="https://github.com/MikeWang000000/Natter">https://github.com/MikeWang000000/Natter</a><br>NATMap：<a href="https://github.com/heiher/natmap">https://github.com/heiher/natmap</a></p><p>后来了解到Lucky可以在Docker中运行，甚至能直接跑在Windows上，就在群晖的Docker上试着搭建了一下，发现正好满足了我对于内网穿透的要求</p><h2 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h2><p>为了能打洞成功，需要保证你的宽带默认为FullCone NAT（全锥型NAT，NAT1），如果为您的宽带为对称性NAT，那么不好意思，本方法不适合您</p><p>此方法的原理类似PCDN，各大运营商都在大力打击，中国移动将在2023年5月对网络进行大整改，将原先的NAT1改为NAT4，所以无法使用此方法穿透，解决方法就是换一家运营商</p><h2 id="配置网络"><a href="#配置网络" class="headerlink" title="配置网络"></a>配置网络</h2><blockquote><p><strong>推荐方案：</strong><br>光猫设置桥接模式，在路由器系统如 OpenWRT 上直接运行 LUCKY（仅经过一层 NAT）</p><p><strong>可行方案：</strong><br>在子网中的主机上运行 LUCKY，在光猫或路由器上对其开启 DMZ 功能，或对需要开放的端口设置端口转发（手动或UPNP）。（经过多层NAT）</p></blockquote><p>首先声明，我的网络是光猫桥接，爱快软路由拨号</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/59408c54d7f720cfcf09f615d36334b2.png"></p><p>如果你是光猫拨号，请想办法联系客服解决，如果无法解决，请自行百度</p><p>大多数的路由器默认使用NAT4以保障安全，如果改为NAT1（通常不支持），理论上可以不用开启UPNP，NAT4是要必须开启UPNP的，所以，最好开启UPNP</p><p>最主要的是要保证UPNP能用，否则非常麻烦</p><blockquote><p><strong>STUN穿透环境要求</strong></p><p>STUN技术的实现需要一些前提条件和环境要求。在使用STUN穿透功能之前，需要确保路由器、光猫等网络设备的设置和网络环境都符合要求。</p><ol><li>光猫拨号的情况下你需要在光猫后台设置DMZ指向路由器。(路由器拨号的跳过这一步)</li><li>建议使用STUN穿透功能的用户将LUCKY运行在主路由上面，如果LUCKY运行在局域网局域网内,以下三种设置方法任选一种<ol><li>你需要在路由器设置DMZ指向LUCKY所在的局域网IP,</li><li>在路由器端设置 <em><strong>穿透通道监听端口</strong></em> 指向LUCKY内网IP同样的 <em><strong>穿透通道监听端口</strong></em>,注意前后这两个端口的数组一定要设置是同样的。</li><li>开启路由器端口的UPNP功能。</li></ol></li><li>上面第二条的方法是只针对使用Lucky内置转发功能的设置，如果你没有使用Lucky内置转发，可以忽略第二条。</li></ol></blockquote><p>开启路由器的UPNP功能：</p><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250403/141539/38/34653/78139/642b0c02Fd84393c9/a2e03551506e6c79.png"></p><h2 id="安装Lucky"><a href="#安装Lucky" class="headerlink" title="安装Lucky"></a>安装Lucky</h2><p>对于 OpenWrt ，这里不再重复，请看官方文档</p><p><a href="https://lucky666.cn/docs/install">https://lucky666.cn/docs/install</a></p><p><strong>这里采用群晖Docker安装，注意以下配置：</strong></p><p>使用Host网络：</p><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250403/97988/22/21328/5526/642b0000F57154094/45cb59a725cadf19.png"></p><p>启用自动重新启动：</p><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250403/219997/27/24545/2092/642affcaF1f37b12e/12d0e460ee5edc86.png"></p><p>映射存储空间位置：</p><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250403/177030/3/34225/7684/642b0033F6eb3e88c/1735be1b2bfa6aa2.png"></p><p>访问http:&#x2F;&#x2F;你的IP:16601&#x2F;，用户名：666，密码：666，测试是否可用</p><h2 id="配置STUN"><a href="#配置STUN" class="headerlink" title="配置STUN"></a>配置STUN</h2><p>程序很强大，从端口转发到DDNS，啥都有，建议参考官方文档进行配置，这边就少胡说八道一些</p><p><a href="https://lucky666.cn/docs/modules/stun">https://lucky666.cn/docs/modules/stun</a></p><p>菜单-&gt;STUN内网穿透-&gt;穿透规则列表-&gt;添加穿透规则</p><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/6f1df9ad05c2e182f95ca6dcf7f44c5e.png"></p><p>启用规则，复制STUN穿透公网地址，用手机连接到另一个网络测试</p><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250403/130219/2/31948/42538/642b0e8aFdfd09f39/f00caca1113c197c.png"></p><p>如果能够访问，说明穿透成功，可以使用STUN穿透公网地址<strong>临时</strong>访问服务</p><h2 id="配置WebHook伪DDNS"><a href="#配置WebHook伪DDNS" class="headerlink" title="配置WebHook伪DDNS"></a>配置WebHook伪DDNS</h2><p>注意的是，此时的端口号非永久，IP地址也非永久，注意是两个各自非永久，即使DDNS了IP也无法DDNS端口，需要设置DNS的<strong>URL记录</strong>才能实现</p><p>目前没有DDNS程序支持设置DNS的URL记录，luckily，Lucky支持WebHook，有了WebHook，我们可以调用DNS运营商的API接口实现DDNS（实际上DDNS程序的原理也不过如此）</p><p>此处我们使用Cloudflare举例，实际上还可以使用其它支持跳转的API，最主要的就是要F12抓取更新地址的接口</p><p>需要注意的是，Cloudflare DNS并不支持URL记录，需要使用它强大的页面规则来设置，这个规则最多可以设置三条，对于一般人来说也够用了</p><blockquote><p>我这波属实是跳进了好几个坑：</p><ul><li>路由器非OpenWrt系统</li><li>非路由器安装</li><li>DNS服务器不支持动态端口</li></ul></blockquote><h3 id="Cloudflare"><a href="#Cloudflare" class="headerlink" title="Cloudflare"></a>Cloudflare</h3><p>打开Cloudflare Dash，在域名的DNS设置里面添加A记录，ip任意填，打开小云朵</p><p><img src="https://img08.mifile.cn/v1/MI_542ED8B1722DC/3ef5135c1011b09e609e7f48cf88ac05.png"></p><p>接着创建页面规则</p><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250403/132778/28/35200/95967/642b1513F0ef8f5a6/d2b667dbc08b6db4.png"></p><p>点击设置或编辑，保存，F12抓包获取区域ID和规则ID，<a href="https://dash.cloudflare.com/api/v4/zones/%E5%90%8E%E9%9D%A2%E8%B7%9F%E7%9D%80%E9%82%A3%E4%B8%B2%E5%B0%B1%E6%98%AF%EF%BC%8Cpagerules%E5%89%8D%E7%9A%84%E6%98%AF%E5%8C%BA%E5%9F%9FID%EF%BC%8Cpagerules%E5%90%8E%E7%9A%84%E6%98%AF%E8%A7%84%E5%88%99ID">https://dash.cloudflare.com/api/v4/zones/后面跟着那串就是，pagerules前的是区域ID，pagerules后的是规则ID</a></p><p><img src="https://img07.mifile.cn/v1/MI_542ED8B1722DC/01e1f1d8b237099f3ce85ea1508bed42.png"></p><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250403/133852/29/30557/157635/642b15beF599be059/a8b86822d000420e.png"></p><p>回到Lucky，点击编辑规则，找到Webhook，点击开启，如下设置</p><p>接口地址：</p><pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;api.cloudflare.com&#x2F;client&#x2F;v4&#x2F;zones&#x2F;区域ID&#x2F;pagerules&#x2F;规则ID<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>请求方法：<code>PUT</code></p><p>请求头：</p><pre class="line-numbers language-none"><code class="language-none">X-Auth-Email: 你的CF邮箱X-Auth-Key: API Key(获取方法同Cloudflare DDNS)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>请求主体：</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"targets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>      <span class="token property">"target"</span><span class="token operator">:</span> <span class="token string">"url"</span><span class="token punctuation">,</span>      <span class="token property">"constraint"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"operator"</span><span class="token operator">:</span> <span class="token string">"matches"</span><span class="token punctuation">,</span>        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"你的域名/*"</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"actions"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>      <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"forwarding_url"</span><span class="token punctuation">,</span>      <span class="token property">"value"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"http://#&#123;ipAddr&#125;/$1"</span><span class="token punctuation">,</span>        <span class="token property">"status_code"</span><span class="token operator">:</span> <span class="token number">301</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"priority"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"active"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>貌似可以进一步简化</p><p>接口调用成功包含的字符串：</p><pre class="line-numbers language-none"><code class="language-none">&quot;success&quot;:true<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250403/75893/4/26884/79257/642b1456Fc653a524/27db6f1c10ada9f7.png"></p><p>点击Webhook手动触发测试按钮，如无异常，应该出现<code>&quot;success&quot;:true</code></p><p>然后回到Cloudflare，可以发现配置被修改，已经不是刚才的值，说明伪DDNS配置成功</p><p><img src="https://kjimg10.360buyimg.com/ott/jfs/t20250403/161401/29/32409/39758/642b1627Feb43710a/4702241fa76c3dd4.png"></p><h3 id="为什么说它是伪DDNS？"><a href="#为什么说它是伪DDNS？" class="headerlink" title="为什么说它是伪DDNS？"></a>为什么说它是伪DDNS？</h3><p>目前我们做到了访问域名就跳转到IP+端口的地址，就是301&#x2F;302跳转，并且我们的方案支持保留链接的参数。你也可以使用一台专门的服务器来实现这个操作，但成本过于高昂而且没有现成API，这里直接白嫖免费的Cloudflare</p><p>但由于存在301&#x2F;302跳转后，浏览器的地址栏内就只有IP地址，没有域名，不是很方便</p><p>具体就是如果需要分享一个已经打开的链接，需要重新编辑，把原来IP+端口的部分替换为域名</p><p>如<a href="http://test2.xrgzs.asia/">http://test2.xrgzs.asia</a> ，打开后就变成<a href="http://66.666.66.66:16666">http://66.666.66.66:16666</a> ，如果你进入了其它目录，如：<a href="http://66.666.66.66:16666/Cloud">http://66.666.66.66:16666/Cloud</a> ，你需要分享该链接，就需要改成<a href="http://test2.xrgzs.asia/Cloud">http://test2.xrgzs.asia/Cloud</a></p><h3 id="Lucky-Alist实现私有化网盘公网访问"><a href="#Lucky-Alist实现私有化网盘公网访问" class="headerlink" title="Lucky+Alist实现私有化网盘公网访问"></a>Lucky+Alist实现私有化网盘公网访问</h3><p>使用IP+端口或域名+端口访问肯定不是一件长久的事，尤其是Alist文件分享。为了解决这个问题，我们可以参考PCDN网盘的原理，调用Alist的相关API来实现：</p><ol><li><p>搭建一台本地服务器、一台云服务器</p></li><li><p>在本地、云服务器上安装好Alist</p></li><li><p>在本地服务器上，使用Lucky，把Alist的5244端口穿透出去，可以得到一个动态的IP+端口，在浏览器访问该IP+端口，可以正常看到本地搭建的Alist</p></li><li><p>进入云服务器的Alist后台，添加一个Alist V3类型的储存，填入该IP+端口，保存后，可以在云服务器的Alist上看到挂载的本地Alist</p></li><li><p>利用浏览器F12&#x3D;&gt;网络抓取Alist更新配置的API，方法是：</p><ul><li>F12打开开发人员工具，点击上方的网络一栏</li><li>云服务器Alist后台编辑刚才添加的储存后保存，此时浏览器会提交一个POST请求，F12中可以看到，通常名为update</li><li>把请求地址、请求头、请求主体复制下来，拷贝到Lucky的WebHook中对应的设置里面</li><li>替换请求Body中相关地址为#{ipAddr}</li></ul></li><li><p>测试WebHook，如有报错，请尝试精简请求头的内容，如content type，实际上请求头只需含有authorization就行，最好不要精简请求主体</p></li><li><p>复制请求成功后服务器给出的回应内容到接口调用成功包含的字符串里面，如：</p> <pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"code"</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token property">"message"</span><span class="token operator">:</span><span class="token string">"success"</span><span class="token punctuation">,</span><span class="token property">"data"</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>保存后，如果没有问题，会显示WebHook触发结果为“成功”</p></li><li><p>返回云服务器的Alist，查看挂载的配置是否正常更新</p></li><li><p>之后即可使用云服务器的Alist地址访问到本地的Alist，实现网盘直链私有化，理论上下载速度就为你宽带的上传速度</p></li></ol><p>注意：</p><ul><li>如果没有云服务器，但有IPv6地址，可以使用支持IPv6回源的CDN，将IPv6转换为IPv4</li><li>为了防止IP被扫，运营商可能会禁PING，海外用户的连通性需要使用其他方式测试</li><li>对于手头上有大量没有公网IP地址但网络类型为NAT1宽带的用户来说，可以先将文件同步到各个本地服务器节点，然后把这些本地服务器挂载到云服务器Alist，再配合上云服务器Alist的别名和负载均衡功能，这样，客户端使用Aria2c（IDM不行），多次向云服务器请求下载地址，即可实现从各个本地服务器节点同时下载一个文件，从而提高下载速度</li></ul><p>如果懒得折腾，可以使用成品的PCDN储存服务，如大家都知道的123网盘，就是使用这个原理，降低了运营成本，才带来了继蓝奏云之后大文件免登录分享的体验</p>]]></content>
      
      
      <categories>
          
          <category> 网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Alist </tag>
            
            <tag> NAT </tag>
            
            <tag> Docker </tag>
            
            <tag> 群晖 </tag>
            
            <tag> DSM </tag>
            
            <tag> Lucky </tag>
            
            <tag> OpenWrt </tag>
            
            <tag> 打洞技术 </tag>
            
            <tag> 内网穿透 </tag>
            
            <tag> UPNP </tag>
            
            <tag> FullCone NAT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>希沃鸿合文香一体机OPS电脑原厂预装教育系统镜像ESD打包封装驱动程序下载恢复盘构建</title>
      <link href="/eduimg.html"/>
      <url>/eduimg.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/6a11c9dd1844f9aba6a323420b8f5341.jpg"></p><h1 id="交互式智能平板PC模块系统镜像合集"><a href="#交互式智能平板PC模块系统镜像合集" class="headerlink" title="交互式智能平板PC模块系统镜像合集"></a>交互式智能平板PC模块系统镜像合集</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>相信大家在使用希沃一体机、鸿合一体机、文香一体机的OPS电脑PC模块时肯定会出现系统不稳定、蓝屏、死机的情况，这个时候我们可以通过恢复系统镜像对这些问题进行修复。</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/4db435b16acbffd3eab932b4af384ac6.png"></p><p>通常情况下，这些一体机的OPS电脑PC模块会配有一键恢复功能，这种功能依赖于OPS电脑PC模块硬盘上的恢复分区。比如希沃的PC模块在E盘都会存放专用的原厂镜像文件，但随着日常的使用、维护、维修，部分机子的系统镜像可能会存在被损坏、删除的问题，导致PC模块自带的恢复功能受损。</p><p>在互联网飞速发展的今天，系统中毒的情况也越来越常见，病毒会刚染整个硬盘的文件，导致恢复盘内的文件受损。一些一体机的硬盘储存空间较小，恢复分区往往会被无关人员格式化或删除破坏掉原厂自带的恢复文件，导致无法恢复或者恢复到一半后出错。</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/21e820b8df3a6c1df54de33a910fa779.png"></p><p>部分机型自带的镜像老旧，需要升级到最新版本，使用了第三方封装的镜像，但体验不佳，存在过度精简、系统卡顿、驱动不完整、系统带毒的风险。</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/308d7142c3682a71be7ccd9a7afbc204.png"></p><p>另外，这些OPS电脑PC模块的镜像格式不统一，尤其是最新的机型，使用的是Clonezilla再生龙进行备份恢复，这种备份出来的格式Windows环境下没有软件能够恢复，咱们一般使用的Windows PE启动盘根本无法读取、安装，需要借助Linux环境，经过复杂的配置，才能完成手动恢复操作。</p><p>为了解决上述问题，我们也对这些品牌进行了深度的研究和长期的调查，出厂的恢复镜像体积较大而且手动恢复方式非常复杂，新手无法对其进行还原。于是，我们就将这些原厂的镜像制作成ESD格式的系统镜像文件，这种镜像压缩率更高，文件体积较小，适合在互联网上传播。</p><p>我们还贴心的为每一个镜像提供了MD5文件校验信息，其中还包括镜像的版本和镜像内安装软件的内容，保证下载到的镜像没有问题能够正常安装使用。</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/ad72a6cff01f93178a8273346a52d456.png"></p><p>对于大家最关心的安全问题，我们的镜像仅作搬运，恢复完成后没有进入系统，离线环境下直接使用自行编写的脚本通过开源的组件进行打包，中途没有其它程序参与、增删系统文件，保证系统无毒无害和原厂版本一致。</p><p><strong>本文会根据一体机的机型持续更新，欢迎大家收藏转发，帮助到更多有需要的人。如果您有最新镜像，欢迎联系我们进行投稿！</strong></p><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a><strong>注意事项</strong></h2><ul><li>请优先选择<strong>对应机型</strong>的<strong>最新版本</strong>进行安装。</li><li>请先下载文件夹内的TXT文本文档，查阅对应的镜像文件和校验内容后，再进行下载。</li></ul><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/bcea7c3da287f1b29ed273705d834344.png"></p><ul><li>下载后请务必校验文件MD5信息后再安装。</li><li>推荐使用：<a href="https://www.itsk.com/thread-404842-1-1.html">IT天空优启通</a>、<a href="https://www.puresys.net/701.html">USBOS</a>、<a href="https://www.hotpe.top/">HotPE</a>、<a href="https://firpe.cn/page-247">FirPE</a>、<a href="https://www.wepe.com.cn/">微PE</a>等优秀的 PE 项目安装。</li><li>推荐使用 <a href="https://xrgzs.github.io/xrok.html">潇然一键装机助理</a> 安装。</li><li>系统为官方原版，不带激活，我们也不提供激活工具，不过大家可以<a href="https://github.com/zbezj/HEU_KMS_Activator/releases">点此自行解决</a></li></ul><p><strong>感谢❤：</strong><a href="https://lmxiao.top/">凌梦晓</a>、<a href="https://www.rvibo.com/">恩腾技术圈</a>、<a href="https://pan.costg.cf/">栖鸟闲榆</a>、<a href="https://tanxifei.github.io/txftext/">TanXifei</a>、<a href="http://0nirii.cn/">0nirii</a>、<a href="https://space.bilibili.com/85914396">朱半仙Studio</a>、<a href="https://space.bilibili.com/1601172780">Windows毛玻璃解说233</a>、<a href="https://space.bilibili.com/198316802">传说当中的帅锅</a>等为此项目提供了大量的支持😘💖💕</p><h2 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h2><p><strong>推荐使用IDM高速下载</strong></p><p>一氧晓云の下载站分流（首发，推荐）：<a href="https://l.oxyxc.top/iwbsys">https://l.oxyxc.top/iwbsys</a></p><p>OneDrive分享链接（非首发）：<a href="https://xrgzshk-my.sharepoint.com/:f:/g/personal/xiaoran_xrgzshk_onmicrosoft_com/Ek2M0VfrjSVJgGfuk0vwP_cBOo31HcZKKsTRrzTdpMVJrA?e=Kesb71">http://url.xrgzs.top/eduimg</a> </p><p>OneDrive直链解析（非首发）：<a href="https://alist.xrgzs.top/odbmy/%E6%95%99%E8%82%B2%E7%B3%BB%E7%BB%9F%E9%95%9C%E5%83%8F">https://alist.xrgzs.top/odbmy/教育系统镜像</a> </p><p><del>百度网盘分享链接（无法自动同步，故不再更新）：<a href="https://pan.baidu.com/s/14Gtlgt-spQa85woTK1Lf2Q?pwd=xiwo">https://pan.baidu.com/s/14Gtlgt-spQa85woTK1Lf2Q</a> 提取码：xiwo</del> </p><p>如有问题，可以加群或到B站私信联系我们，我们会尽量回复！</p><p>智能白板交流群：<a href="https://jq.qq.com/?_wv=1027&k=3QVqu7yz">532028641</a></p><p>B站：<a href="https://space.bilibili.com/73271091">潇然工作室</a>    <a href="https://space.bilibili.com/29202562">凌梦晓</a></p><h2 id="发布页面"><a href="#发布页面" class="headerlink" title="发布页面"></a>发布页面</h2><p><a href="https://xrgzs.github.io/eduimg.html">https://xrgzs.github.io/eduimg.html</a></p><p><a href="https://blog.lmxiao.top/2023/04/11/%E7%94%B5%E5%AD%90%E7%99%BD%E6%9D%BF%E4%B8%80%E4%BD%93%E6%9C%BAPC%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%90%88%E9%9B%86/">https://blog.lmxiao.top/2023/04/11/电子白板一体机PC模块操作系统的合集/</a></p><p><strong>注意⚠：如需转载，请注明原始发布地址，如未授权请勿直接转载网盘地址，谢谢合作！！！</strong></p><h2 id="希沃PC模块原厂恢复镜像-esd重新打包"><a href="#希沃PC模块原厂恢复镜像-esd重新打包" class="headerlink" title="希沃PC模块原厂恢复镜像(esd重新打包)"></a>希沃PC模块原厂恢复镜像(esd重新打包)</h2><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/d8d57c6557df9c8b31caa363b516e636.jpg" alt="seewo-wallpaper"></p><p><strong>镜像文件版本说明：</strong></p><p>1、请<strong>优先选择机型对应主板的最新版本</strong>进行安装。请根据PC模块的型号，下载对应型号的镜像文件，如果没有，可以根据芯片组及处理器代数进行选择。</p><p>2、MT08的镜像兼容Intel 2&#x2F;3代Sandy Bridge&#x2F;Ivy Bridge的芯片组（如H61等）及处理器（如Intel Core i3&#x2F;5&#x2F;7 2XXX&#x2F;3XXX等）； MT11&#x2F;MT15的镜像兼容Intel 4代Haswell的芯片组（如H81等）及处理器（如Intel Core i3&#x2F;5&#x2F;7 4XXX等）；MT21&#x2F;MT23的镜像兼容Intel 6&#x2F;7代Skylake&#x2F;Kaby Lake的芯片组（如H110等）及处理器（如Intel Core i3&#x2F;5&#x2F;7 6XXX&#x2F;7XXX等）；MT41&#x2F;MT51的镜像兼容Intel 8&#x2F;9代Coffee Lake的芯片组（如H310等）及处理器（如Intel Core i3&#x2F;5&#x2F;7 8XXX&#x2F;9XXX等）。</p><p><strong>关于PC模块以及与大屏搭配的信息，可以参考下面的图片：</strong></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/bb8c3a6caaf7b8dad3944095f4d98ada.png"></p><p>3、镜像名称含有HX字样的，为核显机型的镜像，仅包含核心显卡的驱动程序，不包含独立显卡的驱动程序；镜像名称含有DX字样的，为独显机型的镜像，包含核心显卡及独立显卡的驱动程序。因此，<strong>核显机型可以安装独显机型的镜像，独显机型也可以安装核显机型的镜像，只需到<a href="https://www.nvidia.cn/Download/index.aspx?lang=cn">NVIDIA官网</a>下载安装最新的显卡驱动程序即可</strong>。建议即使是独显机型安装了独显机型的镜像，也建议重新下载安装最新的显卡驱动，因为镜像内的显卡驱动版本比较老，亲测<strong>更新驱动后可以解决视频展台卡顿的问题</strong>。</p><p>4、同一机型镜像的版本有很多，<strong>建议下载最新的</strong>，即使镜像的核显或独显与你的机型不匹配。Windows 10系统的镜像有较好的兼容性，在别的机型上安装能够自动适配。希沃预装的Windows 10版本较旧，一般为1703&#x2F;1709&#x2F;1909&#x2F;2004。</p><p>如何判断版本新旧：<strong>看文件名尾部日期！</strong></p><p>5、镜像压缩过但体积依旧较大（约8-16G，原厂未压缩过更大），原因是包含了完整的教学资源，这些资源库是第三方镜像所不能提供的，比如希沃白板3&#x2F;5的离线资源。下载后请将文件拖入工具（<a href="https://xrgzs.lanzoum.com/ibw5z2f">文件校验工具.exe</a>），校验MD5是否和我们提供的一致，确认无误后再使用。U盘安装请格式化为NTFS或exFAT再将其拷入；原厂E盘如是FAT32格式的，同理，须格式化为NTFS格式再将其拷入，否则，一般<strong>建议拷到D盘安装</strong>。</p><p>6、建议使用<a href="https://alist.xrgzs.top/xr/Software/WinPE/WePE/WePE_64_V2.2.exe">WePE微PE</a>、<a href="https://www.423down.com/8577.html">EasyU优启通</a>（点击文字链接即可下载）等纯净的PE处理、恢复镜像，不建议使用大白菜、老毛桃等带流氓软件、插件、配置推广的PE。使用流氓PE会导致安装出来的系统带毒，达不到恢复的效果。进入PE后，可以使用CGI、EasyImageX2、DISM++安装镜像，可以参考下面的视频（微PE+DISM++）：</p><p><a href="https://www.bilibili.com/video/BV1eo4y1m73J">使用Dism++安装Windows教程 BV1eo4y1m73J</a></p><p><strong>推荐使用<a href="http://xrgzs.github.io/xronekey">潇然一键装机助理</a>安装，这样就不用担心流氓PE的问题了</strong></p><p>7、用DISM++工具安装系统镜像，如果是MBR分区的硬盘，可以不执行引导修复，否则会出现“双引导”，可在系统下用BOOTICE编辑系统分区\Boot文件夹下的BCD文件，删除多余的引导。MT41之后的机型，使用的是GPT分区的硬盘，一定要勾选引导修复，将引导安装到硬盘第一个ESP分区（大小通常只为几百兆，请勿将系统安装到ESP分区，否则会100%的失败）。PE系统下，显示的盘符和最终的盘符肯定是不一样的，需要按照分区的大小来判断是系统分区还是ESP引导分区。</p><p><strong>推荐使用<a href="http://xrgzs.github.io/xronekey">潇然一键装机助理</a>安装，这样就不用担心引导修复的问题了</strong></p><p>8、由于安装的是原厂镜像，系统未进行过封装，所以不需要执行部署环节，恢复完成后重启直接进系统，速度非常快。</p><p>9、希沃的系统镜像自带Windows Defender杀毒软件和希沃管家，无需再安装360安全卫士&#x2F;杀毒、电脑管家等杀毒软件，如过嫌Windows Defender不好用，希沃管家拦不掉广告，可以安装一个火绒杀毒软件，会自动接管Windows Defender，拦截广告及流氓软件，具体配置方法可以看这个视频：</p><p><a href="https://www.bilibili.com/video/BV14K4y1M7bq">火绒安全软件安装、使用教程 BV14K4y1M7bq</a></p><p>10、相关文件内存放官方驱动，<strong>非必要可以使用非原产系统</strong>！</p><p>以下是一些内容的截图预览：</p><p><em>不同的机型</em></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/518eedaec37da1cf8952b73bb75697a6.png"></p><p><em>最全的镜像</em></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/e88ffa319c890e31bfa0c9fccc6008cf.png"></p><p><em>详细的注释</em></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/3c70c68f01d6e1a6732450ac1f7bad80.png"></p><p><em>从未见过的资料</em></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/0ed8ab5f6daa7c8fa265a403747656cc.png"></p><p><em>官网提供不了的驱动</em></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/b687c943eaf728467fade2d412224724.png"></p><p><em>详细到元件的讲解</em></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/6d36247c2aa75e69acc572a7796d8e6a.png"></p><p><em>售后级的帮助</em></p><p><img src="https://pic4.58cdn.com.cn/nowater/webim/big/n_v2656cff23a16845de9ab094841751bad3.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/c961a080369cf91314a0bb0c2aabaa5a.png"></p><p><em>独家的资料</em></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/a621324ba3d787a44fe9af3b73b6b997.png"></p><h2 id="鸿合PC模块原厂恢复镜像-esd重新打包"><a href="#鸿合PC模块原厂恢复镜像-esd重新打包" class="headerlink" title="鸿合PC模块原厂恢复镜像(esd重新打包)"></a>鸿合PC模块原厂恢复镜像(esd重新打包)</h2><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/98170e803b9fc5b732a525fac2b7370b.jpg" alt="hite-wallpaper"></p><p><strong>注意：鸿合官方售后不提供官方系统镜像，所谓“原厂恢复镜像”为分销商制作，因此不存在官方版本！</strong></p><p>鸿合镜像提供两个版本</p><p>1、原厂备份（鸿U+派学+整机注册+WPS专业+MSO2019）</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/7b2ec1dd3a46e51ae516282e650efece.png" alt="HiteVision-WIN10Pro-1709-64bit-UPie-Rev8.2.0-Intel-6th-9th-220711-2"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/a55733b5f4406be71926c73a89f96efe.png" alt="HiteVision-WIN10Pro-1709-64bit-UPie-Rev8.2.0-Intel-6th-9th-220711-1"></p><p>2、原厂备份（派学+MSO2016）</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/0316b45f458d09cbd2ce68331b0c3ced.png"></p><p>提供旧版软件下载</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/9292c2bbe89ff592c48406c47293b72d.png"></p><p>鸿合恢复盘创建教程</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/a90e5320a70ab415cb72c6371756e075.png"></p><h2 id="文香PC模块原厂恢复镜像-esd重新打包"><a href="#文香PC模块原厂恢复镜像-esd重新打包" class="headerlink" title="文香PC模块原厂恢复镜像(esd重新打包)"></a>文香PC模块原厂恢复镜像(esd重新打包)</h2><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/60255502bbba308dd4ef9cd38c1d4497.jpg" alt="wenxiang-wallpaper"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/b84ca8a1a346599d95813432dd8e2772.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/d803abc92ae86c73600f24e931b2360f.png"></p><hr><h2 id="免责声明"><a href="#免责声明" class="headerlink" title="免责声明"></a>免责声明</h2><p>本站所有资源均来自网络或原创，<strong>仅供演示、交流、学习使用。</strong></p><p>请在<strong>试用后24小时内销毁</strong>，<strong>严禁用于商业用途</strong>，如果您喜欢，请通过正规渠道购买正版。</p><p>因使用本站软件造成的损失，全部由<strong>使用者本人承担。</strong></p><p>如果侵犯到您的权利，请出示<strong>相关证明</strong>，并联系站长删除。</p><p>本站的软件下载来源均来自各个网盘云存储业务，本站服务器内<strong>不存储软件</strong>，所以遇到版权纠纷时，本站只能保证<strong>网盘账号内删除此文件</strong>，对于文件是否彻底删除，本站无权也无能力干涉，还请版权方联系网盘运营公司举报并提供版权证明。</p>]]></content>
      
      
      <categories>
          
          <category> 潇然工作室 </category>
          
          <category> Windows </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SEEWO </tag>
            
            <tag> 一体机 </tag>
            
            <tag> 希沃 </tag>
            
            <tag> MAXHUB </tag>
            
            <tag> 鸿合 </tag>
            
            <tag> HiteVision </tag>
            
            <tag> 文香 </tag>
            
            <tag> 电子白板 </tag>
            
            <tag> 希沃白板 </tag>
            
            <tag> 鸿合i学 </tag>
            
            <tag> 鸿合白板 </tag>
            
            <tag> 系统镜像 </tag>
            
            <tag> 原厂系统 </tag>
            
            <tag> 恢复盘 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>潇然系统镜像构建教程</title>
      <link href="/posts/xrsys-build-image.html"/>
      <url>/posts/xrsys-build-image.html</url>
      
        <content type="html"><![CDATA[<h1 id="潇然系统镜像构建教程"><a href="#潇然系统镜像构建教程" class="headerlink" title="潇然系统镜像构建教程"></a>潇然系统镜像构建教程</h1><p>从2022年开始，综合多方面考虑，我们不再提供潇然系统镜像，但是这并不意味着潇然系统的镜像版本就不存在，如果需要的话，你仍然可以自行构建。</p><p>经过数次对系统安装组件的调整，我们为大家准备了以下的潇然系统镜像构建教程。</p><p>在此之前，我们需要了解潇然系统的版本分类：</p><ol><li>按照接管部署的方式分类<ul><li>原版接管</li><li>第三方接管<ul><li>略</li></ul></li></ul></li><li>按照安装部署的方式分类<ul><li>使用<strong>潇然一键装机助理在线重装</strong>功能</li><li>恢复<strong>构建好的潇然系统镜像（Build-ed Xiaoran System Image）</strong>文件</li><li>恢复<strong>快速安装版镜像（Deploy-ed Xiaoran System Image）</strong>文件</li></ul></li></ol><p>其中，构建好的潇然系统镜像和快速安装版镜像可以通过以下两种方式制作：</p><ol><li>自行下载相关组件部署</li><li>潇然一键装机助理在线重装自助构建</li></ol><p>本文就介绍通过上述第2种方式进行构建。</p><h2 id="创建虚拟机"><a href="#创建虚拟机" class="headerlink" title="创建虚拟机"></a>创建虚拟机</h2><p>我们的虚拟机配置参考了多篇系统封装教程，融合了个人在系统封装时的经验，能够确保稳定性和兼容性。下面我们以最新的VMware Workstation 17作演示，15、16版本也可以参考。</p><p>打开VMware Workstation，新建虚拟机</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/181961/27/34173/31898/641d1ed3F6763aed2/3ecd266cbb68f768.png"></p><p>选择“自定义(高级)”，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/178375/5/30287/67872/641d2454Fbff3698b/4654309e7a0a42a1.png"></p><p>选择“Workstation 16.x”或更低版本，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/70204/3/25185/57609/641d249bF8d7728c6/e82c83c8659938bb.png"></p><p>选择“稍后安装操作系统”，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/180613/27/33531/44970/641d24a6F1f131297/a9835d2508ecffbb.png"></p><p>这里我们以构建潇然系统Windows 10 64位为例，选择“Windows 10 x64”，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/30581/11/21525/36564/641d24c4Fc579a73b/b693f67dd0fd6b23.png"></p><p>输入虚拟机名称，如“Win10x64演示”，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/148238/29/36327/33955/641d24d2F980ee7e6/d89153da20fe400a.png"></p><p>固件类型选择“BIOS”，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/138640/2/34615/25702/641d242cF3e084fa3/12cecf7438b49244.png"></p><p>分配虚拟机的处理器，注意<strong>处理器内核总数不要低于双核</strong>，如“1个CPU，4核”，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/46284/22/23174/29531/641d24e2F56a58a07/e700cf8384a503eb.png"></p><p>分配虚拟机的内存，注意<strong>内存大小不要低于“2048 MB (2 GB)”</strong>，如“4096 MB (4 GB)”，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/60482/28/24329/45504/641d250bF328be6af/8f4302ea376bb836.png"></p><p>为了支持IPv6，提高下载速度，选择“使用桥接网络”，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/111600/1/34019/55032/641d2564F286002fe/dbb6737e6ab36d64.png"></p><p>保持默认，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/73964/27/19851/40593/641d2581Fda3b5f57/198664f3b047fb66.png"></p><p>为了避免恢复到实体机以后蓝屏，虚拟磁盘类型<strong>最好选择“SATA”</strong>（仅快速安装版需要用到，如无需要可以保持默认），点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/81856/15/23841/28450/641d259eF27b3a75a/b1944fb8349bc478.png"></p><p>保持默认，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/114741/8/31013/174663/641d2290F102b5e34/1dfeca0ce5e1c399.png"></p><p>虚拟磁盘大小越大越好，这边设置为“60 GB”，选择“将虚拟磁盘储存为单个文件”，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/171500/38/35929/60305/641d25e9F73c4fea6/173644f6a52f3c07.png"></p><p>保持默认，点击“下一步”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/95570/34/38541/29911/641d25f6F08a47ab6/fda0624f1b103bd5.png"></p><p>点击“完成”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/207324/12/27155/47340/641d2600F1c39f463/ae83daf2b1a0538f.png" alt="image-20230324122431416"></p><p>切换到虚拟机选项卡，点击“编辑虚拟机设置”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/123147/23/36336/89168/641d262bFd6ee9656/9dc91e844ae2c41f.png"></p><p>在“硬件”选项卡中，点击“CD&#x2F;DVD”，勾选“启动时连接”，选择“使用ISO映像文件(M)”，点击“浏览”，找到WinPE的ISO镜像文件，点击“打开”</p><p>此处使用的PE ISO镜像下载地址：<a href="https://alist.xrgzs.top/d/pxy/Xiaoran%20Studio/Onekey/PE/XRPE.iso">XRPE.iso</a></p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/181895/26/33744/74212/641d269fFd91b37bb/1a5f32bc9d6558f2.png"></p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/111982/20/33834/66807/641d2738Fdfa9282e/160ead6450b1de64.png"></p><p>点击“网络适配器”，取消勾选“启动时连接”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/218318/40/24364/88484/641d2778F0e874554/671d960e30ed4bab.png"></p><p>点击“USB 适配器”，“USB 兼容性”选择“USB 2.0”，取消勾选“与虚拟机共享蓝牙设备”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/147353/11/34476/65690/641d2797F3c6ebc04/c47c607cb016f8bd.png"></p><p>为了避免其它设备干扰，分别点击“声卡”、“打印机”，点击下方的“移除(R)”，删掉这些设备</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/163663/12/33156/75153/641d2857F4a511548/41c6752f138db412.png"></p><p>点击“显示器”，取消勾选“加速 3D 图像(3)”，取消勾选“在虚拟机中自动调整用户界面大小(O)”，点击右下方的“确定”，保存设置，回到主界面</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/192616/14/33715/102375/641d2878Fcc1bcf80/495659cc67392d99.png"></p><p>点击<img src="https://m.360buyimg.com/babel/jfs/t20250323/38279/3/20627/485/641d29c7Fcc443c1c/50d1e0672fe3a336.png">右方的<img src="https://m.360buyimg.com/babel/jfs/t20250323/219380/36/27181/180/641d29e1F8bfa4556/e21c5afd17cf258d.png">打开下拉菜单，选择“打开电源时进入固件(F)”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/98549/15/36974/99807/641d297eF3463649d/4fddd12b0ae10ed6.png"></p><p>点击图像，进入虚拟机，此时您的鼠标和键盘被定向到虚拟机内，如需退出，请按下组合键“<code>Ctrl</code> + <code>Alt</code>”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/192017/7/33891/37971/641d2b58F47208121/c2139ce89655664f.png"></p><p>根据帮助内容，使用“→”键切换到“Boot”选项卡，使用“↓”键切换到“CD-ROM Drive”条目，使用“+”键将该条目调整到最上方</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/23116/6/20726/32462/641d2bb4F5416ab4e/14437c8326b75189.png"></p><p>结果如图所示</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/118652/28/33519/29195/641d2c53Fc4b0bee3/6a7161dd36e0f1bb.png"></p><p>根据帮助，按下“F10”保存并退出，在弹出的提示框内选择“Yes”后按“Enter”确认后，虚拟机会重新启动到WinPE ISO</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/134861/12/30146/28621/641d2c66F6f0ffa34/53a0bbb1f4dd2ad5.png"></p><h2 id="PE下恢复系统镜像"><a href="#PE下恢复系统镜像" class="headerlink" title="PE下恢复系统镜像"></a>PE下恢复系统镜像</h2><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/46250/32/23551/239624/641d360cFc8a533ae/cee22b26ac04394b.png"></p><p>进入WinPE系统以后，我们需要给虚拟机<strong>临时连接一下网络</strong>，<strong>右键</strong>单击窗口右下方状态栏上的<img src="https://m.360buyimg.com/babel/jfs/t20250323/132399/31/30046/330/641d3579F8f5217fa/e92dcef456e9bfbf.png">，选择“连接(C)”，观察一下虚拟机内的提示，确定已经正常连接到网络</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/201808/13/29584/7655/641d3654F870cff34/8f9401dcfad72ed9.png"></p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/74326/21/20303/187373/641d367cF2091c674/d38e831a47704f37.png"></p><p>运行桌面上的“潇然一键装机助理”，程序会联网自动更新，更新完毕后会进入主界面，这里由于新建的虚拟硬盘没有进行过硬盘分区，会弹出提示，我们点击“是(Y)”开始一键分区，非常的贴心</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/201094/29/22046/61341/641d3731F272deaba/a09e4ab63389ac30.png"></p><p>在“一键分区”界面，我们选择要分区的硬盘，如“序号1|VMwareVirtualSATAHardDrive|60.00GB|SATA”，下方“分区表”我们设置为“MBR”，“分区数”设置为“2”，“主分区”设置为“40 GB”，点击“一键分区”</p><p><img src="https://m.360buyimg.com/babel/jfs/t20250323/69413/25/23897/52078/641d380cF8568a42c/3bec7530693dd6ef.png"></p><p>弹出提示，我们点击“是(Y)”</p><p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/153895/3/31003/9525/641d40e5F1c3d1643/fe3430729b276576.jpg"></p><p>稍等片刻，分区完成，弹出提示，我们点击“是”</p><p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/62303/38/25149/5645/641d4113Fa01c22b3/81ae78074196acee.jpg"></p><p>点击“系统安装”菜单<img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/8d8e9bf24b7cea3d9f64982b10481dc0.png">，出现以下界面</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/d9d4e0192f4a19f24f2163eabf4ac72c.png"></p><p>在“系统安装”主界面，我们需要对“高级选项”进行一些配置：</p><ol><li>取消勾选“引导分区”（仅构建 Builded Xiaoran System Image 需要，<strong>构建快速安装版请勿取消勾选</strong>）</li><li>取消勾选“安装一键急救系统”</li><li>取消勾选“全自动安装系统”</li><li>取消勾选“自动重启计算机”</li><li>（仅新版Win10需要）勾选“导入英特尔11代VMD驱动”，弹出提示，点击“是”</li></ol><p>最后主界面如下显示：</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/fdeb84e09e17c8c862ffba50ff147e9b.png"></p><p>点击“高级选项”旁边的“更多选项”<img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/dde5e0723c8963052e86a26a0ed86723.png">，弹出以下窗口，进行如下配置：</p><ol><li>取消勾选“导入自定义驱动”</li><li>取消勾选“添加$OEM$目录”</li><li>勾选“禁用系统保留空间”</li><li>勾选“移除Windows Defender”</li><li>勾选“关闭BitLocker自动加密”</li><li>勾选“跳过TPM&#x2F;CPU校验”</li><li>勾选“游戏性能优化[测试]”，弹出提示，点击“是”</li><li>（仅Win7需要）勾选“导入Nvme补丁及驱动”</li><li>（仅Win7需要）勾选“导入USB3驱动”</li><li>勾选“禁用Windows自动更新”</li></ol><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/d1b553be2dafc7c7f5d30f2ff0eae652.png"></p><p>设置完成后，点击“确定”，返回主界面，点击“在线重装”<img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/4bbc0defcc1f08a992d0376c2f4e9662.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/f9bd65f01f9183c35169c51aa93aa182.png" alt="image-20230324150059691"></p><p>这里我们以“【原版】22H2 19045 专业 64位 2021办公 主板驱动 iso”为例，点击该项目右方的“安装此系统<img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/85ed2b0bc0d42d1fd3c966cdfb173dfd.png">”</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/80bcf37eeac1ed68635eb6b21512af1f.png"></p><p>我们会发现这里的选项已经继承了前面的设置，我们选择要安装的分区，如“C:|1:1|主分区,MBR||40.00GB|39.92GB”，点击“开始安装”，弹出提示，点击“是”</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/723cc706b8498d7e00c51cd620edfc60.png"></p><p>至此，等待系统下载安装配置完成</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/4f97dffa9bc7fbbce9dfdfbc5dc234f9.png"></p><p>如果您还有什么需要定制修改的，请现在打开系统盘进行编辑，过了这个村就没有这个店了</p><h2 id="PE下构建系统镜像（Build-ed-Xiaoran-System-Image）"><a href="#PE下构建系统镜像（Build-ed-Xiaoran-System-Image）" class="headerlink" title="PE下构建系统镜像（Build-ed Xiaoran System Image）"></a>PE下构建系统镜像（Build-ed Xiaoran System Image）</h2><p>安装完成后，点击“返回主界面”，点击“系统备份<img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/ce3193f39b34f06b57257bbc5dae3e80.png">”，出现以下界面</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/1d9fc54a5b4ebfc56bfeed853d05ae0c.png" alt="image-20230324152624942"></p><p>如果不出意外，正常情况下，点击“开始备份”即可构建出最新版的系统镜像文件</p><p>但根据上面的截图，我们发现有两处不对：</p><ol><li>源备份盘（C:\）和目标备份的镜像文件位置（C:\）冲突</li><li>第二个分区（1:2）可用大小过小，可能无法储存备份的镜像文件</li></ol><p>针对第1个问题，我们可以点击“浏览<img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/3449b07d8fa4ec4b927218f5565e45f3.png">”选择镜像保存的位置到E盘（1:2)；针对第二个问题，我们可以格式化E盘，或删除<code>E:\OSDownload</code>文件夹</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/1a141d80eb08e28589bd3f53706836fb.png"></p><p>删除后，程序总的分区可用大小仍未变化</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/9d74b60e05e391f3c03183f9cc0389e8.png" alt="image-20230324153858321"></p><p>我们可以到“系统安装”界面点击“搜索刷新”，“刷新分区”</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/9da0e98929349d0a6bd8961845d8ebb4.png"></p><p>进入系统备份中，大小就够用了</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/dac3da5dc337a8f681443d2f0e1391a0.png"></p><p>前面说过，针对第1个源备份盘（C:\）和目标备份的镜像文件位置（C:\）冲突的问题，我们可以点击“浏览<img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/3449b07d8fa4ec4b927218f5565e45f3.png">”选择镜像保存的位置到E盘（1:2)，顺便我们也可以修改一下镜像保存的名称</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/fd5f8158e53022b60a2745baf415e118.png"></p><p>默认程序备份出来的格式为WIM格式，如果嫌压缩速度过慢，您可以将“压缩等级”调低一点，如“快速压缩”</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/5c54fc509aba10ce115a9025172c8608.png"></p><p>如果嫌压缩体积过大，可以将“压缩格式”调为“*.ESD”，同时将“压缩等级”调为极限压缩</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/1ef9a3764f4cd280ffd9589b898be3a6.png"></p><p>如果习惯传统的Ghost格式，可以将“压缩格式”调为“GHO”</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/4db73154d92df7ac398d4fe0d038315e.png"></p><p>之后点击“开始备份”，等待备份完成即可</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/8ab5ce3b911f08e34409c19e47dbc624.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/6635f9ac786b04f47bc57f8aa92edb07.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/5e39fddd97ba94610aa39888af91cc97.png"></p><p>那如何把备份好的镜像弄出来呢？</p><ol><li>接U盘拷：速度慢，不稳定</li><li>连NAS传：最方便，速度较快</li><li>挂虚拟硬盘拷：麻烦，速度快</li></ol><p>下面我们演示第3种方式</p><p>我们先将虚拟机关机，双击“设备”里的“硬盘”快速进入硬盘设置</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/1581b085eec6283f5fde73486b9c9ee5.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/22e803146e987c1db24857431c03331e.png"></p><p>记录好硬盘文件的位置后，彻底关闭VMware Workstation软件，打开DiskGenius</p><p>磁盘-&gt;打开虚拟磁盘文件，找到你刚才记录的虚拟硬盘文件，点击“打开”</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/717c901eacdc0aa7b626a9fea27fe284.png"></p><p>此时，DiskGenius就会将虚拟硬盘里面的内容显示出来，在对应的硬盘分区里面找到刚刚备份出来的系统镜像文件，复制到指定文件夹即可</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/20e92a0db24b322806b2f2f0d1a1c513.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/cc4145516575aca1da56e0a40d05564c.png"></p><h2 id="制作快速安装版镜像（Deploy-ed-Xiaoran-System-Image）"><a href="#制作快速安装版镜像（Deploy-ed-Xiaoran-System-Image）" class="headerlink" title="制作快速安装版镜像（Deploy-ed Xiaoran System Image）"></a>制作快速安装版镜像（Deploy-ed Xiaoran System Image）</h2><p>为了降低蓝屏几率，我们需要断开网络连接，<strong>右键</strong>单击窗口右下方状态栏上的<img src="https://m.360buyimg.com/babel/jfs/t20250323/132399/31/30046/330/641d3579F8f5217fa/e92dcef456e9bfbf.png">，选择“断开连接(D)”，观察一下虚拟机内的提示，确定无法连接到网络</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/4daaf7632f33a7d3c7b6a5e5d67c9762.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/f56d32f6d0f0b3bb7c840ff9fc51ac7b.png"></p><p>接下来我们需要删除万能驱动，避免虚拟机的主板驱动导致镜像系统恢复到实体机后蓝屏</p><p>万能驱动位于<code>C:\Windows\Setup\Set</code>下的wandrv.iso及wandrv数字.iso，将其删除即可</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/d5ec318e4689249c4ce337512462d610.png"></p><p>注意：如果刚才您在“系统安装”主界面取消勾选了“引导分区”，这里我们需要手动修复一下引导</p><p>打开虚拟机的命令提示符</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/2697e146e78e795a6e8f6f4edea655e5.png"></p><p>输入以下命令后回车，注意其中的C:为系统盘的盘符，请根据实际情况修改，不要直接复制粘贴</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">bcdboot c:<span class="token punctuation">\</span>windows /l zh-cn /s c: /f bios<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/772bda1d1ce9b0ec53d8d2812cc92792.png"></p><p>重启虚拟机（这个就不教了），等待系统部署完成进入桌面</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/61a615d822c9b6c771193d55cd1c096b.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/a4ecca14f07ec3bdaaa51eaba04ef853.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/e61767543b3f7d565ecda37e2b8bdb81.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/20750c40c71442cce8a9c9cb6af8a801.png"></p><p>进入桌面后，如果您还有什么需要定制修改的，请现在就对系统进行设置，如安装各种软件，过了这个村就没有这个店了</p><p>这个过程中最好不要联网，如果Windows 10以上版本系统联上了网，会自动下载虚拟机的主板驱动，这样可能会导致制作出来的系统镜像恢复到实体机后蓝屏</p><p>至于VMware Tools那就更不用说了，肯定是别装</p><p>当然如果你就是封装出来到VMware虚拟机里面用的，可以忽略我上面说的内容</p><p>这里我们对系统进行一些调整，比如任务栏显示搜索框、显示触摸键盘、显示Cortana按钮、取消固定所有项目，Edge、360浏览器主页更改为about:blank，安装希沃白板5</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/1a60ce0766b82fa722fa058748170576.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/9cc6b91f0fb6c013701686d2e72dadfa.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/c591b32a02ef50bdc449c709fb10942a.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/6c1158d23227cd82666bcca97980d046.png"></p><p>对于其它安装包，我们可以通过制作ISO进行导入，也可以拷贝到U盘然后将U盘插入到虚拟机导入</p><p>如果使用后者，可能会出现残留信息</p><p>如果你不在意蓝屏问题，现在可以联网，到潇然一键装机助理、浏览器下载对应软件</p><p>这边我们在虚拟机外将希沃白板5的官网最新安装包制作成ISO格式导入虚拟机</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/36c3ba48ad36ec84078137bebb476451.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/8dd146da18b6d126a1ebe550cce315ab.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/7379f012e027fb503229e2283fe504ca.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/1f245f6514fffc28d738762697fe6940.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/87bc4bb1cab670f74b3575e276c44a2a.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/339c9582c7e33d09bb3cf088bcb4a89d.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/4c1e8a73e7934f031e96fbbbbad7f944.png"></p><p>重启后检查更改是否生效，拍摄快照，关闭虚拟机</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/504174d0b5f4e5f5f7a6dfbc73516c7a.png"></p><p>双击“CD&#x2F;DVD”，快速弹出设置</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/1ed4c52d9fae5897dc58f24d54e59b60.png"></p><p>点击ISO镜像文件路径旁边的下拉按钮，选择之前使用过的WinPE ISO，点击“确定”</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/63a58c9ba36ce44d9a9e4e243c38f416.png"></p><p>开启虚拟机，疯狂按任意键</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/528fec4cad72cac43b56f039d7985d9d.png"></p><p>选择第一项，回车</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/de04d433278f50446d98d657b521a3db.png"></p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/4e54c0363d9708231863b488085dc142.png"></p><p>进入PE系统以后，打开资源管理器，进入C盘，删除以下文件夹：</p><ul><li>$Recycle.Bin</li><li>Boot</li><li>System Volume Information</li></ul><p>删除以下文件：</p><ul><li>bootmgr</li><li>BOOTNXT</li><li>DumpStack.log.tmp</li><li>install.log</li><li>pagefile.sys</li><li>swap.sys</li></ul><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/92783a2202283b7239746494a824db08.png"></p><p>打开潇然一键装机助理，选择“系统备份”，按照PE下构建系统镜像（Build-ed Xiaoran System Image）的方法制作系统镜像文件</p><p><img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/f688866c06c1b9f5f90bbdf38d83d7d6.png"></p><p>将备份好的系统镜像文件恢复到实体机测试即可</p><h3 id="实机测试"><a href="#实机测试" class="headerlink" title="实机测试"></a>实机测试</h3><p><video src="https://alist.xrgzs.top/xr/uploads/media/20230324001.mp4" controls width="100%"></video></p>]]></content>
      
      
      <categories>
          
          <category> 潇然工作室 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 潇然工作室 </tag>
            
            <tag> Xiaoran Studio </tag>
            
            <tag> 潇然系统 </tag>
            
            <tag> Xiaoran System </tag>
            
            <tag> Windows </tag>
            
            <tag> 操作系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenWrt iStoreOS X-WRT 配置 IPv6 NAT6</title>
      <link href="/posts/openwrt-istoreos-x-wrt-config-ipv6-nat6.html"/>
      <url>/posts/openwrt-istoreos-x-wrt-config-ipv6-nat6.html</url>
      
        <content type="html"><![CDATA[<h1 id="OpenWrt-iStoreOS-X-WRT-配置-IPv6-NAT6"><a href="#OpenWrt-iStoreOS-X-WRT-配置-IPv6-NAT6" class="headerlink" title="OpenWrt iStoreOS X-WRT 配置 IPv6 NAT6"></a>OpenWrt iStoreOS X-WRT 配置 IPv6 NAT6</h1><h2 id="为什么要使用NAT6？"><a href="#为什么要使用NAT6？" class="headerlink" title="为什么要使用NAT6？"></a>为什么要使用NAT6？</h2><p>通常情况下，IPv6为每个设备都配备了公网IPv6地址。公网IPv6地址数量很多，黑客用枚举法一时半会儿扫不进来。但是，随着量子计算机的发展，未来这一优势将会进一步减弱。</p><p>在缺乏网络安全管理的家庭、中小企业中，通常会使用IPv6进行外网远程访问，一些设备由于系统精简、年份较老，如果没有配置好详细的防火墙规则，就会被黑客扫描破解。在量子计算机发展普及的将来，这些攻击将会变得轻而易举。</p><p>IPv6在正式普及用起来之前，反而算是一片攻击者的蓝海。</p><p>为了提高安全性，同时兼具IPv6升级，我们可以考虑在IPv6网络中使用NAT技术。</p><p>此外，一些地区的宽带拨号后没有下发DHCPv6-PD前缀信息，而是直接下发64位IPv6地址，路由器无法分配IPv6地址（当然可以把IPv6相关选项设置成relay模式，但获取的IPv6地址不是你路由器分配的）。</p><h2 id="OpenWrt系统配置NAT6"><a href="#OpenWrt系统配置NAT6" class="headerlink" title="OpenWrt系统配置NAT6"></a>OpenWrt系统配置NAT6</h2><p>1、安装并更新软件包。</p><pre class="line-numbers language-none"><code class="language-none">opkg updateopkg install ip6tablesopkg install kmod-ipt-nat6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>这几个包通常是默认安装的。</p><p>2、修改ULA前缀。</p><p>这个在IPv6中近似于IPv4的LAN口内网地址。</p><p>默认情况下，iStoreOS、X-WRT等系统在第一次启动时会随机生成好ULA前缀，因此我们可以直接跳到第3步。</p><p>修改<code>/etc/config/network</code>文件中的<code>ula_prefix</code>，如果已有内容，无需修改，直接<code>:q</code>退出。</p><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;etc&#x2F;config&#x2F;network<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">config globals &#39;globals&#39;option ula_prefix &#39;fd38:eb73:c847::&#x2F;48&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>如果此时重启网络或OpenWrt系统，下联的设备会获取到ULA前缀开头的64位和128位IPv6地址。</p><p>3、配置DHCPv6。</p><p>这步千万不能省！！！！！！！</p><p>修改<code>/etc/config/dhcp</code>文件中lan口的DHCPv6配置，如果已有多余的内容，建议从<code>option dhcpv6</code>开始删除替换。</p><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;etc&#x2F;config&#x2F;dhcp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">config dhcp &#39;lan&#39;option interface &#39;lan&#39;option start &#39;100&#39;option limit &#39;150&#39;option leasetime &#39;12h&#39;option dhcpv4 &#39;server&#39;option dhcpv6 &#39;server&#39;option ra &#39;server&#39;option ra_management &#39;1&#39;option ra_default &#39;1&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>建议从第六行就开始覆盖替换，别自作聪明，直接在浏览器里面用LuCI修改，太强大了你把持不住的。千万别开混合模式。</p><p>4、打开IPv6 NAT。</p><p>默认情况下，X-WRT在“网络-&gt;防火墙-&gt;NAT 规则”里面配置好一条名为“nat6”的规则，默认没有启用，我们勾选“启用”，然后点击页面下方的“保存并应用”即可完成配置。</p><p>还有些系统，支持FullCone NAT6，虽然支持有限，但建议开启。</p><p>其它系统需要修改<code>/etc/firewall.user</code>脚本，自定义防火墙规则。</p><p>方法一：http:&#x2F;&#x2F;路由器的IP地址&#x2F;cgi-bin&#x2F;luci&#x2F;admin&#x2F;network&#x2F;firewall&#x2F;custom</p><p>方法二：<code>vi /etc/firewall.user</code></p><pre class="line-numbers language-none"><code class="language-none">WAN6&#x3D;这里填写IPv6 WAN6口的网卡名称，如eth0LAN&#x3D;这里填写LAN口的网卡名称，一般就填br-lanip6tables -t nat -A POSTROUTING -o $WAN6 -j MASQUERADE<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>安全起见，下面两条不建议添加，基本不影响使用：</p><pre class="line-numbers language-none"><code class="language-none">ip6tables -A FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPTip6tables -A FORWARD -i $LAN -j ACCEPT<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>5、正确配置网关。</p><p><strong>这是本文的重点。</strong></p><p>在路由器上看一下自己的默认网关。</p><pre class="line-numbers language-none"><code class="language-none">ip -6 route show default<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">default from 2409:8a6c:5722:daf1::52c via fe80::213:32ff:fe09:216d dev eth0 proto static metric 512 pref mediumdefault from 2409:8a6c:5722:daf1::&#x2F;64 via fe80::213:32ff:fe09:216d dev eth0 proto static metric 512 pref medium<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>如果获得的是这样坑爹的网关，在转发NAT包的时候会有问题，需要创建一个脚本<code>/etc/hotplug.d/iface/99-ipv6</code>，把去掉<code>from 2409:8a6c:5722:daf1::52c</code>这一部分的以后的默认路由添加到路由表中。</p><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;etc&#x2F;hotplug.d&#x2F;iface&#x2F;99-ipv6<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>网上的教程中，基本上都只获取到一个IPv6地址，如SLAAC或DHCPv6无状态，然而我这边有两个IPv6地址，如DHCPv6有状态+无状态，即使上级路由也有ULA前缀，但实际上网关地址都相同，这回使获取到的信息重复，从而配置无效。<strong>用网上的脚本都会出现这个问题</strong> ，自己手动添加路由又正常，就是这个原因导致的。</p><p>下面的脚本我已经修改过，只会使用获取到的第一个IPv6地址的网关地址及信息，<strong>均测试有效</strong> 。</p><p>第一种：</p><pre class="line-numbers language-none"><code class="language-none">#!&#x2F;bin&#x2F;sh[ &quot;$ACTION&quot; &#x3D; ifup ] || exit 0ip -6 route add &#96;ip -6 route show default|sed -e &#39;s&#x2F;from [^ ]* &#x2F;&#x2F;&#39;|sed -n &#39;1p&#39;&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>第二种：</p><pre class="line-numbers language-none"><code class="language-none">#!&#x2F;bin&#x2F;sh[ &quot;$ACTION&quot; &#x3D; ifup ] || exit 0route -A inet6 add default gw &#96;(ip -6 route | grep default | awk &#39;&#123;print $5,$6,$7&#125;&#39; | sed -n &#39;1p&#39;)&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>设置权限：</p><pre class="line-numbers language-none"><code class="language-none">chmod +x &#x2F;etc&#x2F;hotplug.d&#x2F;iface&#x2F;99-ipv6<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>6、重启路由器使配置生效。</p><pre class="line-numbers language-none"><code class="language-none">reboot<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>7、开启IPv6 DNS解析。</p><p>默认情况下，X-WRT已经开启IPv6 DNS解析。</p><p>其它系统需要浏览器访问http:&#x2F;&#x2F;路由器的IP地址&#x2F;cgi-bin&#x2F;luci&#x2F;admin&#x2F;network&#x2F;dhcp ，点击高级设置，取消“禁止解析 IPv6 DNS 记录”，然后点击页面下方的“保存并应用”。</p><p>8、测试。</p><p>http:&#x2F;&#x2F;[上一层的IPv6网络设备地址]</p><p><a href="http://ch.test-ipv6.com/">http://ch.test-ipv6.com/</a></p><p><a href="http://ipv6-test.ch/">http://ipv6-test.ch/</a></p><p>如果ipv6-test已出IPv4地址，5秒内未出IPv6地址，那么基本上失败，不用继续等待。</p><p>如果第5步网关配置错误，会表现为上一层的IPv6网络设备正常访问，上上层的网络设备（公网）无法访问，ipv6-test失败。</p><p>这种情况可以尝试更改<code>/etc/hotplug.d/iface/99-ipv6</code>文件<code>sed -n &#39;1p&#39;</code>中的<code>1</code>。</p><p>正常情况下，ipv6-test应该可以正常（10&#x2F;10）通过，显示的 IPv6 地址为上级路由的 IPv6 地址。</p><p>不过这个IPv6的NAT目前还有一些问题，而且相关问题和应用开发的积极性不高，毕竟这与IPv6要消除NAT的初衷相悖，不过对于多线聚合等应用还是有一定意义。相信以后随着IPv6的普及和大佬的进一步研究，以及在企业等大型公共网络中的部署，肯定会出现更完善甚至更独特的解决方案。</p><p>参考：</p><p><a href="https://openwrt.org/docs/guide-user/network/ipv6/ipv6.nat6">https://openwrt.org/docs/guide-user/network/ipv6/ipv6.nat6</a></p><p><a href="https://tang.su/2017/03/openwrt-ipv6-nat/">https://tang.su/2017/03/openwrt-ipv6-nat/</a></p><p><a href="https://www.jianshu.com/p/2a5e0ba31835">https://www.jianshu.com/p/2a5e0ba31835</a></p>]]></content>
      
      
      <categories>
          
          <category> 网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IPv6 </tag>
            
            <tag> OpenWrt </tag>
            
            <tag> iStoreOS </tag>
            
            <tag> X-WRT </tag>
            
            <tag> NAT6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>某盒子汁源</title>
      <link href="/posts/tvbox.html"/>
      <url>/posts/tvbox.html</url>
      
        <content type="html"><![CDATA[<h1 id="某电视盒子资源"><a href="#某电视盒子资源" class="headerlink" title="某电视盒子资源"></a>某电视盒子资源</h1><blockquote><p>免责声明：本文不提供任何破解版、盗版资源，仅供个人导航使用，一切后果，包括但不限于版权纠纷、病毒木马，由使用者自行承担。</p></blockquote><h2 id="一些好用的东西"><a href="#一些好用的东西" class="headerlink" title="一些好用的东西"></a>一些好用的东西</h2><h3 id="壳"><a href="#壳" class="headerlink" title="壳"></a>壳</h3><blockquote><p><strong>俊于，开源，安全</strong></p><p><a href="https://github.com/pvqogw/TVBoxOSC/releases/download/20230601-1755/TVBox_q215613905_20230601-1755.apk">Android 4.4+老版本用</a>    <a href="https://ghproxy.com/https://github.com/pvqogw/TVBoxOSC/releases/download/20230601-1755/TVBox_q215613905_20230601-1755.apk">加速1</a>    <a href="https://github.cooluc.com/https://github.com/pvqogw/TVBoxOSC/releases/download/20230601-1755/TVBox_q215613905_20230601-1755.apk">加速2</a></p></blockquote><blockquote><p><strong>黑盒，开源，安全</strong></p><p><a href="https://github.com/o0HalfLife0o/TVBoxOSC/releases/download/20230711-0921/TVBox_takagen99_20230711-0921.apk">Android 5.0+用</a>    <a href="https://ghproxy.com/https://github.com/o0HalfLife0o/TVBoxOSC/releases/download/20230711-0921/TVBox_takagen99_20230711-0921.apk">加速1</a>    <a href="https://github.cooluc.com/https://github.com/o0HalfLife0o/TVBoxOSC/releases/download/20230711-0921/TVBox_takagen99_20230711-0921.apk">加速2</a></p></blockquote><blockquote><p><strong>FongMi，支持java、python、手机、电视、arm64，开源，安全</strong></p><p>电视用：</p><p><a href="https://github.com/FongMi/TV/releases/download/leanback/leanback-4.1.apk">Android 4.1+ 老版本用</a>    <a href="https://ghproxy.com/https://github.com/FongMi/TV/releases/download/leanback/leanback-4.1.apk">加速1</a>    <a href="https://github.cooluc.com/https://github.com/FongMi/TV/releases/download/leanback/leanback-4.1.apk">加速2</a></p><p><a href="https://github.com/FongMi/TV/releases/download/leanback/leanback-java-arm64_v8a.apk">java-arm64</a>    <a href="https://ghproxy.com/https://github.com/FongMi/TV/releases/download/leanback/leanback-java-arm64_v8a.apk">加速1</a>    <a href="https://github.cooluc.com/https://github.com/FongMi/TV/releases/download/leanback/leanback-java-arm64_v8a.apk">加速2</a></p><p><a href="https://github.com/FongMi/TV/releases/download/leanback/leanback-java-armeabi_v7a.apk">java-arm32</a>    <a href="https://ghproxy.com/https://github.com/FongMi/TV/releases/download/leanback/leanback-java-armeabi_v7a.apk">加速1</a>    <a href="https://github.cooluc.com/https://github.com/FongMi/TV/releases/download/leanback/leanback-java-armeabi_v7a.apk">加速2</a></p><p><a href="https://github.com/FongMi/TV/releases/download/leanback/leanback-python-arm64_v8a.apk">python-arm64</a>    <a href="https://ghproxy.com/https://github.com/FongMi/TV/releases/download/leanback/leanback-python-arm64_v8a.apk">加速1</a>    <a href="https://github.cooluc.com/https://github.com/FongMi/TV/releases/download/leanback/leanback-python-arm64_v8a.apk">加速2</a></p><p><a href="https://github.com/FongMi/TV/releases/download/leanback/leanback-python-armeabi_v7a.apk">python-arm32</a>    <a href="https://ghproxy.com/https://github.com/FongMi/TV/releases/download/leanback/leanback-python-armeabi_v7a.apk">加速1</a>    <a href="https://github.cooluc.com/https://github.com/FongMi/TV/releases/download/leanback/leanback-python-armeabi_v7a.apk">加速2</a></p><p>手机用：</p><p><a href="https://github.com/FongMi/TV/releases/download/mobile/mobile-java-arm64_v8a.apk">java-arm64</a>    <a href="https://ghproxy.com/https://github.com/FongMi/TV/releases/download/mobile/mobile-java-arm64_v8a.apk">加速1</a>    <a href="https://github.cooluc.com/https://github.com/FongMi/TV/releases/download/mobile/mobile-java-arm64_v8a.apk">加速2</a></p><p><a href="https://github.com/FongMi/TV/releases/download/mobile/mobile-java-armeabi_v7a.apk">java-arm32</a>    <a href="https://ghproxy.com/https://github.com/FongMi/TV/releases/download/mobile/mobile-java-armeabi_v7a.apk">加速1</a>    <a href="https://github.cooluc.com/https://github.com/FongMi/TV/releases/download/mobile/mobile-java-armeabi_v7a.apk">加速2</a></p><p><a href="https://github.com/FongMi/TV/releases/download/mobile/mobile-python-arm64_v8a.apk">python-arm64</a>    <a href="https://ghproxy.com/https://github.com/FongMi/TV/releases/download/mobile/mobile-python-arm64_v8a.apk">加速1</a>    <a href="https://github.cooluc.com/https://github.com/FongMi/TV/releases/download/mobile/mobile-python-arm64_v8a.apk">加速2</a></p><p><a href="https://github.com/FongMi/TV/releases/download/mobile/mobile-python-armeabi_v7a.apk">python-arm32</a>    <a href="https://ghproxy.com/https://github.com/FongMi/TV/releases/download/mobile/mobile-python-armeabi_v7a.apk">加速1</a>    <a href="https://github.cooluc.com/https://github.com/FongMi/TV/releases/download/mobile/mobile-python-armeabi_v7a.apk">加速2</a></p></blockquote><p><a href="https://liucn.lanzouf.com/iZlVl0jsm5kf">竖屏</a></p><h3 id="源"><a href="#源" class="headerlink" title="源"></a>源</h3><p><a href="http://饭太硬.ga/tv">主力</a></p><p><a href="https://ghproxy.com/raw.githubusercontent.com/FongMi/CatVodSpider/main/json/config.json">FM</a></p><h2 id="一些有用的东西"><a href="#一些有用的东西" class="headerlink" title="一些有用的东西"></a>一些有用的东西</h2><p><a href="https://github.com/liu673cn/box">box</a>（<a href="https://raw.liucn.cc/box/">page</a>）</p><p><a href="http://饭太硬.ga/">饭太硬</a></p><p><a href="http://肥猫.love/">肥猫</a></p><p>吾爱：<a href="https://wuaiyousan.lanzoui.com/b02unwved">壳</a>    <a href="https://wuaiyousan.lanzoui.com/b02v72i4f">接口</a>    <a href="http://52bsj.vip:98/wuai">源</a></p><p><a href="https://alist.xrgzs.top/xr/uploads/media/20230318001.mp4">内部资料</a></p><h2 id="一些特别的东西"><a href="#一些特别的东西" class="headerlink" title="一些特别的东西"></a>一些特别的东西</h2><p><a href="https://423down.lanzouo.com/b0f19eo3c">MX播放器-423</a></p><p><a href="https://423down.lanzouo.com/b0f1944aj">ATVAPPs-423</a></p>]]></content>
      
      
      <categories>
          
          <category> 资源 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 资源 </tag>
            
            <tag> 影视 </tag>
            
            <tag> 影音 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu/Debian 设置 IPv4 优先</title>
      <link href="/posts/debian-set-ipv4-first.html"/>
      <url>/posts/debian-set-ipv4-first.html</url>
      
        <content type="html"><![CDATA[<h1 id="Ubuntu-x2F-Debian-设置-IPv4-优先，解决-IPv6-云主机-安装-Alist-报错-TLS-握手失败"><a href="#Ubuntu-x2F-Debian-设置-IPv4-优先，解决-IPv6-云主机-安装-Alist-报错-TLS-握手失败" class="headerlink" title="Ubuntu&#x2F;Debian 设置 IPv4 优先，解决 IPv6 云主机 安装 Alist 报错 TLS 握手失败"></a>Ubuntu&#x2F;Debian 设置 IPv4 优先，解决 IPv6 云主机 安装 Alist 报错 TLS 握手失败</h1><p>记录一下，以备后用。</p><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>服务器：阿里云 ecs.s6-c1m1.small 开启了 IPv6。</p><p>系统：新装 Ubuntu  20.04 64位。</p><p>操作：使用官网命令一键安装 Alist</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> <span class="token string">"https://alist.nn.ci/v3.sh"</span> <span class="token operator">|</span> <span class="token function">bash</span> <span class="token parameter variable">-s</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>报错：TLS 握手失败。</p><h2 id="经过"><a href="#经过" class="headerlink" title="经过"></a>经过</h2><p>猜测&amp;分析：与防火墙有关，新装系统排除自带防火墙。</p><p>进一步猜测：查看 ECS 安全组设置，无异常，与 IPv6 有关。</p><p>找到原因：在 <code>专有网络/IPv6网关</code> 中配置了 <code>仅主动出规则</code>，导致 TLS 握手失败。</p><h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p>解决办法：</p><ol><li>删除 <code>仅主动出规则</code>：由于担心费流量，所以没有采取。</li><li>设置系统网络配置 IPv4 优先，不用修改过多配置，实测有效。</li></ol><blockquote><p>附：Windows 系统解决办法：</p><p><a href="https://www.xyboot.com/xqyexnryfesrnnqtwqqgmkeiukhpxnzyxtrhuqkckhuypmvvyefpfznyhwheqstf/">Windows [IPV4 &amp; IPV6] 优先级设置 – 杏雨梨云启动维护系统</a></p></blockquote><p>步骤：</p><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;etc&#x2F;gai.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将：</p><blockquote><p>#precedence ::ffff:0:0&#x2F;96 100</p></blockquote><p>改为：</p><blockquote><p><code>precedence ::ffff:0:0/96 100</code></p></blockquote><p>无需重启，立即生效！</p>]]></content>
      
      
      <categories>
          
          <category> 服务器运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 服务器运维 </tag>
            
            <tag> 服务器 </tag>
            
            <tag> 网络 </tag>
            
            <tag> IPv6 </tag>
            
            <tag> Ubuntu </tag>
            
            <tag> Debian </tag>
            
            <tag> Alist </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>潇然工作室 Xiaoran Studio</title>
      <link href="/xrgzs.html"/>
      <url>/xrgzs.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://m.360buyimg.com/babel/jfs/t1/122493/5/31571/42364/6400bf05F27a93c6d/b2d57deac2b077ac.jpg"></p><h1 id="潇然工作室-Xiaoran-Studio"><a href="#潇然工作室-Xiaoran-Studio" class="headerlink" title="潇然工作室 Xiaoran Studio"></a>潇然工作室 Xiaoran Studio</h1><h2 id="潇然工作室网站"><a href="#潇然工作室网站" class="headerlink" title="潇然工作室网站"></a>潇然工作室网站</h2><p><a href="https://space.bilibili.com/73271091">潇然工作室B站频道</a></p><p><a href="https://xrgzs.github.io/">潇然工作室主页</a></p><p><a href="http://xrgzs.ysepan.com/">潇然藏经阁</a></p><h2 id="关于潇然工作室"><a href="#关于潇然工作室" class="headerlink" title="关于潇然工作室"></a>关于潇然工作室</h2><p><strong>潇然工作室</strong>成立于2017年，是一个提供<strong>家庭网络规划</strong>、<strong>网络设备维护</strong>、<strong>电脑组装维修</strong>、<strong>电脑远程维修</strong>、<strong>系统封装定制</strong>、<strong>信息应用培训</strong>等多项网络业务及<strong>活动拍摄录像</strong>、<strong>视频剪辑制作</strong>、<strong>PPT设计</strong>等多项媒体业务的个人性质的组织。</p><p><img src="https://s1.ax1x.com/2020/04/29/J7WwtK.png"></p><h2 id="网维常用网站"><a href="#网维常用网站" class="headerlink" title="网维常用网站"></a>网维常用网站</h2><h3 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h3><h4 id="最新发布"><a href="#最新发布" class="headerlink" title="最新发布"></a>最新发布</h4><p><a href="https://www.423down.com/">423Down</a>：一手软件资源</p><p><a href="https://weidown.com/">微当下载</a>：传统下载站，资源更新勤快</p><p><a href="https://www.carrotchou.blog/">胡萝卜周</a>：已挂</p><p><a href="https://www.ghxi.com/">果核剥壳</a>：胡萝卜挂后的替代品</p><p><a href="https://apphot.cc/">心海E站（Apphot）</a>：烈火修改软件</p><p><a href="https://www.ypojie.com/">亿破姐</a>：备用，含部分冷门软件</p><p><a href="https://www.isharepc.com/">乐软博客</a>：阿刚同学，软件小工具使用教程分享</p><p><a href="https://www.iplaysoft.com/">异次元</a>：超前的软件信息推荐</p><p><a href="https://www.appinn.com/">小众软件</a>：超前的软件信息推荐</p><p><a href="https://www.extfans.com/">扩展迷</a>：Chrome浏览器插件，多款新标签页作者</p><h4 id="原创整合"><a href="#原创整合" class="headerlink" title="原创整合"></a>原创整合</h4><p><a href="https://www.423down.com/">423Down</a>：大量国内资源都来自此站</p><p><a href="https://weibo.com/vposy">@vposy</a>：Adobe直装版</p><p><a href="http://www.th-sjy.com/">TH_SJY汉化</a>：多款软件汉化版作者</p><p><a href="http://www.qiuquan.org/">QiuQuan’s Blog</a>：多款软件安装器打包作者，部分资源无法下载</p><p><a href="https://www.mefcl.com/">mefcl</a>：多款软件安装器打包作者</p><h3 id="原版系统"><a href="#原版系统" class="headerlink" title="原版系统"></a>原版系统</h3><p><a href="https://msdn.itellyou.cn/">MSDN, 我告诉你</a>：老站已停止更新</p><p><a href="https://files.rg-adguard.net/">rgadguard’s List of files by Microsoft</a>：ITellYou、TechBench 的替代品，更新即时</p><p><a href="https://tb.rg-adguard.net/">rgadguard’s TechBench by WZT</a>：已停更</p><p><a href="https://uup.rg-adguard.net/">rgadguard’s UUP Generation Project </a>：脚本有问题不推荐</p><p><a href="https://store.rg-adguard.net/">rgadguard’s Microsoft Store Generation Project</a>：下载微软商店APPX离线包</p><p><a href="https://forums.mydigitallife.net/">My Digital Life Forums</a>：MDL论坛，真正的MSDN资源分享</p><p><a href="https://opendirectory.luzea.de/">luzea‘s OpenDirectory</a>：部分MDL资源直链下载</p><p><a href="https://uupdump.net/">UUP DUMP</a>：最新系统自动组装，推荐</p><p><a href="https://www.uupdump.cn/">UUP DUMP CN</a>：不忘初心分流</p><p><a href="https://otp.landian.vip/">Office Tool Plus</a>：最新Office便捷化部署工具</p><h3 id="装机资源"><a href="#装机资源" class="headerlink" title="装机资源"></a>装机资源</h3><p><a href="https://www.pcbeta.com/">远景论坛</a>：国内系统交流网站</p><p><a href="http://www.smxdiy.com/">SMXDIY</a>：BIOS修改，新平台装Win7</p><p><a href="https://www.itsk.com/">IT天空</a>：优启通、万能驱动、ES封装工具</p><p><a href="https://www.sysceo.com/">系统总裁</a>：USM、驱动总裁、SC封装工具</p><p><a href="https://www.yrxitong.com/">小鱼儿YR</a>：专注于系统封装重装系统下载软件分享教程</p><p><a href="https://www.puresys.net/">Puresys</a>：以纯净为第一要义，为广大网友提供一个便捷、安全的下载站</p><p><a href="http://www.far123.com/">远航技术</a>：封装版系统下载，马甲：<a href="http://www.aichunjing.com/">爱纯净</a></p><p><a href="http://www.51cxsoft.com/">优捷易_祥电科技</a>：潇然一键装机助理、<a href="https://www.firpe.cn/">FirPE Project</a>等多款装机工具就是跟他定制的</p><h2 id="联系方式"><a href="#联系方式" class="headerlink" title="联系方式"></a>联系方式</h2><ul><li>B站：<a href="https://space.bilibili.com/73271091">潇然工作室</a></li><li>酷安：<a href="https://www.coolapk.com/u/1324579">狂犬主子</a></li><li>QQ：2744460679</li></ul>]]></content>
      
      
      <categories>
          
          <category> 潇然工作室 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 潇然工作室 </tag>
            
            <tag> Xiaoran Studio </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS 7 非 LVM 硬盘简单扩容</title>
      <link href="/posts/centos-7-not-lvm-extend.html"/>
      <url>/posts/centos-7-not-lvm-extend.html</url>
      
        <content type="html"><![CDATA[<h1 id="CentOS-7-非-LVM-硬盘简单扩容"><a href="#CentOS-7-非-LVM-硬盘简单扩容" class="headerlink" title="CentOS 7 非 LVM 硬盘简单扩容"></a>CentOS 7 非 LVM 硬盘简单扩容</h1><h2 id="查看分区信息"><a href="#查看分区信息" class="headerlink" title="查看分区信息"></a>查看分区信息</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># lsblk</span>NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTsda      <span class="token number">8</span>:0    <span class="token number">0</span>   20G  <span class="token number">0</span> disk└─sda1   <span class="token number">8</span>:1    <span class="token number">0</span>    8G  <span class="token number">0</span> part /sr0     <span class="token number">11</span>:0    <span class="token number">1</span> 1024M  <span class="token number">0</span> romsr1     <span class="token number">11</span>:1    <span class="token number">1</span> 1024M  <span class="token number">0</span> rom<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># df -h</span>Filesystem      Size  Used Avail Use% Mounted ondevtmpfs        900M     <span class="token number">0</span>  900M   <span class="token number">0</span>% /devtmpfs           919M     <span class="token number">0</span>  919M   <span class="token number">0</span>% /dev/shmtmpfs           919M   17M  903M   <span class="token number">2</span>% /runtmpfs           919M     <span class="token number">0</span>  919M   <span class="token number">0</span>% /sys/fs/cgroup/dev/sda1       <span class="token number">8</span>.0G  <span class="token number">3</span>.8G  <span class="token number">4</span>.3G  <span class="token number">48</span>% /tmpfs           184M     <span class="token number">0</span>  184M   <span class="token number">0</span>% /run/user/0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="重新分区"><a href="#重新分区" class="headerlink" title="重新分区"></a>重新分区</h2><p>用 cfdisk 也行，反正就是把原来的分区删了新建一个然后保存</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># fdisk  /dev/sda</span>Welcome to <span class="token function">fdisk</span> <span class="token punctuation">(</span>util-linux <span class="token number">2.23</span>.2<span class="token punctuation">)</span>.Changes will remain <span class="token keyword">in</span> memory only, <span class="token keyword">until</span> you decide to <span class="token function">write</span> them.Be careful before using the <span class="token function">write</span> command.Command <span class="token punctuation">(</span>m <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: pDisk /dev/sda: <span class="token number">21.5</span> GB, <span class="token number">21474836480</span> bytes, <span class="token number">41943040</span> sectorsUnits <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytesSector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytesI/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytesDisk label type: dosDisk identifier: 0x00095067   Device Boot      Start         End      Blocks   Id  System/dev/sda1   *        <span class="token number">2048</span>    <span class="token number">16777215</span>     <span class="token number">8387584</span>   <span class="token number">83</span>  LinuxCommand <span class="token punctuation">(</span>m <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: dSelected partition <span class="token number">1</span>Partition <span class="token number">1</span> is deletedCommand <span class="token punctuation">(</span>m <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: pDisk /dev/sda: <span class="token number">21.5</span> GB, <span class="token number">21474836480</span> bytes, <span class="token number">41943040</span> sectorsUnits <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytesSector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytesI/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytesDisk label type: dosDisk identifier: 0x00095067   Device Boot      Start         End      Blocks   Id  SystemCommand <span class="token punctuation">(</span>m <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: nPartition type:   p   primary <span class="token punctuation">(</span><span class="token number">0</span> primary, <span class="token number">0</span> extended, <span class="token number">4</span> <span class="token function">free</span><span class="token punctuation">)</span>   e   extendedSelect <span class="token punctuation">(</span>default p<span class="token punctuation">)</span>: pPartition number <span class="token punctuation">(</span><span class="token number">1</span>-4, default <span class="token number">1</span><span class="token punctuation">)</span>:First sector <span class="token punctuation">(</span><span class="token number">2048</span>-41943039, default <span class="token number">2048</span><span class="token punctuation">)</span>:Using default value <span class="token number">2048</span>Last sector, +sectors or +size<span class="token punctuation">&#123;</span>K,M,G<span class="token punctuation">&#125;</span> <span class="token punctuation">(</span><span class="token number">2048</span>-41943039, default <span class="token number">41943039</span><span class="token punctuation">)</span>:Using default value <span class="token number">41943039</span>Partition <span class="token number">1</span> of <span class="token builtin class-name">type</span> Linux and of size <span class="token number">20</span> GiB is <span class="token builtin class-name">set</span>Command <span class="token punctuation">(</span>m <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: pDisk /dev/sda: <span class="token number">21.5</span> GB, <span class="token number">21474836480</span> bytes, <span class="token number">41943040</span> sectorsUnits <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytesSector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytesI/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytesDisk label type: dosDisk identifier: 0x00095067   Device Boot      Start         End      Blocks   Id  System/dev/sda1            <span class="token number">2048</span>    <span class="token number">41943039</span>    <span class="token number">20970496</span>   <span class="token number">83</span>  LinuxCommand <span class="token punctuation">(</span>m <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: wThe partition table has been altered<span class="token operator">!</span>Calling ioctl<span class="token punctuation">(</span><span class="token punctuation">)</span> to re-read partition table.WARNING: Re-reading the partition table failed with error <span class="token number">16</span>: Device or resource busy.The kernel still uses the old table. The new table will be used atthe next <span class="token function">reboot</span> or after you run partprobe<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> or kpartx<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>Syncing disks.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="刷新分区"><a href="#刷新分区" class="headerlink" title="刷新分区"></a>刷新分区</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># partprobe /dev/sda</span><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># lsblk</span>NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTsda      <span class="token number">8</span>:0    <span class="token number">0</span>   20G  <span class="token number">0</span> disk└─sda1   <span class="token number">8</span>:1    <span class="token number">0</span>   20G  <span class="token number">0</span> part /sr0     <span class="token number">11</span>:0    <span class="token number">1</span> 1024M  <span class="token number">0</span> romsr1     <span class="token number">11</span>:1    <span class="token number">1</span> 1024M  <span class="token number">0</span> rom<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># df -h</span>Filesystem      Size  Used Avail Use% Mounted ondevtmpfs        900M     <span class="token number">0</span>  900M   <span class="token number">0</span>% /devtmpfs           919M     <span class="token number">0</span>  919M   <span class="token number">0</span>% /dev/shmtmpfs           919M   17M  903M   <span class="token number">2</span>% /runtmpfs           919M     <span class="token number">0</span>  919M   <span class="token number">0</span>% /sys/fs/cgroup/dev/sda1       <span class="token number">8</span>.0G  <span class="token number">3</span>.8G  <span class="token number">4</span>.2G  <span class="token number">48</span>% /tmpfs           184M     <span class="token number">0</span>  184M   <span class="token number">0</span>% /run/user/0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="扩容分区"><a href="#扩容分区" class="headerlink" title="扩容分区"></a>扩容分区</h2><p>如果磁盘格式是 xfs：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># xfs_growfs /dev/sda1</span>meta-data<span class="token operator">=</span>/dev/sda1              <span class="token assign-left variable">isize</span><span class="token operator">=</span><span class="token number">512</span>    <span class="token assign-left variable">agcount</span><span class="token operator">=</span><span class="token number">4</span>, <span class="token assign-left variable">agsize</span><span class="token operator">=</span><span class="token number">524224</span> blks         <span class="token operator">=</span>                       <span class="token assign-left variable">sectsz</span><span class="token operator">=</span><span class="token number">512</span>   <span class="token assign-left variable">attr</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">projid32bit</span><span class="token operator">=</span><span class="token number">1</span>         <span class="token operator">=</span>                       <span class="token assign-left variable">crc</span><span class="token operator">=</span><span class="token number">1</span>        <span class="token assign-left variable">finobt</span><span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">spinodes</span><span class="token operator">=</span><span class="token number">0</span>data     <span class="token operator">=</span>                       <span class="token assign-left variable">bsize</span><span class="token operator">=</span><span class="token number">4096</span>   <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">2096896</span>, <span class="token assign-left variable">imaxpct</span><span class="token operator">=</span><span class="token number">25</span>         <span class="token operator">=</span>                       <span class="token assign-left variable">sunit</span><span class="token operator">=</span><span class="token number">0</span>      <span class="token assign-left variable">swidth</span><span class="token operator">=</span><span class="token number">0</span> blksnaming   <span class="token operator">=</span>version <span class="token number">2</span>              <span class="token assign-left variable">bsize</span><span class="token operator">=</span><span class="token number">4096</span>   ascii-ci<span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">ftype</span><span class="token operator">=</span><span class="token number">1</span>log      <span class="token operator">=</span>internal               <span class="token assign-left variable">bsize</span><span class="token operator">=</span><span class="token number">4096</span>   <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">2560</span>, <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token number">2</span>         <span class="token operator">=</span>                       <span class="token assign-left variable">sectsz</span><span class="token operator">=</span><span class="token number">512</span>   <span class="token assign-left variable">sunit</span><span class="token operator">=</span><span class="token number">0</span> blks, lazy-count<span class="token operator">=</span><span class="token number">1</span>realtime <span class="token operator">=</span>none                   <span class="token assign-left variable">extsz</span><span class="token operator">=</span><span class="token number">4096</span>   <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">rtextents</span><span class="token operator">=</span><span class="token number">0</span>data blocks changed from <span class="token number">2096896</span> to <span class="token number">5242624</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如果磁盘格式是 ext4：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># resize2fs /dev/sda1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="扩容完成"><a href="#扩容完成" class="headerlink" title="扩容完成"></a>扩容完成</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># df -h</span>Filesystem      Size  Used Avail Use% Mounted ondevtmpfs        900M     <span class="token number">0</span>  900M   <span class="token number">0</span>% /devtmpfs           919M     <span class="token number">0</span>  919M   <span class="token number">0</span>% /dev/shmtmpfs           919M   17M  903M   <span class="token number">2</span>% /runtmpfs           919M     <span class="token number">0</span>  919M   <span class="token number">0</span>% /sys/fs/cgroup/dev/sda1        20G  <span class="token number">3</span>.8G   17G  <span class="token number">19</span>% /tmpfs           184M     <span class="token number">0</span>  184M   <span class="token number">0</span>% /run/user/0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>参考资料：</p><p><a href="https://blog.csdn.net/weixin_47139540/article/details/124800503">Centos 7如何进行磁盘扩容（LVM+非LVM）_centos磁盘扩容_氧化心的博客-CSDN博客</a></p>]]></content>
      
      
      <categories>
          
          <category> 服务器运维 </category>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> CentOS </tag>
            
            <tag> 硬盘扩容 </tag>
            
            <tag> xfs </tag>
            
            <tag> 服务器运维 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Typora 配置 API 图床</title>
      <link href="/posts/typora-config-api-picgo.html"/>
      <url>/posts/typora-config-api-picgo.html</url>
      
        <content type="html"><![CDATA[<h1 id="Typora-配置-API-图床"><a href="#Typora-配置-API-图床" class="headerlink" title="Typora 配置 API 图床"></a>Typora 配置 API 图床</h1><h2 id="1-安装PicGo-Core"><a href="#1-安装PicGo-Core" class="headerlink" title="1. 安装PicGo-Core"></a>1. 安装PicGo-Core</h2><p>Typora-&gt;文件-&gt;偏好设置-&gt;图像-&gt;上传服务设定</p><p>上传服务：PicGo-Core (command-line)</p><p>下载或更新-&gt;下载</p><h2 id="2-安装picgo-web-uploader"><a href="#2-安装picgo-web-uploader" class="headerlink" title="2. 安装picgo-web-uploader"></a>2. 安装picgo-web-uploader</h2><p>打开cmd，输入：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /d %APPDATA%<span class="token punctuation">\</span>Typora<span class="token punctuation">\</span>picgo<span class="token punctuation">\</span>win64picgo.exe <span class="token function">install</span> web-uploader<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>如果成功会打印出下面的内容：</p><pre class="line-numbers language-none"><code class="language-none">added 1 package, and audited 2 packages in 5sfound 0 vulnerabilities[PicGo SUCCESS]: 插件安装成功<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-配置picgo-web-uploader"><a href="#3-配置picgo-web-uploader" class="headerlink" title="3. 配置picgo-web-uploader"></a>3. 配置picgo-web-uploader</h2><p>cmd内继续输入：</p><pre class="line-numbers language-none"><code class="language-none">picgo.exe config uploader<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果成功会打印出下面的内容：</p><pre class="line-numbers language-none"><code class="language-none">? Choose a(n) uploader  imgur  aliyun  upyun&gt; web-uploader  smms  tcyun  github(Move up and down to reveal more choices)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>选择<code>web-uploader</code>，回车，如果成功会打印出下面的内容：</p><pre class="line-numbers language-none"><code class="language-none">? Choose a(n) uploader web-uploader? API地址<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>查询API文档，如：</p><p><a href="https://cdnjson.com/page/client">https://cdnjson.com/page/client</a></p><p><a href="http://doc.tucang.cc/project-1/doc-7/">http://doc.tucang.cc/project-1/doc-7/</a></p><blockquote><p>接口地址：<a href="https://cdnjson.com/api/1/upload">https://cdnjson.com/api/1/upload</a></p><p>方法：POST</p><p>key：API秘钥</p><p>source：图片</p><p>API秘钥: A5754F590B1A486421B3FC422D0CB1C6AA</p><p>测试：不可用</p></blockquote><blockquote><p>附：图仓接口：</p><p>API地址：<a href="https://tucang.cc/api/v1/upload">https://tucang.cc/api/v1/upload</a></p><p>POST参数名：file</p><p>JSON路径：data.url</p><p>自定义请求头：</p><p>自定义Body：{“token”:”你的TOKEN”,”sync”:”true”}</p><p>测试：待更新</p></blockquote><blockquote><p>附：yaohuo-jd接口：</p><p>API地址：<a href="https://yh-pic.ihcloud.net/api/jd.php">https://yh-pic.ihcloud.net/api/jd.php</a></p><p>POST参数名：image</p><p>JSON路径：data.url</p><p>自定义请求头：{“user-agent”:”Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;95.0.4638.69 Safari&#x2F;537.36”}</p><p>测试：<img src="https://kjimg10.360buyimg.com/ott/jfs/t20250509/123742/23/32912/972/645b035aF33a50e52/0f5589574d694ca2.png"></p></blockquote><blockquote><p>附：ldmnq接口：</p><p>API地址：<a href="https://bbs.ldmnq.com/api/bbs/upload?dir=topic/attachment">https://bbs.ldmnq.com/api/bbs/upload?dir=topic/attachment</a></p><p>POST参数名：file</p><p>JSON路径：data.data.0</p><p>自定义请求头：{“user-agent”:”Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;95.0.4638.69 Safari&#x2F;537.36”}</p><p>测试：<img src="https://ldbbs.ldmnq.com/bbs/topic/attachment/2023-4/2455bee0-f11d-4a2c-ae69-2e155d6755ec.png"></p></blockquote><blockquote><p>附：mi-qiye接口：</p><p>API地址：<a href="https://qiye.mi.com/index/upload">https://qiye.mi.com/index/upload</a></p><p>POST参数名：uploadImg</p><p>JSON路径：data.key</p><p>获取cookie：登录<a href="https://qiye.mi.com/">https://qiye.mi.com/</a>，访问<a href="https://qiye.mi.com/index/upload">https://qiye.mi.com/index/upload</a>，F12-&gt;网络抓取cookie，注意需要转义“<code>&quot;</code>”为“<code>\&quot;</code>”，或使用<a href="https://tooltt.com/header2json/">在线HTTP请求头响应头转JSON工具 - ToolTT在线工具箱</a></p><p>自定义请求头：{“cookie”:”输入您的cookie内容”,”user-agent”:”Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;111.0.0.0 Safari&#x2F;537.36 Edg&#x2F;111.0.1661.51”}</p><p>测试：<img src="https://img06.mifile.cn/v1/MI_542ED8B1722DC/ff2a16176fd728ceac599e2c8387dee2.png"></p></blockquote><p><strong>以下演示的接口暂不可用，请自行替换为可用的接口！</strong></p><p>我们便输入：<a href="https://cdnjson.com/api/1/upload">https://cdnjson.com/api/1/upload</a>，回车，如果成功会打印出下面的内容：</p><pre class="line-numbers language-none"><code class="language-none">? Choose a(n) uploader web-uploader? API地址 https:&#x2F;&#x2F;cdnjson.com&#x2F;api&#x2F;1&#x2F;upload? POST参数名<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>我们便输入：source，回车，如果成功会打印出下面的内容：</p><pre class="line-numbers language-none"><code class="language-none">? Choose a(n) uploader web-uploader? API地址 https:&#x2F;&#x2F;cdnjson.com&#x2F;api&#x2F;1&#x2F;upload? POST参数名 source? 图片URL JSON路径(eg: data.url)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>这里文档上没有，我们便输入：data.url，回车，如果成功会打印出下面的内容：</p><pre class="line-numbers language-none"><code class="language-none">? Choose a(n) uploader web-uploader? API地址 https:&#x2F;&#x2F;cdnjson.com&#x2F;api&#x2F;1&#x2F;upload? POST参数名 source? 图片URL JSON路径(eg: data.url) data.url? 自定义请求头 标准JSON(eg: &#123;&quot;key&quot;:&quot;value&quot;&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里我们无特殊需求，回车，如果成功会打印出下面的内容：</p><pre class="line-numbers language-none"><code class="language-none">? Choose a(n) uploader web-uploader? API地址 https:&#x2F;&#x2F;cdnjson.com&#x2F;api&#x2F;1&#x2F;upload? POST参数名 source? 图片URL JSON路径(eg: data.url) data.url? 自定义请求头 标准JSON(eg: &#123;&quot;key&quot;:&quot;value&quot;&#125;)? 自定义Body 标准JSON(eg: &#123;&quot;key&quot;:&quot;value&quot;&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>我们根据API文档，可以得出，这里的自定义Body就是</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"key"</span><span class="token operator">:</span><span class="token string">"A5754F590B1A486421B3FC422D0CB1C6AA"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>我们便输入：{“key”:”A5754F590B1A486421B3FC422D0CB1C6AA”}，回车，如果成功会打印出下面的内容：</p><pre class="line-numbers language-none"><code class="language-none">? Choose a(n) uploader web-uploader? API地址 https:&#x2F;&#x2F;cdnjson.com&#x2F;api&#x2F;1&#x2F;upload? POST参数名 source? 图片URL JSON路径(eg: data.url) data.url? 自定义请求头 标准JSON(eg: &#123;&quot;key&quot;:&quot;value&quot;&#125;)? 自定义Body 标准JSON(eg: &#123;&quot;key&quot;:&quot;value&quot;&#125;) &#123;&quot;key&quot;:&quot;A5754F590B1A486421B3FC422D0CB1C6AA&quot;&#125;[PicGo SUCCESS]: Configure config successfully!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4-配置PicGo-Core"><a href="#4-配置PicGo-Core" class="headerlink" title="4. 配置PicGo-Core"></a>4. 配置PicGo-Core</h2><p>cmd内继续输入：</p><pre class="line-numbers language-none"><code class="language-none">picgo.exe use<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果成功会打印出下面的内容：</p><pre class="line-numbers language-none"><code class="language-none">? Use an uploader  imgur  aliyun  upyun&gt; web-uploader  smms  tcyun  github(Move up and down to reveal more choices)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>选择<code>web-uploader</code>，回车，如果成功会打印出下面的内容：</p><pre class="line-numbers language-none"><code class="language-none">? Use an uploader web-uploader? Use a transformer&gt; path  base64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>选择<code>path</code>，回车，如果成功会打印出下面的内容：</p><pre class="line-numbers language-none"><code class="language-none">? Use an uploader web-uploader? Use a transformer path? Use plugins (Press &lt;space&gt; to select, &lt;a&gt; to toggle all, &lt;i&gt; to invert selection)&gt;(*) picgo-plugin-web-uploader<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>回车，如果成功会打印出下面的内容：</p><pre class="line-numbers language-none"><code class="language-none">? Use an uploader web-uploader? Use a transformer path? Use plugins (Press &lt;space&gt; to select, &lt;a&gt; to toggle all, &lt;i&gt; to invert selection)picgo-plugin-web-uploader[PicGo SUCCESS]: Configure config successfully!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-验证Typora"><a href="#5-验证Typora" class="headerlink" title="5. 验证Typora"></a>5. 验证Typora</h2><p>Typora-&gt;文件-&gt;偏好设置-&gt;图像-&gt;上传服务设定</p><p>验证图片上传选项</p>]]></content>
      
      
      <categories>
          
          <category> Windows </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Typora </tag>
            
            <tag> PicGo </tag>
            
            <tag> Markdown </tag>
            
            <tag> 图床 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS Linux 解决证书过期问题</title>
      <link href="/posts/centos-linux-fix-ca.html"/>
      <url>/posts/centos-linux-fix-ca.html</url>
      
        <content type="html"><![CDATA[<h1 id="CentOS-Linux-解决证书过期问题"><a href="#CentOS-Linux-解决证书过期问题" class="headerlink" title="CentOS Linux 解决证书过期问题"></a>CentOS Linux 解决证书过期问题</h1><p>第一种方式：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum reinstall ca-certificates<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>第二种方式</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> https://curl.se/ca/cacert.pem <span class="token parameter variable">-o</span> /etc/pki/ca-trust/source/anchors/curl-cacert-updated.pem <span class="token operator">&amp;&amp;</span> update-ca-trust<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 服务器运维 </category>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> CentOS </tag>
            
            <tag> 服务器运维 </tag>
            
            <tag> 证书 </tag>
            
            <tag> curl </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Typecho 使用 MathJax 添加对 LaTeX 数学公式的支持</title>
      <link href="/posts/typecho-use-mathjax-add-latex-support.html"/>
      <url>/posts/typecho-use-mathjax-add-latex-support.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://m.360buyimg.com/babel/jfs/t1/94195/21/35873/2471122/63ff7fabF530b1f16/d86683d9e8bb485c.png"></p><h1 id="Typecho使用MathJax添加对LaTeX数学公式的支持"><a href="#Typecho使用MathJax添加对LaTeX数学公式的支持" class="headerlink" title="Typecho使用MathJax添加对LaTeX数学公式的支持"></a>Typecho使用MathJax添加对LaTeX数学公式的支持</h1><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>行内公式：$x&#x3D;\frac{-b\pm\sqrt{b^2-4ac}}{2a}$行内公式</p><p>行外公式：<br>$$<br>x&#x3D;\frac{-b\pm\sqrt{b^2-4ac}}{2a}<br>$$</p><h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><p>把以下代码复制到index.php的前面</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span>    <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>把以下代码复制到header.php的前面</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span>    <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/x-mathjax-config<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    MathJax<span class="token punctuation">.</span>Hub<span class="token punctuation">.</span><span class="token function">Config</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"tex2jax.js"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token literal-property property">jax</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"input/TeX"</span><span class="token punctuation">,</span> <span class="token string">"output/HTML-CSS"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token literal-property property">tex2jax</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token literal-property property">inlineMath</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span><span class="token string">'$'</span><span class="token punctuation">,</span><span class="token string">'$'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"\\("</span><span class="token punctuation">,</span><span class="token string">"\\)"</span><span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token literal-property property">displayMath</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span><span class="token string">'$$'</span><span class="token punctuation">,</span><span class="token string">'$$'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"\\["</span><span class="token punctuation">,</span><span class="token string">"\\]"</span><span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token literal-property property">processEscapes</span><span class="token operator">:</span> <span class="token boolean">true</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token string-property property">"HTML-CSS"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">availableFonts</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"TeX"</span><span class="token punctuation">]</span> <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://blog.csdn.net/u011134961/article/details/51290616">typecho博客页面显示数学公式_galaxy_robot的博客-CSDN博客_typecho 数学公式</a></p>]]></content>
      
      
      <categories>
          
          <category> Windows </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Typecho </tag>
            
            <tag> MathJax </tag>
            
            <tag> 建站 </tag>
            
            <tag> 网站 </tag>
            
            <tag> LaTeX </tag>
            
            <tag> 数学 </tag>
            
            <tag> 代码 </tag>
            
            <tag> 公式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网页去广告插件及规则脚本下载</title>
      <link href="/xrnoad.html"/>
      <url>/xrnoad.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://m.360buyimg.com/babel/jfs/t1/85521/25/35957/585977/63ff81acFee2ea5d3/20d4fa359a87dac1.png"></p><h1 id="网页去广告插件及规则脚本下载"><a href="#网页去广告插件及规则脚本下载" class="headerlink" title="网页去广告插件及规则脚本下载"></a>网页去广告插件及规则脚本下载</h1><h2 id="必备扩展："><a href="#必备扩展：" class="headerlink" title="必备扩展："></a>必备扩展：</h2><p>想要让你的浏览器实现更多功能？各种扩展插件少不了！</p><p>支持电脑版<a href="https://www.microsoft.com/zh-cn/edge">Microsoft Edge</a>、<a href="https://www.google.cn/intl/zh-CN/chrome/">Google Chrome</a>、<a href="http://www.centbrowser.cn/">百分浏览器</a>、<a href="https://www.twinkstar.com/">星愿浏览器</a>、<a href="https://browser.360.cn/ee/">360极速浏览器</a>等基于<a href="https://www.chromium.org/">Chromium</a>内核的浏览器安装扩展，也提供<a href="https://www.mozilla.org/zh-CN/firefox/">Mozilla Firefox</a>的插件链接。</p><p>Microsoft Edge支持安装Google Chrome的扩展。</p><p>还是不能下载？试试这个网站：<a href="https://www.crxsoso.com/">https://www.crxsoso.com/</a></p><p>手机浏览器不能装扩展？<a href="https://github.com/kiwibrowser/src.next/releases">Kiwi Browser</a>了解一下！</p><p>了解更多浏览器玩法，请访问：<a href="https://www.runningcheese.com/">https://www.runningcheese.com/</a></p><h3 id="去广告："><a href="#去广告：" class="headerlink" title="去广告："></a>去广告：</h3><table><thead><tr><th>插件名称</th><th>Chrome</th><th>Edge</th><th>Firefox</th><th>crx直链</th></tr></thead><tbody><tr><td>AdBlock Plus</td><td><a href="https://chrome.google.com/webstore/detail/cfhdojbkjhnklbpkdaibdccddilifddb">Chrome </a></td><td><a href="https://microsoftedge.microsoft.com/addons/detail/gmgoamodcdcjnbaobigkjelfplakmdhh">Edge</a></td><td><a href="https://addons.mozilla.org/addon/adblock-plus/">Firefox</a></td><td><a href="https://www.chrome-api.com/ext_files/cfhdojbkjhnklbpkdaibdccddilifddb.crx">.crx</a></td></tr><tr><td><strong>（推荐💖）uBlock Origin</strong></td><td><a href="https://www.chrome-api.com/ext_files/cjpalhdlnbpafiamejdnhcphjbkeiagm.crx">Chrome </a></td><td><a href="https://microsoftedge.microsoft.com/addons/detail/odfafepnkmbhccpbejgmiehpchacaeak">Edge</a></td><td><a href="https://addons.mozilla.org/addon/ublock-origin/">Firefox</a></td><td><a href="https://www.chrome-api.com/ext_files/cjpalhdlnbpafiamejdnhcphjbkeiagm.crx">.crx</a></td></tr></tbody></table><h3 id="脚本管理："><a href="#脚本管理：" class="headerlink" title="脚本管理："></a>脚本管理：</h3><table><thead><tr><th>插件名称</th><th>Chrome</th><th>Edge</th><th>Firefox</th><th>crx直链</th></tr></thead><tbody><tr><td>Tampermonkey 油猴</td><td><a href="https://chrome.google.com/webstore/detail/dhdgffkkebhmkfjojejmpbldmpobfkfo">Chrome</a></td><td><a href="https://microsoftedge.microsoft.com/addons/detail/iikmkjmpaadaobahmlepeloendndfphd">Edge</a></td><td><a href="https://addons.mozilla.org/addon/tampermonkey/">Firefox</a></td><td><a href="https://www.chrome-api.com/?id=dhdgffkkebhmkfjojejmpbldmpobfkfo">.crx</a></td></tr><tr><td><strong>（推荐💖）Violentmonkey 暴力猴</strong></td><td><a href="https://chrome.google.com/webstore/detail/jinjaccalgkegednnccohejagnlnfdag">Chrome</a></td><td><a href="https://microsoftedge.microsoft.com/addons/detail/eeagobfjdenkkddmbclomhiblgggliao">Edge</a></td><td><a href="https://addons.mozilla.org/addon/violentmonkey/">Firefox</a></td><td><a href="https://www.chrome-api.com/?id=jinjaccalgkegednnccohejagnlnfdag">.crx</a></td></tr></tbody></table><h3 id="功能增强："><a href="#功能增强：" class="headerlink" title="功能增强："></a>功能增强：</h3><table><thead><tr><th>插件名称</th><th>Chrome</th><th>Edge</th><th>Firefox</th><th>crx直链</th></tr></thead><tbody><tr><td>BitWarden密码管理</td><td><a href="https://chrome.google.com/webstore/detail/nngceckbapebfimnlniiiahkandclblb">Chrome</a></td><td><a href="https://microsoftedge.microsoft.com/addons/detail/jbkfoedolllekgbhcbcoahefnbanhhlh">Edge</a></td><td><a href="https://addons.mozilla.org/addon/bitwarden-password-manager/">Firefox</a></td><td><a href="https://www.chrome-api.com/?id=nngceckbapebfimnlniiiahkandclblb">.crx</a></td></tr><tr><td>Header Editor浏览器请求</td><td><a href="https://chrome.google.com/webstore/detail/eningockdidmgiojffjmkdblpjocbhgh">Chrome</a></td><td>-</td><td><a href="https://addons.mozilla.org/addon/header-editor/">Firefox</a></td><td><a href="https://www.chrome-api.com/?id=eningockdidmgiojffjmkdblpjocbhgh">.crx</a></td></tr><tr><td>UA切换和管理</td><td><a href="https://chrome.google.com/webstore/detail/bhchdcejhohfmigjafbampogmaanbfkg">Chrome</a></td><td><a href="https://microsoftedge.microsoft.com/addons/detail/cnjkedgepfdpdbnepgmajmmjdjkjnifa">Edge</a></td><td><a href="https://addons.mozilla.org/addon/user-agent-string-switcher/">Firefox</a></td><td><a href="https://www.chrome-api.com/?id=bhchdcejhohfmigjafbampogmaanbfkg">.crx</a></td></tr><tr><td>Proxy SwitchyOmega代理切换</td><td><a href="https://chrome.google.com/webstore/detail/padekgcemlokbadohgkifijomclgjgif">Chrome</a></td><td>-</td><td><a href="https://addons.mozilla.org/addon/switchyomega/">Firefox</a></td><td><a href="https://www.chrome-api.com/?id=padekgcemlokbadohgkifijomclgjgif">.crx</a></td></tr><tr><td>Distill Web Monitor监测网页更新</td><td><a href="https://chrome.google.com/webstore/detail/inlikjemeeknofckkjolnjbpehgadgge">Chrome</a></td><td><a href="https://microsoftedge.microsoft.com/addons/detail/hldhhgncaohjmpcjjhggekonocabhceg">Edge</a></td><td><a href="https://addons.mozilla.org/addon/cdistill-web-monitor-ff/">Firefox</a></td><td><a href="https://www.chrome-api.com/?id=inlikjemeeknofckkjolnjbpehgadgge">.crx</a></td></tr><tr><td>Aria2 manager</td><td><a href="https://chrome.google.com/webstore/detail/mpkodccbngfoacfalldjimigbofkhgjn">Chrome</a></td><td><a href="https://microsoftedge.microsoft.com/addons/detail/jjfgljkjddpcpfapejfkelkbjbehagbh">Edge</a></td><td><a href="https://addons.mozilla.org/addon/aria2manager/">Firefox</a></td><td><a href="https://www.chrome-api.com/?id=mpkodccbngfoacfalldjimigbofkhgjn">.crx</a></td></tr><tr><td>Chrono下载管理器</td><td><a href="https://chrome.google.com/webstore/detail/mciiogijehkdemklbdcbfkefimifhecn">Chrome</a></td><td>-</td><td>-</td><td><a href="https://www.chrome-api.com/?id=mciiogijehkdemklbdcbfkefimifhecn">.crx</a></td></tr><tr><td>猫抓 资源嗅探</td><td><a href="https://chrome.google.com/webstore/detail/jfedfbgedapdagkghmgibemcoggfppbb">Chrome</a></td><td><a href="https://microsoftedge.microsoft.com/addons/detail/oohmdefbjalncfplafanlagojlakmjci">Edge</a></td><td><a href="https://addons.mozilla.org/addon/cat-catch/">Firefox</a></td><td><a href="https://www.chrome-api.com/?id=jfedfbgedapdagkghmgibemcoggfppbb">.crx</a></td></tr><tr><td>视频下载器 - CoCoCut</td><td><a href="https://chrome.google.com/webstore/detail/mciiogijehkdemklbdcbfkefimifhecn">Chrome</a></td><td><a href="https://microsoftedge.microsoft.com/addons/detail/npdhgjfiikhgncaacnnodpfchmelnchm">Edge</a></td><td><a href="https://addons.mozilla.org/addon/cococut%E8%A7%86%E9%A2%91%E4%B8%8B%E8%BD%BD%E7%A5%9E%E5%99%A8/">Firefox</a></td><td><a href="https://www.chrome-api.com/?id=mciiogijehkdemklbdcbfkefimifhecn">.crx</a></td></tr><tr><td>Infinity新标签页</td><td><a href="https://chrome.google.com/webstore/detail/mciiogijehkdemklbdcbfkefimifhecn">Chrome</a></td><td><a href="https://microsoftedge.microsoft.com/addons/detail/hajlmbnnniemimmaehcefkamdadpjlfa">Edge</a></td><td><a href="https://addons.mozilla.org/addon/infinity-new-tab/">Firefox</a></td><td><a href="https://www.chrome-api.com/?id=nnnkddnnlpamobajfibfdgfnbcnkgngh">.crx</a></td></tr><tr><td>Video Speed Controller 视频加速播放</td><td><a href="https://chrome.google.com/webstore/detail/nffaoalbilbmmfgbnbgppjihopabppdk">Chrome</a></td><td>-</td><td>-</td><td><a href="https://www.chrome-api.com/?id=nffaoalbilbmmfgbnbgppjihopabppdk">.crx</a></td></tr><tr><td>喵喵折比价助手</td><td><a href="https://chrome.google.com/webstore/detail/ekbmhggedfdlajiikminikhcjffbleac">Chrome</a></td><td><a href="https://microsoftedge.microsoft.com/addons/detail/pbmmogmpniaejfceedmjhdobmenbggoo">Edge</a></td><td>-</td><td><a href="https://www.chrome-api.com/?id=ekbmhggedfdlajiikminikhcjffbleac">.crx</a></td></tr></tbody></table><h2 id="规则-amp-脚本："><a href="#规则-amp-脚本：" class="headerlink" title="规则&amp;脚本："></a>规则&amp;脚本：</h2><p>用规则&amp;脚本给扩展插上翅膀，让浏览体验起飞！</p><h3 id="规则查询："><a href="#规则查询：" class="headerlink" title="规则查询："></a>规则查询：</h3><p><a href="https://filterlists.com/">https://filterlists.com/</a></p><h3 id="推荐规则："><a href="#推荐规则：" class="headerlink" title="推荐规则："></a>推荐规则：</h3><p>以下规则可以适用于 AdGuard，AdBlock Plus，uBlock Origin 等拦截工具：</p><blockquote><p><strong>HalfLife规则：</strong></p><p><strong><a href="https://cdn.jsdelivr.net/gh/o0HalfLife0o/list@master/ad.txt">https://cdn.jsdelivr.net/gh/o0HalfLife0o/list@master/ad.txt</a></strong></p><p><a href="https://raw.githubusercontent.com/o0HalfLife0o/list/master/ad.txt">Github（国内不稳定）</a></p></blockquote><blockquote><p><strong>乘风广告过滤规则：</strong></p><p><strong><a href="https://cdn.jsdelivr.net/gh/xinggsf/Adblock-Plus-Rule@master/rule.txt">https://cdn.jsdelivr.net/gh/xinggsf/Adblock-Plus-Rule@master/rule.txt</a></strong></p><p><a href="https://raw.githubusercontent.com/xinggsf/Adblock-Plus-Rule/master/rule.txt">Github（国内不稳定）</a></p><p><strong>乘风视频广告过滤规则：</strong></p><p><strong><a href="https://cdn.jsdelivr.net/gh/xinggsf/Adblock-Plus-Rule@master/mv.txt">https://cdn.jsdelivr.net/gh/xinggsf/Adblock-Plus-Rule@master/mv.txt</a></strong></p><p><a href="https://raw.githubusercontent.com/xinggsf/Adblock-Plus-Rule/master/mv.txt">Github（国内不稳定）</a></p></blockquote><blockquote><p><strong>推荐导入以上三个，以下几个不稳定，不推荐导入</strong></p><p>EasyList China 国内网站广告过滤的主规则：</p><p><a href="https://easylist-downloads.adblockplus.org/easylistchina.txt">https://easylist-downloads.adblockplus.org/easylistchina.txt</a></p><p>EasyPrivacy 隐私保护规则：</p><p><a href="https://easylist-downloads.adblockplus.org/easyprivacy.txt">https://easylist-downloads.adblockplus.org/easyprivacy.txt</a></p><p>CJX’s Annoyance List 自我推广过滤规则：</p><p><a href="https://raw.githubusercontent.com/cjx82630/cjxlist/master/cjx-annoyance.txt">https://raw.githubusercontent.com/cjx82630/cjxlist/master/cjx-annoyance.txt</a></p><p>I don’t care about cookies 屏蔽网站的 cookies 警告规则：</p><p><a href="https://www.i-dont-care-about-cookies.eu/abp/">https://www.i-dont-care-about-cookies.eu/abp/</a></p></blockquote><h3 id="脚本下载："><a href="#脚本下载：" class="headerlink" title="脚本下载："></a>脚本下载：</h3><p><a href="https://greasyfork.org/zh-CN/">https://greasyfork.org/zh-CN/</a></p><p><a href="https://openuserjs.org/">https://openuserjs.org/</a></p><h3 id="推荐脚本："><a href="#推荐脚本：" class="headerlink" title="推荐脚本："></a>推荐脚本：</h3><blockquote><p><strong>文字选中复制：</strong></p><p>解除网站不允许复制的限制，文本选中后点击复制按钮即可复制，主要用于 百度文库 道客巴巴 无忧考网 学习啦 蓬勃范文 思否社区 力扣 知乎 语雀 等</p><p><a href="https://greasyfork.org/scripts/405130"><strong>https://greasyfork.org/scripts/405130</strong></a></p></blockquote><blockquote><p><strong>懒人专用：</strong></p><p>自用组合型多功能脚本，无需关注公众号，集合了优酷、爱奇艺、腾讯、bilibili(B站)、芒果等全网VIP视频(PC+移动端)免费破解去广告，网易云音乐、QQ音乐、酷狗、酷我、虾米、蜻蜓FM、荔枝FM、喜马拉雅等网站音乐和有声书音频免客户端下载，百度网盘直接下载，优惠券查询等几个自己常用的功能。</p><p><a href="https://greasyfork.org/scripts/370634"><strong>https://greasyfork.org/scripts/370634</strong></a></p></blockquote><blockquote><p>懒人加强：</p><p><a href="https://greasyfork.org/scripts/398195">https://greasyfork.org/scripts/398195</a></p></blockquote><blockquote><p><strong>网盘直链下载助手：</strong></p><p>可以获取网盘文件真实下载地址。现已支持 百度网盘 阿里云盘 天翼云盘 迅雷云盘 四大网盘，可使用 IDM，Xdown，Aria2，Curl 等工具下载，完美适配 Chrome，Edge，FireFox，360，QQ 等 18 种浏览器，可在无法安装客户端的环境下使用，助手免费开源。</p><p><a href="https://greasyfork.org/scripts/436446"><strong>https://greasyfork.org/scripts/436446</strong></a></p></blockquote><blockquote><p><strong>Github 增强 - 高速下载</strong></p><p>高速下载 Git Clone&#x2F;SSH、Release、Raw、Code(ZIP) 等文件、项目列表单文件快捷下载 (☁)、添加 git clone 命令</p><p><strong><a href="https://greasyfork.org/scripts/412245">https://greasyfork.org/scripts/412245</a></strong></p></blockquote><blockquote><p><strong>bilibili视频下载</strong></p><p>支持Web、RPC、Blob、Aria等下载方式；支持下载flv、dash、mp4视频格式；支持下载港区番剧；支持下载字幕弹幕；支持换源播放等功能</p><p><strong><a href="https://greasyfork.org/scripts/413228">https://greasyfork.org/scripts/413228</a></strong></p></blockquote><blockquote><p><strong>A C 重定向优化搜索：</strong></p><p>1.繞過百度、搜狗、谷歌、好搜搜索結果中的自己的跳轉鏈接，直接訪問原始網頁-反正都能看懂 2.新增自定义网站拦截功能 3添加Favicon显示 4.页面CSS 5.添加计数 6.开关选择以上功能 7.自动翻页功能</p><p><a href="https://greasyfork.org/scripts/14178"><strong>https://greasyfork.org/scripts/14178</strong></a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 潇然工作室 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 去广告 </tag>
            
            <tag> 浏览器插件 </tag>
            
            <tag> VIP </tag>
            
            <tag> 油猴 </tag>
            
            <tag> 脚本 </tag>
            
            <tag> 规则 </tag>
            
            <tag> adblock </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>国内杀毒软件推荐</title>
      <link href="/posts/chinese-antivirus-soft-recommend.html"/>
      <url>/posts/chinese-antivirus-soft-recommend.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://p1.meituan.net/dpplatform/934272aac51c5cd4e8ea144615e42dc82083416.png"></p><h2 id="综合评价"><a href="#综合评价" class="headerlink" title="综合评价"></a>综合评价</h2><p>（2022更新）个人感觉目前国产杀软的能力如下：</p><p><strong>注：</strong></p><ol><li><p>文章符号＞为稍大于，表示前者比后者能力强，差距较一般；＞＞为大于，表示前者比后者能力更强，有一定差距；＞＞＞为远大于，表示前者比后者能力明显更强，差距较大，甚至大得离谱。</p></li><li><p>由于金山毒霸、等软件要么收费，要么用户体量太小，或是功能不完整，这里不做评价。</p></li></ol><h3 id="本职工作"><a href="#本职工作" class="headerlink" title="本职工作"></a>本职工作</h3><p>系统资源占用：2345＞＞腾讯＞火绒＞＞360；</p><p>杀毒能力：360＞＞火绒＞腾讯＞＞＞2345；</p><p>卸载难易程度：2345＞＞＞360＞腾讯＞＞火绒；</p><p>弹窗拦截能力：2345＞火绒＞360＞＞腾讯；</p><p>垃圾清理能力：360＞腾讯＞2345＞火绒；</p><p>下载器拦截能力：火绒＞＞＞2345＞360＞腾讯；</p><p>系统更新能力：360＞＞火绒＞腾讯＞＞＞2345。</p><h3 id="自带功能"><a href="#自带功能" class="headerlink" title="自带功能"></a>自带功能</h3><p>自带广告数量：2345＞＞＞360＞＞腾讯（老版本），火绒、腾讯（新版本）无广告；</p><p>软件管家收录质量：腾讯＞360＞＞＞2345，火绒无软件管家；</p><p>游戏加速能力：腾讯＞＞＞360，2345、火绒无游戏加速；</p><p>SaaS小团队版管理能力：360＞＞腾讯＞火绒（企业版），2345、火绒（个人版）无SaaS小团队版。</p><h2 id="各款杀毒软件介绍"><a href="#各款杀毒软件介绍" class="headerlink" title="各款杀毒软件介绍"></a>各款杀毒软件介绍</h2><h3 id="360安全卫士"><a href="#360安全卫士" class="headerlink" title="360安全卫士"></a>360安全卫士</h3><iframe src="//player.bilibili.com/player.html?aid=376575529&bvid=BV1bo4y1X755&cid=366523510&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><p><em>视频教程：<a href="https://www.bilibili.com/video/BV1bo4y1X755">https://www.bilibili.com/video/BV1bo4y1X755</a></em></p><p>其中推荐360的前提是要进设置里关掉所有广告项，删除所有广告小工具，还有任务栏上的两个小组件（2022更新：或使用360安全卫士极速版、部署360企业安全云）：</p><p><img src="https://p0.meituan.net/dpplatform/0e758985f88d5570065f0621cd5f15f060622.png"></p><p><img src="https://p0.meituan.net/dpplatform/183594f8510531f501886d71433b1608101370.png"></p><p><img src="https://p1.meituan.net/dpplatform/471e7fcdebb62ecbdf5fd1103770ff1f37520.jpg"></p><p><img src="https://p0.meituan.net/dpplatform/2850f48d59c6f5dc210e51adc54aaf21100043.png"></p><p><img src="https://p0.meituan.net/dpplatform/023847113a4eb9fa996d279419a94b9291998.png"></p><h3 id="火绒安全软件"><a href="#火绒安全软件" class="headerlink" title="火绒安全软件"></a>火绒安全软件</h3><iframe src="//player.bilibili.com/player.html?aid=889017343&bvid=BV14K4y1M7bq&cid=366513653&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><p><em>视频教程：<a href="https://www.bilibili.com/video/BV14K4y1M7bq">https://www.bilibili.com/video/BV14K4y1M7bq</a></em></p><p>对于刚接触电脑的人来说，我一般都推荐火绒，并配置好自动垃圾清理、弹窗拦截、下载器拦截，这种情况不推荐360，因为360会通过更新增加广告。</p><p><img src="https://p0.meituan.net/dpplatform/037b9b8ae7950bf4bb49ff6bfee8aa7340654.jpg"></p><h3 id="腾讯电脑管家"><a href="#腾讯电脑管家" class="headerlink" title="腾讯电脑管家"></a>腾讯电脑管家</h3><iframe src="//player.bilibili.com/player.html?aid=206572431&bvid=BV1Lh41167Wg&cid=366528235&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><p><em>视频教程：<a href="https://www.bilibili.com/video/BV1Lh41167Wg">https://www.bilibili.com/video/BV1Lh41167Wg</a></em></p><p>这里给一个我为什么不推荐腾讯电脑管家的原因，看图：</p><p><img src="https://p0.meituan.net/dpplatform/4cd6e4d058f70e637ec8232cba12fe3484243.png"></p><p><img src="https://p0.meituan.net/dpplatform/f663eb8e60085479ad9f1059230fb9ec56297.png"><img src="https://p0.meituan.net/dpplatform/620df6348c09112a5eba17f2f0237c8e59348.png"></p><p>似曾相识？这些就是流氓下载器里推广的软件，并且通过实测，电脑管家根本不拦截流氓下载器，想必原因就在此处。</p><p>（2022更新）但是电脑管家的游戏加速功能很强，而且对腾讯QQ游戏平台的保护十分给力，新版腾讯电脑管家更是删除了广告组件，所以推荐游戏玩家、电脑配置较强的用户使用。</p><h3 id="综合总结"><a href="#综合总结" class="headerlink" title="综合总结"></a>综合总结</h3><p>（2022更新）综合下来，我个人的推荐方案如下：</p><h4 id="小白用户"><a href="#小白用户" class="headerlink" title="小白用户"></a>小白用户</h4><p>（不懂电脑，只会一些简单操作，经常学习使用大量软件）</p><p><img src="https://p0.meituan.net/dpplatform/6c47b9241a6d52b7ae9a0a6c60afa28f2329305.png"></p><p><em>图片来自网络，侵删</em></p><p>这类用户大量从事于党政机关、事业单位、国有企业，对电脑要求不高，电脑一般为公用机，有拷贝文件、传输文件、处理格式等需求，单位含较多保密资料，经常接触一些管理平台的软件，保密意识低的用户甚至会在上面处理一些涉密文件，具有较大安全隐患，鉴于国情尽量避免使用外国软件，因此需要一款强力的国产杀毒软件。</p><p><strong>360安全卫士极速版</strong>（如果你是安全管理员，推荐部署<strong>360企业安全云</strong>）</p><h4 id="普通用户"><a href="#普通用户" class="headerlink" title="普通用户"></a>普通用户</h4><p>（稍懂电脑，使用正版软件，专注生产力)</p><p><img src="https://p0.meituan.net/dpplatform/438f62b406b4452bd92de8b6ab8937481481670.png"></p><p><em>图片来自网络，侵删</em></p><p>这类用户大多为企业员工、学生，使用环境大多为私营企业或家里，电脑常为品牌机，对电脑要求较高，有Office文档制作、正版软件运行等需求，要求系统运行稳定，因此无须安装杀毒软件，使用系统自带即可。</p><p><strong>推荐：Windows Defender（系统自带）</strong></p><p>如果觉得不顺手可换火绒或腾讯电脑管家</p><h4 id="爱折腾用户"><a href="#爱折腾用户" class="headerlink" title="爱折腾用户"></a>爱折腾用户</h4><p>（精通Windows设置，出故障能自己解决，经常接触、使用破解软件）</p><p>这类用户大多为年轻企业员工、学生，使用环境大多为私营企业、宿舍或家里，电脑常为组装机、老款品牌机，电脑配置较低或较高，经常学习使用各种软件，由于资金问题使用破解版盗版软件，经常重装系统，中病毒会自己解决。</p><p><strong>推荐：火绒安全软件</strong></p><p>或不装杀毒软件（裸奔）</p><h4 id="游戏用户"><a href="#游戏用户" class="headerlink" title="游戏用户"></a>游戏用户</h4><p>（经常玩PC游戏，尤其是腾讯平台，电脑配置高，经常接触、使用破解软件）</p><p><img src="https://p0.meituan.net/dpplatform/a3843021909502ee53a3d369409910a1384778.png"></p><p><em>图片来自于 <a href="https://pixabay.com/photos/computer-games-gaming-3923644/">Pixabay</a></em></p><p>这类用户大多为年轻企业员工、学生，使用环境大多为私营企业、宿舍或家里，电脑常为组装机、新款品牌机，电脑配置较高，经常玩WeGame、Steam、Epic等平台上的游戏，由于资金和社交问题还会下载破解版游戏和外挂补丁，不经常重装系统，出了问题要叫舍友、同事、朋友解决，经常出现QQ无法登录、英雄联盟无法联机、游戏打开提示错误等问题，可能因网上文章推荐正在使用火绒，不想使用360。</p><p><strong>推荐：腾讯电脑管家</strong></p>]]></content>
      
      
      <categories>
          
          <category> Windows </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows </tag>
            
            <tag> 安全 </tag>
            
            <tag> 杀毒 </tag>
            
            <tag> 软件 </tag>
            
            <tag> 推荐 </tag>
            
            <tag> 360 </tag>
            
            <tag> 火绒 </tag>
            
            <tag> 电脑管家 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
